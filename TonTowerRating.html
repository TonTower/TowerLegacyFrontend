<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <link rel="stylesheet" type="text/css" href="https://storage.tower-ton.com/3e21e5c9-towerton/font-awesome.min.css" />
    <link rel="stylesheet" type="text/css" href="https://storage.tower-ton.com/3e21e5c9-towerton/css/common.css?ver=135" />
    <link rel="stylesheet" type="text/css" href="https://storage.tower-ton.com/3e21e5c9-towerton/css/fonts.css?ver=135" />
    <link rel="stylesheet" type="text/css" href="https://storage.tower-ton.com/3e21e5c9-towerton/css/popup.css?ver=135" />
    <link rel="stylesheet" type="text/css" href="https://storage.tower-ton.com/3e21e5c9-towerton/css/header.css?ver=135" />
    <link rel="stylesheet" type="text/css" href="https://storage.tower-ton.com/3e21e5c9-towerton/css/footer.css?ver=135" />
    <link rel="stylesheet" type="text/css" href="https://storage.tower-ton.com/3e21e5c9-towerton/css/fontsAll.css" />
<!--    <link rel="stylesheet" type="text/css" href="https://storage.tower-ton.com/3e21e5c9-towerton/css/TonTowerMainPage.css?ver=126" />-->
    <link rel="stylesheet" type="text/css" href="https://storage.tower-ton.com/3e21e5c9-towerton/css/TonTowerRating.css?ver=135" />
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body class="flex-column">
<section class="ton-tower-treasure mainContentSection">
    <!-- This section contains the main content of the page, including images, titles, and information cards. -->
    <div class="flex_col">
        <div class="flex_col1">
            <div class="content_box13">
                <div class="wrapper16">
                    <div class="flex_col2">
                        <div class="dark">
                            <div class="flex_row">
                                <div class="header">
                                    <div class="left_header">
                                        <div class="content_box8" id="close">
                                            <p data-lang="ru" class="englishLanguageText">EN</p>
                                            <p data-lang="en" style="display: none" class="russianLanguageText">RU</p>
                                        </div>
                                        <div class="sound">
                                            <img id="soundImage" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/sound.svg" alt="">
                                        </div>
                                    </div>
                                    <h1 class="heroTitle" id="heroTitle1" data-lang="ru">Башня</h1>
                                    <h1 class="heroTitle" id="heroTitle2" data-lang="en" style="display: none">Tower</h1>
                                    <div class="right_header">
                                        <div class="faq">
                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/faq.svg" alt="">
                                        </div>
                                        <div class="content_box9">
                                            <img class="contentImage1" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/wallet.svg" alt="alt text">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="flex_row1">
                                <div class="content_box10">
                                    <div class="flex_row2">
                                        <img class="floorImage" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/tower-img.svg" alt="alt text" />
                                        <div class="flex_col3">
                                            <p class="floorNumber">{{ level }}</p>
                                            <p class="floorLabel" data-lang="ru">Этаж</p>
                                            <p class="floorLabel" data-lang="en" style="display: none;">Floor</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="content_box11">
                                    <div class="flex_row3">
                                        <img class="ratingImage" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/gold.svg" alt="alt text" />
                                        <div class="flex_col4">
                                            <p class="ratingNumber">{{ points }}</p>
                                            <p class="ratingLabel" data-lang="ru">Рейтинг</p>
                                            <p class="ratingLabel" data-lang="en" style="display: none;">Rating</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="content_box12">
                                    <div class="flex_row4">
                                        <img class="balanceImage" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/bag.png" alt="alt text" />
                                        <div class="flex_col5">
                                            <p class="balanceNumber">{{ balance }}</p>
                                            <p class="balanceLabel">TWR</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="containerMain">
                    <div class="buttons_wrapper">
                        <div class="buttons_row">
                            <div class="category-block active">
                                <div class="chest_img">
                                    <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/gold.svg" alt="">
                                </div>
                                <div class="textUsual" data-lang="ru">
                                    Сундуки
                                </div>
                                <div class="textUsual" data-lang="en" style="display: none;">
                                    Chests
                                </div>
                            </div>
                            <div class="category-block">
                                <div class="floor_img">
                                    <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/stairs.svg" alt="">
                                </div>
                                <div class="textUsual" data-lang="ru">
                                    Этажи
                                </div>
                                <div class="textUsual" data-lang="en" style="display: none;">
                                    Floors
                                </div>
                            </div>
                            <div class="category-block">
                                <div class="friend_img">
                                    <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/friends.svg" alt="">
                                </div>
                                <div class="textUsual" data-lang="ru">
                                    Друзья
                                </div>
                                <div class="textUsual" data-lang="en" style="display: none;">
                                    Friends
                                </div>
                            </div>
                        </div>
                        <div class="rating_text active">
                            <div class="rating_img">
                                <img class="cup" src="static/assets/cup.png" alt="">
                            </div>

                            <div class="rating_union">
                                <div class="titleMedium" data-lang="ru">
                                    Рейтинг
                                </div>
                                <div class="titleMedium" data-lang="en" style="display: none;">
                                    Rating
                                </div>
                                <div class="textUsual" data-lang="ru">
                                    Поднимайте свой рейтинг, открывая сундуки
                                </div>
                                <div class="textUsual" data-lang="en" style="display: none;">
                                    Raise your rating by opening chests
                                </div>
                            </div>
                        </div>
                        <div class="rating_text">
                            <div class="rating_img">
                                <img class="cup" src="static/assets/cup.png" alt="">
                            </div>
                            <div class="rating_union">
                                <div class="titleMedium" data-lang="ru">
                                    Рейтинг
                                </div>
                                <div class="titleMedium" data-lang="en" style="display: none;">
                                    Rating
                                </div>
                                <div class="textUsual" data-lang="ru">
                                    Будьте выше — получайте больше!
                                </div>
                                <div class="textUsual" data-lang="en" style="display: none;">
                                    Be higher — get more!
                                </div>
                            </div>
                        </div>
                        <div class="rating_text">
                            <div class="rating_img">
                                <img class="cup" src="static/assets/cup.png" alt="">
                            </div>
                            <div class="rating_union">
                                <div class="titleMedium" data-lang="ru">
                                    Рейтинг
                                </div>
                                <div class="titleMedium" data-lang="en" style="display: none;">
                                    Rating
                                </div>
                                <div class="textUsual" data-lang="ru">
                                    Зависит от количества открытых сундуков вашими друзьями
                                </div>
                                <div class="textUsual" data-lang="en" style="display: none;">
                                    Depends on the number of open chests by your friends
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="current_location active">
                        <div class="titleMedium" data-lang="ru">
                            Твое место
                        </div>
                        <div class="titleMedium" data-lang="en" style="display: none;">
                            Your place
                        </div>
                        <div class="location_number titleRegularJaro">
                            0/100
                        </div>
                    </div>
                    <div class="current_location">
                        <div class="titleMedium" data-lang="ru">
                            Твое место
                        </div>
                        <div class="titleMedium" data-lang="en" style="display: none;">
                            Your place
                        </div>
                        <div class="location_number titleRegularJaro">
                            0/100
                        </div>
                    </div>
                    <div class="current_location">
                        <div class="titleMedium" data-lang="ru">
                            Твое место
                        </div>
                        <div class="titleMedium" data-lang="en" style="display: none;">
                            Your place
                        </div>
                        <div class="location_number titleRegularJaro">
                            0/100
                        </div>
                    </div>
                    <div class="rating_list active">
                        <div class="rating">
                            <div class="rating_number titleRegularJaro">
                                <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/1.svg" alt="">
                            </div>
                            <div class="union2">
                                <div class="textUsual">Никнейм</div>
                                <div class="chest_union">
                                    <div class="chest_union_img">
                                        <img class="small_chest" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/chest2.svg" alt="">
                                    </div>
                                    <div class="textBigJaro">0</div>
                                </div>
                            </div>
                        </div>
                        <div class="rating">
                            <div class="rating_number titleRegularJaro">
                                <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/2.svg" alt="">
                            </div>
                            <div class="union2">
                                <div class="textUsual">Никнейм</div>
                                <div class="chest_union">
                                    <div class="chest_union_img">
                                        <img class="small_chest" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/chest2.svg" alt="">
                                    </div>
                                    <div class="textBigJaro">0</div>
                                </div>
                            </div>
                        </div>
                        <div class="rating">
                            <div class="rating_number titleRegularJaro">
                                <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/3.svg" alt="">
                            </div>
                            <div class="union2">
                                <div class="textUsual">Никнейм</div>
                                <div class="chest_union">
                                    <div class="chest_union_img">
                                        <img class="small_chest" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/chest2.svg" alt="">
                                    </div>
                                    <div class="textBigJaro">0</div>
                                </div>
                            </div>
                        </div>
                        <div class="rating">
                            <div class="rating_number titleRegularJaro">
                                4
                            </div>
                            <div class="union2">
                                <div class="textUsual">Никнейм</div>
                                <div class="chest_union">
                                    <div class="chest_union_img">
                                        <img class="small_chest" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/chest2.svg" alt="">
                                    </div>
                                    <div class="textBigJaro">0</div>
                                </div>
                            </div>
                        </div>
                        <div class="rating">
                            <div class="rating_number titleRegularJaro">
                                5
                            </div>
                            <div class="union2">
                                <div class="textUsual">Никнейм</div>
                                <div class="chest_union">
                                    <div class="chest_union_img">
                                        <img class="small_chest" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/chest2.svg" alt="">
                                    </div>
                                    <div class="textBigJaro">0</div>
                                </div>
                            </div>
                        </div>
                        <div class="rating">
                            <div class="rating_number titleRegularJaro">
                                6
                            </div>
                            <div class="union2">
                                <div class="textUsual">Никнейм</div>
                                <div class="chest_union">
                                    <div class="chest_union_img">
                                        <img class="small_chest" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/chest2.svg" alt="">
                                    </div>
                                    <div class="textBigJaro">0</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="rating_list">
                        <div class="rating">
                            <div class="rating_number titleRegularJaro">
                                <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/1.svg" alt="">
                            </div>
                            <div class="union2">
                                <div class="textUsual">Никнейм</div>
                                <div class="chest_union">
                                    <div class="chest_union_img">
                                        <img class="small_floor" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/stairs.svg" alt="">
                                    </div>
                                    <div class="textBigJaro">0</div>
                                </div>
                            </div>
                        </div>
                        <div class="rating">
                            <div class="rating_number titleRegularJaro">
                                <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/2.svg" alt="">
                            </div>
                            <div class="union2">
                                <div class="textUsual">Никнейм</div>
                                <div class="chest_union">
                                    <div class="chest_union_img">
                                        <img class="small_floor" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/stairs.svg" alt="">
                                    </div>
                                    <div class="textBigJaro">0</div>
                                </div>
                            </div>
                        </div>
                        <div class="rating">
                            <div class="rating_number titleRegularJaro">
                                <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/3.svg" alt="">
                            </div>
                            <div class="union2">
                                <div class="textUsual">Никнейм</div>
                                <div class="chest_union">
                                    <div class="chest_union_img">
                                        <img class="small_floor" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/stairs.svg" alt="">
                                    </div>
                                    <div class="textBigJaro">0</div>
                                </div>
                            </div>
                        </div>
                        <div class="rating">
                            <div class="rating_number titleRegularJaro">
                                4
                            </div>
                            <div class="union2">
                                <div class="textUsual">Никнейм</div>
                                <div class="chest_union">
                                    <div class="chest_union_img">
                                        <img class="small_floor" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/stairs.svg" alt="">
                                    </div>
                                    <div class="textBigJaro">0</div>
                                </div>
                            </div>
                        </div>
                        <div class="rating">
                            <div class="rating_number titleRegularJaro">
                                5
                            </div>
                            <div class="union2">
                                <div class="textUsual">Никнейм</div>
                                <div class="chest_union">
                                    <div class="chest_union_img">
                                        <img class="small_floor" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/stairs.svg" alt="">
                                    </div>
                                    <div class="textBigJaro">0</div>
                                </div>
                            </div>
                        </div>
                        <div class="rating">
                            <div class="rating_number titleRegularJaro">
                                6
                            </div>
                            <div class="union2">
                                <div class="textUsual">Никнейм</div>
                                <div class="chest_union">
                                    <div class="chest_union_img">
                                        <img class="small_floor" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/stairs.svg" alt="">
                                    </div>
                                    <div class="textBigJaro">0</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="rating_list">
                        <div class="rating">
                            <div class="rating_number titleRegularJaro">
                                <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/1.svg" alt="">
                            </div>
                            <div class="union2">
                                <div class="nickname_ref">
                                    <div class="textUsual">Никнейм</div>
                                    <div class="smallLight pearl_grey">25 REF</div>
                                </div>
                                <div class="chest_union">
                                    <div class="chest_union_img">
                                        <img class="small_chest" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/chest2.svg" alt="">
                                    </div>
                                    <div class="textBigJaro">0</div>
                                </div>
                            </div>
                        </div>
                        <div class="rating">
                            <div class="rating_number titleRegularJaro">
                                <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/2.svg" alt="">
                            </div>
                            <div class="union2">
                                <div class="nickname_ref">
                                    <div class="textUsual">Никнейм</div>
                                    <div class="smallLight pearl_grey">25 REF</div>
                                </div>
                                <div class="chest_union">
                                    <div class="chest_union_img">
                                        <img class="small_chest" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/chest2.svg" alt="">
                                    </div>
                                    <div class="textBigJaro">0</div>
                                </div>
                            </div>
                        </div>
                        <div class="rating">
                            <div class="rating_number titleRegularJaro">
                                <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/3.svg" alt="">
                            </div>
                            <div class="union2">
                                <div class="nickname_ref">
                                    <div class="textUsual">Никнейм</div>
                                    <div class="smallLight pearl_grey">25 REF</div>
                                </div>
                                <div class="chest_union">
                                    <div class="chest_union_img">
                                        <img class="small_chest" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/chest2.svg" alt="">
                                    </div>
                                    <div class="textBigJaro">0</div>
                                </div>
                            </div>
                        </div>
                        <div class="rating">
                            <div class="rating_number titleRegularJaro">
                                4
                            </div>
                            <div class="union2">
                                <div class="nickname_ref">
                                    <div class="textUsual">Никнейм</div>
                                    <div class="smallLight pearl_grey">25 REF</div>
                                </div>
                                <div class="chest_union">
                                    <div class="chest_union_img">
                                        <img class="small_chest" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/chest2.svg" alt="">
                                    </div>
                                    <div class="textBigJaro">0</div>
                                </div>
                            </div>
                        </div>
                        <div class="rating">
                            <div class="rating_number titleRegularJaro">
                                5
                            </div>
                            <div class="union2">
                                <div class="nickname_ref">
                                    <div class="textUsual">Никнейм</div>
                                    <div class="smallLight pearl_grey">25 REF</div>
                                </div>
                                <div class="chest_union">
                                    <div class="chest_union_img">
                                        <img class="small_chest" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/chest2.svg" alt="">
                                    </div>
                                    <div class="textBigJaro">0</div>
                                </div>
                            </div>
                        </div>
                        <div class="rating">
                            <div class="rating_number titleRegularJaro">
                                6
                            </div>
                            <div class="union2">
                                <div class="nickname_ref">
                                    <div class="textUsual">Никнейм</div>
                                    <div class="smallLight pearl_grey">25 REF</div>
                                </div>
                                <div class="chest_union">
                                    <div class="chest_union_img">
                                        <img class="small_chest" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/chest2.svg" alt="">
                                    </div>
                                    <div class="textBigJaro">0</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <button class="scroll-button">
                        <img class="arrow" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/arrow.svg" alt="">
                    </button>
                </div>

            </div>
            <div class="wrapper">
                <div style="z-index: 3" class="flex_row6">
                    <div class="footer">
                        <div id="HOME" class="content_box3 footer_btn">
                            <div class="footer_gap">
                                <img class="footer_img" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/e712bd402d6f4d66aaeb437e9ed8deed.svg" alt="alt text" />
                                <p class="usualText" data-lang="ru">Башня</p>
                                <p class="usualText" data-lang="en" style="display: none;">Tower</p>
                            </div>
                        </div>
                        <div id="tasks" class="content_box2 footer_btn">
                            <div class="footer_gap">
                                <img class="footer_img" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/b86d07f8991af9dd93ba172bb1db337b.svg" alt="alt text" />
                                <p class="usualText" data-lang="ru">Задания</p>
                                <p class="usualText" data-lang="en" style="display: none;">Tasks</p>
                            </div>
                        </div>
                        <div id="store" class="group footer_btn">
                            <div class="footer_gap">
                                <img class="footer_img" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/chest.svg" alt="alt text" />
                                <p class="usualText" data-lang="ru">Сокровища</p>
                                <p class="usualText" data-lang="en" style="display: none;">Treasures</p>
                            </div>
                        </div>
                        <div id="friends" class="content_box1 footer_btn">
                            <div class="footer_gap">
                                <img class="footer_img" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/7cc12ec41fdfb03ec4c131735d1fc6ea.svg" alt="alt text" />
                                <p class="usualText" data-lang="ru">Друзья</p>
                                <p class="usualText" data-lang="en" style="display: none;">Friends</p>
                            </div>
                        </div>
                        <div id="burse" class="content_box footer_btn">
                            <div class="footer_gap">
                                <img class="footer_img" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/2228929cf3c4fe7eacbe6ba47d98e4ba.svg" alt="alt text" />
                                <div class="usualText" data-lang="ru">Биржа</div>
                                <div class="usualText" data-lang="en" style="display: none;">Burse</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<script>
    const userId = "{{ user_id }}";
    const tg = Telegram.WebApp;
    tg.BackButton.show();
    tg.BackButton.isVisible;
    const goBack = () => {
        window.location.href = `/main?user_id=${userId.slice(6, -5)}`;
    };
    tg.BackButton.onClick(goBack);

    document.addEventListener('DOMContentLoaded', async function() {
            const response6 = await fetch('/get_music', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ user_id: userId })
                });
            const data6 = await response6.json();
            if (data6.music == 0) {
                      soundImage.src = 'https://storage.tower-ton.com/3e21e5c9-towerton/assets/sound_off.svg';
            }
            const response = await fetch('/getlan', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({ user_id: userId })
            });
            const data = await response.json();
            lang = data.lang;
            const enTexts = document.querySelectorAll('[data-lang="en"]');
            const ruTexts = document.querySelectorAll('[data-lang="ru"]');
            const currentLang = lang;
            document.documentElement.lang = lang;
            const elements = document.querySelectorAll('[data-lang-en]');
            elements.forEach(element => {
                element.textContent = element.getAttribute(`data-lang-${currentLang}`);
            });
            if (currentLang === "en") {
                text = "No quests."
                text1 = "for complition"
                text2 = "Executions left:"
                enTexts.forEach(text => {
                    text.style.display = 'block';
                });
                ruTexts.forEach(text => {
                    text.style.display = 'none';
                });
            } else {
                text = "Доступных заданий нет."
                text1 = "за выполнение"
                text2 = "Осталось выполнений:"
                enTexts.forEach(text => {
                    text.style.display = 'none';
                });
                ruTexts.forEach(text => {
                    text.style.display = 'block';
                });
            }
            fetch('/getrate', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    user_id: userId
                })
            })
            .then(response => response.json())
            .then(data => {
                let total_players = data.total_players;
                let friend_top = data.friend_top;
                let chest_top = data.chest_top;
                let level_top = data.level_top;
                let LevelName = data.LevelName;
                let Level = data.Level;
                let ChestsName = data.ChestsName;
                let Chests = data.Chests;
                let FriendsName = data.FriendsName;
                let Friends = data.Friends;
                let FriendsF = data.FriendsF;
                console.log(Level);
                console.log(LevelName);
                let values = [
                    `${chest_top} / ${total_players}`, // Для первого блока
                    `${level_top} / ${total_players}`,  // Для второго блока
                    `${friend_top} / ${total_players}`   // Для третьего блока
                ];
                let locationNumbers = document.querySelectorAll('.location_number');
                locationNumbers.forEach((element, index) => {
                    if (values[index]) { // Проверяем, есть ли значение для этого индекса
                        element.textContent = values[index];
                    }
                });
                let ratingLists = document.querySelectorAll('.rating_list');
                let values2 = [Chests,Level, Friends];
                let names = [ChestsName,LevelName, FriendsName];
                // Обновляем каждую таблицу
                ratingLists.forEach((list, index) => {
                    // Очищаем содержимое текущего списка
                    list.innerHTML = '';

                    let currentData = values2[index];
                    let currentNames = names[index];
                    let chestImage = (index === 1) ? 'https://storage.tower-ton.com/3e21e5c9-towerton/assets/stairs.svg' : 'https://storage.tower-ton.com/3e21e5c9-towerton/assets/chest2.svg';
                    // Проверяем, является ли currentData массивом
                    if (Array.isArray(currentData)) {
                        // Заполняем новый контент
                        currentData.forEach((user, i) => {
                            let efValue = (user / FriendsF[i]).toFixed(1);
                            if (efValue < 7) {
                                color = '#f80000';
                            } else if (efValue < 14) {
                                color = '#ffff33';
                            } else {
                                color = '#00b34a';
                            }
                            let REFtext = (index === 2) ? `
                            <div class="nickname_ref">
                                <div class="textUsual">${currentNames[i]}</div>
                                <div class="smallLight pearl_grey">${FriendsF[i]} REF | <span style="color: ${color};">EF ${(user/FriendsF[i]).toFixed(1)}</span></div>
                            </div>` : `<div class="textUsual">${currentNames[i]}</div>`;

                            let ratingElement = document.createElement('div');
                            ratingElement.className = 'rating';
                            if (i > 2) {
                                ratingNumberContent = `${i + 1}`; // Просто число
                            } else {
                                ratingNumberContent = `<img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/${i + 1}.svg" alt="">`; // Изображение
                            }
                            ratingElement.innerHTML = `
                                <div class="rating_number titleRegularJaro">
                                    ${ratingNumberContent}
                                </div>
                                <div class="union2">
                                    ${REFtext}
                                    <div class="chest_union">
                                        <div class="chest_union_img">
                                            <img class="small_chest" src="${chestImage}" alt="">
                                        </div>
                                        <div class="textBigJaro">${user}</div>
                                    </div>
                                </div>
                            `;

                            // Добавляем элемент в текущий список
                            list.appendChild(ratingElement);
                        });
                    } else {
                        console.error(`currentData is not an array for index ${index}`, currentData);
                    }
                });
            });

    });


    document.getElementById('HOME').addEventListener('click', () => {
        window.location.href = `/main?user_id=${userId.slice(6, -5)}`;
    });
    document.getElementById('friends').addEventListener('click', () => {
        window.location.href = `/friends?user_id=${userId.slice(6, -5)}`;
    });

    document.getElementById('store').addEventListener('click', () => {
        window.location.href = `/store?user_id=${userId.slice(6, -5)}`;
    });
    document.querySelector('.flex_row4').addEventListener('click', () => {
        window.location.href = `/twr?user_id=${userId.slice(6, -5)}`;
    });
    document.querySelector('.content_box').addEventListener('click', () => {
        window.location.href = `/burse?user_id=${userId.slice(6, -5)}`;
    });
    document.querySelector('.content_box2').addEventListener('click', () => {
        window.location.href = `/tasks?user_id=${userId.slice(6, -5)}`;
    });
    document.querySelector('.content_box9').addEventListener('click', () => {
        window.location.href = `/wallet?user_id=${userId.slice(6, -5)}`;
    });
    document.querySelector('.content_box10').addEventListener('click', () => {
        window.location.href = `/lvlup?user_id=${userId.slice(6, -5)}`;
    });
    document.querySelector('.faq').addEventListener('click', () => {
        window.location.href = `/faq?user_id=${userId.slice(6, -5)}`;
    });
    document.querySelector('.content_box11').addEventListener('click', () => {
        window.location.href = `/rate?user_id=${userId.slice(6, -5)}`;
    });


</script>

<script>

    const headerRow = document.querySelector('.title');
    const tableContainer = document.querySelector('.table-container');

    window.addEventListener('scroll', function() {
        const offset = window.scrollY;

        if (offset > tableContainer.offsetTop) {
            headerRow.classList.add('fixed'); // Добавляем класс фиксированного заголовка
        } else {
            headerRow.classList.remove('fixed'); // Убираем класс, если скролл в верхней части
        }
    });
</script>

<script>
    var xhr = new XMLHttpRequest();
    xhr.open('GET', '/get_music?user_id=' + userId, true);
    xhr.onreadystatechange = function() {
      if (xhr.readyState === 4 && xhr.status === 200) {
        var musicData = JSON.parse(xhr.responseText);
        console.log(musicData);
        if (musicData.music == 0) {
          soundImage.src = 'https://storage.tower-ton.com/3e21e5c9-towerton/assets/sound_off.png';
        }
      }
    };
    xhr.send();

    soundImage.addEventListener('click', () => {
      if (soundImage.src.includes('sound.png')) {
        soundImage.src = 'https://storage.tower-ton.com/3e21e5c9-towerton/assets/sound_off.png';
        var xhr = new XMLHttpRequest();
        xhr.open('GET', '/change_music?user_id=' + userId, true);
        xhr.onreadystatechange = function() {
          if (xhr.readyState === 4 && xhr.status === 200) {

          }
        };
        xhr.send();
      } else {
        soundImage.src = 'https://storage.tower-ton.com/3e21e5c9-towerton/assets/sound.png';
        var xhr = new XMLHttpRequest();
        xhr.open('GET', '/change_music?user_id=' + userId, true);
        xhr.onreadystatechange = function() {
          if (xhr.readyState === 4 && xhr.status === 200) {

          }
        };
        xhr.send();
      }
    });
</script>

<script>
    const buttons = document.querySelectorAll('.buttons_row .category-block');
    const ratingTexts = document.querySelectorAll('.rating_text');
    const currentLocations = document.querySelectorAll('.current_location');
    const ratingLists = document.querySelectorAll('.rating_list');

    buttons.forEach(button => {
        button.addEventListener('click', () => {

            buttons.forEach(b => b.classList.remove('active'));
            button.classList.add('active');
            const index = Array.from(buttons).indexOf(button);

            ratingTexts.forEach(r => r.classList.remove('active'));
            currentLocations.forEach(c => c.classList.remove('active'));
            ratingLists.forEach(l => l.classList.remove('active'));

            ratingTexts[index].classList.add('active');
            currentLocations[index].classList.add('active');
            ratingLists[index].classList.add('active');
        });
    });
</script>
<script>
    const scrollButtons = document.querySelectorAll(".scroll-button");

    scrollButtons.forEach(scrollButton => {
        let isAtTop = true;
        const arrowImage = scrollButton.querySelector(".arrow");

        scrollButton.addEventListener("click", () => {
            if (isAtTop) {
                window.scrollTo({
                    top: document.body.scrollHeight,
                    behavior: "smooth"
                });
            } else {
                window.scrollTo({
                    top: 0,
                    behavior: "smooth"
                });
            }
        });

        window.addEventListener("scroll", () => {
            if (window.scrollY === 0) {
                isAtTop = true;
                arrowImage.style.transform = 'rotate(0deg)';
                scrollButton.style.padding = '12px 11px 17px 11px';
            } else if (window.innerHeight + window.scrollY >= document.body.offsetHeight) {
                isAtTop = false;
                arrowImage.style.transform = 'rotate(180deg)';
                scrollButton.style.padding = '17px 11px 12px 11px';
            } else {
                isAtTop = false;
                arrowImage.style.transform = 'rotate(180deg)';
                scrollButton.style.padding = '17px 11px 12px 11px';
            }
        });
    });
</script>
<script>
    document.querySelector('.englishLanguageText').addEventListener('click', async function() {
        const enTexts = document.querySelectorAll('[data-lang="en"]');
        const ruTexts = document.querySelectorAll('[data-lang="ru"]');
        const currentLang = 'en';
        document.documentElement.lang = 'en'
        const response = await fetch('/swaplan', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ user_id: userId, lang: document.documentElement.lang  })
        });
        const data = await response.json();
        const elements = document.querySelectorAll('[data-lang-en]');
        elements.forEach(element => {
            element.textContent = element.getAttribute(`data-lang-${currentLang}`);
        });
        enTexts.forEach(text => {
            text.style.display = text.style.display === 'none' ? 'block' : 'none';
        });

        ruTexts.forEach(text => {
            text.style.display = text.style.display === 'none' ? 'block' : 'none';
        });
    });
    document.querySelector('.russianLanguageText').addEventListener('click', async function() {
        const enTexts = document.querySelectorAll('[data-lang="en"]');
        const ruTexts = document.querySelectorAll('[data-lang="ru"]');
        const currentLang = 'ru';
        document.documentElement.lang = 'ru'
        const response = await fetch('/swaplan', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ user_id: userId, lang: document.documentElement.lang  })
        });
        const data = await response.json();
        const elements = document.querySelectorAll('[data-lang-en]');
        elements.forEach(element => {
            element.textContent = element.getAttribute(`data-lang-${currentLang}`);
        });
        enTexts.forEach(text => {
            text.style.display = text.style.display === 'none' ? 'block' : 'none';
        });

        ruTexts.forEach(text => {
            text.style.display = text.style.display === 'none' ? 'block' : 'none';
        });
    });

</script>
</body>
</html>