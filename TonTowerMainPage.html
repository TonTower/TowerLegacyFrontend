<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no, user-scalable=no" />
    <link rel="stylesheet" type="text/css" href="https://storage.tower-ton.com/3e21e5c9-towerton/font-awesome.min.css" />
    <link rel="stylesheet" type="text/css" href="https://storage.tower-ton.com/3e21e5c9-towerton/css/common.css?ver=135" />
    <link rel="stylesheet" type="text/css" href="https://storage.tower-ton.com/3e21e5c9-towerton/css/fonts.css?ver=135" />
    <link rel="stylesheet" type="text/css" href="https://storage.tower-ton.com/3e21e5c9-towerton/css/popup.css?ver=135" />
    <link rel="stylesheet" type="text/css" href="https://storage.tower-ton.com/3e21e5c9-towerton/css/header.css?ver=135" />
    <link rel="stylesheet" type="text/css" href="https://storage.tower-ton.com/3e21e5c9-towerton/css/footer.css?ver=135" />
    <link rel="stylesheet" type="text/css" href="https://storage.tower-ton.com/3e21e5c9-towerton/css/fontsAll.css?ver=135"/>
    <link rel="stylesheet" type="text/css" href="https://storage.tower-ton.com/3e21e5c9-towerton/css/TonTowerMainPage.css?ver=137" />
    <script async src="https://storage.tower-ton.com/3e21e5c9-towerton/adextra.js"></script>
    <script src="https://ads.giga.pub/script?id=102"></script>
    <script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>
	<script src="https://storage.tower-ton.com/3e21e5c9-towerton/sad.min.js"></script>
    <script src="https://storage.tower-ton.com/3e21e5c9-towerton/sweetalert.js"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>

    <style>
        input[type=number] {
            -moz-appearance: textfield; /* Убираем стрелки в Firefox */
        }

        input[type=number]::-webkit-inner-spin-button,
        input[type=number]::-webkit-outer-spin-button {
            -webkit-appearance: none; /* Убираем стрелки в Chrome и Safari */
            margin: 0;
        }
        .input-value {
            text-align: center;
            font-family: Montserrat;
            font-size: 18px;
            font-weight: 600;
            background-color: transparent;
            border: none;
            color: white;
            outline: none;
            width: 100%;
            padding: 5px;
        }

        .second-column {
            position: relative;
        }

        .input-value::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }
    </style>
</head>
<body class="flex-column">
<section class="ton-tower-treasure mainContentSection" style="background: url('https://storage.tower-ton.com/3e21e5c9-towerton/assets/TWR-{{ imglevel }}.webp') center center/100% 100% no-repeat">
    <div class="laby" style="position: absolute; top: 45%; left: 30%; width: 40%; height: 25%; z-index:11;"></div>
    <div style="position: absolute; width:100%; height: 60%; z-index:999; display: none;" id="8b3998992794ae102e307a783a445dac32e33a7e"></div>
    <div class="space1" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 12;"></div>
    <div class="space2" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 14;"></div>
    <div class="flex_col">
        <div class="flex_col1">
            <div class="content_box13">
                <div class="wrapper16">
                    <audio id="audio" style="display: none;" controls loop>
                        <source src="https://storage.tower-ton.com/3e21e5c9-towerton/music.mp3" type="audio/mpeg">
                    </audio>
                        <div style="z-index: 12" class="flex_col2">
                            <div class="dark">
                                <div class="flex_row">
                                    <div class="header">
                                        <div class="left_header">
                                            <div class="content_box8" id="close">
                                                <p data-lang="ru" class="englishLanguageText">EN</p>
                                                <p data-lang="en" style="display: none" class="russianLanguageText">RU</p>
                                            </div>
                                            <div class="sound">
                                                <img id="soundImage" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/sound.svg" alt="">
                                            </div>
                                        </div>
                                        <h1 class="heroTitle" id="heroTitle1" data-lang="ru">Башня</h1>
                                        <h1 class="heroTitle" id="heroTitle2" data-lang="en" style="display: none">Tower</h1>
                                        <div class="right_header">
                                            <div class="faq">
                                                <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/faq.svg" alt="">
                                            </div>
                                            <div class="content_box9">
                                                <img class="contentImage1" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/wallet.svg" alt="alt text" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="flex_row1">
                                    <div class="content_box10">
                                        <div class="flex_row2">
                                            <img class="floorImage" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/4563d20c3685460553832adeaa23cbaa.webp" alt="alt text" />
                                            <div class="flex_col3">
                                                <p class="floorNumber">{{ level }}</p>
                                                <p class="floorLabel" data-lang="ru">Этаж</p>
                                                <p class="floorLabel" data-lang="en" style="display: none;">Floor</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="content_box11">
                                        <div class="flex_row3">
                                            <img class="ratingImage" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/4a22b525bc0ff7e81da48cb1764fa2f0.webp" alt="alt text" />
                                            <div class="flex_col4">
                                                <p class="ratingNumber">{{ points }}</p>
                                                <p class="ratingLabel" data-lang="ru">Рейтинг</p>
                                                <p class="ratingLabel" data-lang="en" style="display: none;">Rating</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="content_box12">
                                        <div class="flex_row4">
                                            <img class="balanceImage" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/bag.webp" alt="alt text" />
                                            <div class="flex_col5">
                                                <p class="balanceNumber">{{ balance }}</p>
                                                <p class="balanceLabel">TWR</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="black_container">
                                    <div class="scale_union">
                                        <div class="scale">
                                            <div style="z-index: 2;" class="scale_text"></div>
                                            <div class="scale_progress" style="width: 0%;"></div>
                                            <div class="speed">
                                                <img class="speed_img" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/keySmall.svg">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="container">
                                        <div class="speeding">
                                            <div class="speeding_text" data-lang="ru">
                                                Использовано ускорений
                                            </div>
                                            <div class="speeding_text" data-lang="en" style="display: none;">
                                                Used accelerations
                                            </div>
                                            <div class="speeding_count">
                                                <p id="limad">{{ limad }}</p>
                                                <p>/</p>
                                                <p>80</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                            <div style="top: 33vh;" class="buttons">
                                <div style="display: none" id="10keys" class="rectangle_union">
                                    <div class="circle_union">
                                        <img class="circle1" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/circle2.svg" alt="">
                                        <img style="width: 28px; height: 28px;" class="key3" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/star.webp" alt="">
                                    </div>
                                    <div class="rectangle">
                                        <img class="rectangle2" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/rectangle2.svg" alt="">
                                        <div class="text-overlay text-middle" data-lang="ru">
                                            <div class="" style="top: 0%; font-size:12px;">+10</div>
                                            <div class="" style="top: 100%">ключей</div>
                                        </div>
                                        <div class="text-overlay text-middle" data-lang="en" style="display: none;">
                                            <div class="" style="top: 0%; font-size:12px;">+10</div>
                                            <div class="" style="top: 100%">keys</div>
                                        </div>
                                    </div>
                                </div>
                                <div style="display: none" id="tenpercent" class="rectangle_union">
                                    <div class="circle_union">
                                        <img class="circle1" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/circle1.svg" alt="">
                                        <img class="sledgehammer" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/forg.svg" alt="">
                                    </div>
                                    <div class="rectangle">
                                        <img class="rectangle1" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/rectangle1.svg" alt="">
                                        <div class="overlay">
                                            <img class="plus" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/plus.svg" alt="">
                                            <img class="ten" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/ten.svg" alt="">
                                            <img class="persent" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/persent.svg" alt="">
                                        </div>
                                    </div>
                                </div>
                                <div style="display: none" id="fastkey" class="rectangle_union">
                                    <div class="circle_union">
                                        <img class="circle1" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/circle2.svg" alt="">
                                        <img class="key3" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/key3.svg" alt="">
                                    </div>
                                    <div class="rectangle">
                                        <img class="rectangle2" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/rectangle2.svg" alt="">
                                        <div class="text-overlay text-middle" data-lang="ru">
                                            Быстрый <br> ключ
                                        </div>
                                        <div class="text-overlay text-middle" data-lang="en" style="display: none;">
                                            Quick <br> key
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>
                </div>
                <div style="top: 33vh;" class="dragon">
                    <div class="button_union">
                        <img class="dragon_btn" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/dragon_btn.svg" alt="">
                        <img class="dragon_btn_transparent" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/dragon_btn_transparent.svg" alt="">
                        <div id="smaug" class="dragon_text">
                            <p class="text-overlay2" data-lang="ru">Cокровища смауга</p>
                            <p class="text-overlay2" data-lang="en" style="display: none;">Treasures of Smaug</p>
                            <div class="gap_img">
                                <img class="TON" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/TON.svg" alt="">
                                <div class="text_Jaro"> {{ smaug }} TON </div>
                            </div>
                        </div>

                    </div>

                    <img class="dragon_img" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/dragon.svg" alt="">
                </div>
                <div style="" class="spider_union">
                                <div class="spider">
                                    <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/spider.svg" alt="">
                                </div>
                                <div class="spiderColor"></div>
                                <div class="shadowSpider">
                                    <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/spiderweb.svg" alt="">
                                </div>
                                <div class="spiderweb">
                                    <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/spiderweb.svg" alt="">
                                </div>
                </div>
                <div id="PRESENT" style="display: none;position: absolute;margin-top: 38vh;z-index:7;" class="spider_union">
                    <div class="spiderweb">
                        <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/gift.png" alt="">
                    </div>
                </div>
                <div style="z-index: 19; " class="buttons2">
                    <div id="loto" class="rectangle_union">
                        <div class="circle_union">
                            <img class="circle1" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/lotoSircle.svg" alt="">
                            <div class="safe_union">
                                <img class="safe2" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/safe2.svg" alt="">
                                <img class="coin2" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/coin2.svg" alt="">
                            </div>

                        </div>
                        <div class="rectangleBig">
                            <img class="text_btn_transparent" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/rectangle_transparent.svg" alt="">
                            <img class="rectangle3" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/rectangle3.svg" alt="">
                            <div class="text-overlay2 text-middle-other" data-lang="ru">
                                ЛОТО
                            </div>
                            <div class="text-overlay2 text-middle-other" data-lang="en" style="display: none;">
                                LOTTO
                            </div>
                        </div>
                    </div>
                    <div id="greentower" class="rectangle_union">
                        <div class="circle_union">
                            <img class="circle1" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/lotoSircle.svg" alt="">
                            <img class="TWR_img" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/imgTWR.svg" alt="">
                        </div>
                        <div class="rectangleBig">
                            <img class="text_btn_transparent" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/rectangle_transparent.svg" alt="">
                            <img class="rectangle3" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/rectangle3.svg" alt="">
                            <div class="text-overlay2 text-middle-other ml4" data-lang="ru">
                                БАШНЯ
                            </div>
                            <div class="text-overlay2 text-middle-other ml4" data-lang="en" style="display: none;">
                                TOWER
                            </div>
                        </div>
                    </div>
                </div>
                <div class="flexRowImages">
                    <!-- Row for displaying additional images. -->
                </div>
                <video muted autoplay playsinline webkit-playsinline id="coin" class="extraImageOne" style="z-index: 13;" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/sunduk.webm"></video>
                <video type='video/webm; codecs="vp9"' autoplay loop muted id="coin2" class="extraImageOne" style="z-index: 13; display: none;" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/sunduk.webm"></video>
                <video type='video/webm; codecs="vp9"' autoplay loop muted id="gnom" class="extraImageTwo" style="z-index: 15;" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/gnomik-{{ imglevel }}.webm"></video>
                <img id="coin3" class="extraImageOne1" style="display: none; z-index: 13;" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/sunduk.gif" alt="alt text">
                <img id="coin4" class="extraImageOne1" style="display: none; z-index: 13; display: none;" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/sund.gif" alt="alt text">
                <img id="gnom2" class="extraImageTwo1" style="display: none; z-index: 15;" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/gnomik-{{ imglevel }}.gif" alt="alt text">
                <div style="display: none;" id="text" data-lang="ru">Заберите <br> ключ</div>
                <div style="display: none;" id="text1" data-lang="en">Take <br> key</div>
                <img style="display: none;" id="finger" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/finger.svg" alt="Finger">
            </div>
            <div class="wrapper">
                <div style="z-index: 3" class="flex_row6">
                    <div class="footer">
                        <div id="HOME" class="content_box3 footer_btn active">
                            <div class="footer_gap">
                                <img class="footer_img" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/e712bd402d6f4d66aaeb437e9ed8deed.svg" alt="alt text" />
                                <p class="usualText active" data-lang="ru">Башня</p>
                                <p class="usualText active" data-lang="en" style="display: none;">Tower</p>
                            </div>
                        </div>
                        <div id="tasks" class="content_box2 footer_btn">
                            <div class="footer_gap">
                                <img class="footer_img" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/b86d07f8991af9dd93ba172bb1db337b.svg" alt="alt text" />
                                <p class="usualText" data-lang="ru">Задания</p>
                                <p class="usualText" data-lang="en" style="display: none;">Tasks</p>
                            </div>
                        </div>
                        <div id="store" class="group footer_btn">
                            <div class="footer_gap">
                                <img class="footer_img" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/chest.svg" alt="alt text" />
                                <p class="usualText" data-lang="ru">Сокровища</p>
                                <p class="usualText" data-lang="en" style="display: none;">Treasures</p>
                            </div>
                        </div>
                        <div id="friends" class="content_box1 footer_btn">
                            <div class="footer_gap">
                                <img class="footer_img" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/7cc12ec41fdfb03ec4c131735d1fc6ea.svg" alt="alt text" />
                                <p class="usualText" data-lang="ru">Друзья</p>
                                <p class="usualText" data-lang="en" style="display: none;">Friends</p>
                            </div>
                        </div>
                        <div id="burse" class="content_box footer_btn">
                            <div class="footer_gap">
                                <img class="footer_img" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/2228929cf3c4fe7eacbe6ba47d98e4ba.svg" alt="alt text" />
                                <div class="usualText" data-lang="ru">Биржа</div>
                                <div class="usualText" data-lang="en" style="display: none;">Burse</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<script>
    function getMobileOS () {
          if (/iPhone|iPad|iPod/
                .test(navigator.userAgent)) {
                return "iOS"

          } else {
                return "Other"
          }
    }
    window.Telegram.WebApp.expand()
    const limitAD = {{ limad }};
    const limitTEN = {{ limten }};
    const limitKEY = {{ limkey }};
    const limitBUY = {{ limbuy }};
    const rewy = {{ reward }};
    const sp = {{ sp }};
    const checkId = "{{ user_id }}";
    const limads = document.getElementById('limad');
    const coinElement = document.getElementById('coin');
    const coinElement2 = document.getElementById('coin2');
    const coinElement3 = document.getElementById('coin3');
    const coinElement4 = document.getElementById('coin4');
    const gifty = {{ gifty }};
    let train = {{ train }};
    const gnomElement = document.getElementById('gnom');
    const gnomElement2 = document.getElementById('gnom2');
    var uagent = navigator.userAgent.toLowerCase();
    const tenperc = document.getElementById('tenpercent');
    const fastkey = document.getElementById('fastkey');
    const tenkeys = document.getElementById('10keys');
    const sisi = document.getElementById('PRESENT');
    const spd = document.querySelector('.spider_union');
    const main = document.querySelector('.ton-tower-treasure mainContentSection');
    const con1 = document.querySelector('.space1');
    const con2 = document.querySelector('.space2');
    const soundImage = document.getElementById('soundImage');
    // var audio =
    let cdTmaError = null;
    window.initCdTma?.({ id: 6052529 })
        .then(show => window.show = show)
        .catch(e => {
            console.log(e)
            cdTmaError = e;
        });
    document.addEventListener("DOMContentLoaded", async (event) => {
      var userId2 = window.Telegram.WebApp.initDataUnsafe.user.id;
      let initData = Telegram.WebApp.initData;
      const response = await fetch('/checkvalid', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ user_id: userId2, query: initData})
        });
        const data = await response.json();
        if (data.status == 2) {
            return;
        }


      if (getMobileOS() == "iOS") {
        gnomElement.style.display = "none";
        coinElement2.style.display = "none";
        coinElement.style.display = "none";
        gnomElement2.style.display = "";
        coinElement3.style.display = "";
      }
      finger.remove();
      text.remove();
      text1.remove();
      con2.remove()
      con1.remove()
      if (checkId != "0") {
        const response6 = await fetch('/get_music', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ user_id: userId })
            });
        const data6 = await response6.json();
        const response = await fetch('/getlan', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({ user_id: userId })
            });
            const data = await response.json();
            const greenCity = document.getElementById('greentower');
            lang = data.lang;
            if (sp == 0) {
                    spd.style.display = "";
            } else {
                    spd.remove()
            }
            if (rewy == 1) {
                greenCity.remove();
            } else {
                greenCity.style.display = "";
            }
            if (limitBUY < 30) {
                    tenkeys.style.display = "";
            } else {
                    tenkeys.remove()
            }
            if (limitAD < 80) {
                if (limitTEN < 15) {
                    tenperc.style.display = "";
                } else {
                    tenperc.remove()
                }
                if (limitKEY < 1) {
                    fastkey.style.display = "";
                } else {
                    fastkey.remove()
                }
            }
            const enTexts = document.querySelectorAll('[data-lang="en"]');
            const ruTexts = document.querySelectorAll('[data-lang="ru"]');
            const currentLang = lang;
            const cau = {{ cau }};
            if (gifty == 2) {
                sisi.remove()
            } else {
                sisi.style.display = "flex"
            }
            if (train >= 1) {
                con2.remove()
            }
            if (train >= 2) {
                con1.remove()
            }
            if (train > 1) {
                finger.remove();
                text.remove();
                text1.remove();
            } else {
                finger.style.display = 'flex';
                text.style.display = 'flex';
            }

            document.documentElement.lang = lang;
            const elements = document.querySelectorAll('[data-lang-en]');
            elements.forEach(element => {
                element.textContent = element.getAttribute(`data-lang-${currentLang}`);
            });
            if (currentLang === "en") {
                enTexts.forEach(text => {
                    text.style.display = 'block';
                });
                ruTexts.forEach(text => {
                    text.style.display = 'none';
                });
            } else {
                enTexts.forEach(text => {
                    text.style.display = 'none';
                });
                ruTexts.forEach(text => {
                    text.style.display = 'block';
                });
        }
        const level = {{ level }};
        console.log(level);
        if (level < 10) {
            console.log("LEVEL");
            yo = document.querySelector('.laby')
            yo.remove()
        }
        var audio = document.getElementById('audio');
        if (data6.music == 0) {
                  soundImage.src = 'https://storage.tower-ton.com/3e21e5c9-towerton/assets/sound_off.svg';
        } else {
            audio.play();
        }
        return;
      }
      window.location.href = "/main?user_id=" + data.hashed_id;
    });
    coinElement.addEventListener('loadeddata', function() {
        coinElement.pause();
        coinElement.currentTime = 0;
    }, { once: true });
    const userId = "{{ user_id }}"
    let lefttime = 0
    let ctime = 0
    lefttime = {{ keycd }}
    ctime = {{ ctime }}
    const fulltime = 28800;
    const percenttext = document.querySelector('.scale_text');
    const percentscale = document.querySelector('.scale_progress');

    function updateProgress() {
        ctime += 1;

        let percent = Math.floor((ctime - lefttime) / fulltime * 100) + 100;

        if (percent >= 100) {
            percent = 100;
        }

        percenttext.textContent = percent + "%";
        percentscale.style.width = percent + "%";
    }

    setInterval(updateProgress, 1000);
    const boostbutton = document.querySelector('.scale');
    let click_upgrade = 0;
    try {
        click_upgrade = {{ click_upgrade }};
    } catch (err) {
        click_upgrade = 0
    }
    const balanceElement = document.querySelector('.balanceNumber');
    const openchestElement = document.querySelector('.ratingNumber');



    const tresElement = document.getElementById('tres');
    const energyElement = document.getElementById('energy');
    const tg = Telegram.WebApp;
    tg.BackButton.hide();
    tg.disableVerticalSwipes();
    tg.setHeaderColor("#152124");
    tg.setBottomBarColor("#0e1618");
    tg.setBackgroundColor("#0e1618");
    let energy = 0;
    let max_energy = 0;
    tg.enableClosingConfirmation();
    try {
        energy = {{ energy }};
    } catch (err) {
        energy = 0
    }
    try {
        max_energy = {{ max_energy }};
    } catch (err) {
        max_energy = 0
    }
    const AdController = window.Adsgram.init({ blockId: "int-8679" })
    var c_wallet = "{{ wallet }}"

    // function setInitialEnergy(width2) {
    //   energyElement.style.width = ((data.energy / data.max_energy) * 100) + '%';
    // }

    async function closeSwal(Swal) {
        try {
            Swal.close();
        } catch (error) {
            console.error('Ошибка:', error);
        }
    }

    async function sendGift() {
        try {
            const result = await AdController.show();

            const response = await fetch('/gift', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ user_id: userId })
            });
            // обработайте ответ, если необходимо
        } catch (error) {
            console.error('Ошибка:', error);
        }
    }

    boostbutton.addEventListener('click', async (event) => {
        // Отправка запроса на сервер и обновление баланса
        const response = await fetch('/getkey', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ user_id: userId })
        });
        const data = await response.json();
        const response4 = await fetch('/get_musics', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ user_id: userId })
                    });
        const data4 = await response4.json();
        let soundenabled = data4.music
        let wait = soundenabled === 1 ? 0 : 0
        if (data.result == 1) {
            setTimeout(async () => {
                let currentLang = document.documentElement.lang;
                if (currentLang === 'ru') {
                    confirmButtonText = 'Ок';
                } else if (currentLang === 'en') {
                    confirmButtonText = 'Ok';
                }
                Swal.fire({
                    customClass: {
                        title: 'titleSemiBold titleMain',
                        content: 'textUsual',
                        confirmButton: 'custom-ok-button',
                    },
                    background: '#19292E',
                    html:
                        `<div class="containerPopUp">
                        <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/success.svg" class="success-icon">
                    <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Кузнец</div>
                    <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Blacksmith</div>
                    <div class="textUsual" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы получили ключ</div>
                    <div class="textUsual" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You have received the key</div>
            </div>`,
                    imageAlt: 'succes_icon',
                    confirmButtonText: confirmButtonText,
                    confirmButtonColor: 'rgb(80, 200, 120)',
                    showConfirmButton: true,
                    backdrop: 'rgba(10, 17, 19, 0.8)'
                });
                ctime = Math.floor(lefttime-fulltime);
            }, 100);
        } else {

            setTimeout(async () => {
                let currentLang = document.documentElement.lang;
                if (currentLang === 'ru') {
                    confirmButtonText = 'Ускорить';
                    cancelButtonText = 'Закрыть';
                } else if (currentLang === 'en') {
                    confirmButtonText = 'Speed up';
                    cancelButtonText = 'Close';
                }
                Swal.fire({
                    customClass: {
                        title: 'titleSemiBold titleMain',
                        content: 'textUsual',
                        confirmButton: 'custom-ok-button',
                        cancelButton: 'close_btn'
                    },
                    background: '#19292E',
                    color: 'white',
                    html:
                        `<div class="containerPopUp">
                        <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/keys5.png" class="warning-icon" alt="warning_icon">
                        <div class="textUsual" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Ускорь ковку на 5%?</div>
                        <div class="textUsual" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Speed up forging by 5%?</div>
                    </div>`,
                    showCancelButton: true,
                    showConfirmButton: true,
                    confirmButtonText: confirmButtonText,
                    cancelButtonText: cancelButtonText,
                    confirmButtonColor: 'rgb(80, 200, 120)',
                    cancelButtonColor: 'rgba(249, 192, 80, 0)',
                    backdrop: 'rgba(10, 17, 19, 0.8)'
                }).then(async (result) => {
                  if (result.isConfirmed) {
                    window.initCdTma?.({ id: 6052529 })
                    .then(show => window.show = show)
                    .catch(e => {
                        console.log(e)
                        cdTmaError = e;
                    });
                    const response5 = await fetch('/checkad', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ user_id: userId, cdTmaError: cdTmaError })
                    });
                    const data5 = await response5.json();
                    if (data5.status == 1) {
                        console.log("Текущая реклама" + data5.ads);
                        if (data5.ads == "Adsgram") {
                                AdController.show()
                                     .then((result) => {
                                         if (currentLang === 'ru') {
                                             confirmButtonText = 'Ок';
                                         } else if (currentLang === 'en') {
                                             confirmButtonText = 'Ok';
                                         }
                                         if (data5.ad == 19) {
                                            Swal.fire({
                                                 customClass: {
                                                     title: 'titleSemiBold titleMain',
                                                     content: 'textUsual',
                                                     confirmButton: 'custom-ok-button',
                                                 },
                                                 background: '#19292E',
                                                 html:
                                                 `<img style="height: 100%;" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/s-fonom.gif" class="gif">` +
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы получили <br> бонусный ключ!</div>`+
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You got <br> bonus key!</div>`,
                                                 imageAlt: 'succes_icon',
                                                 confirmButtonText: confirmButtonText,
                                                 confirmButtonColor: 'rgb(80, 200, 120)',
                                                 showConfirmButton: true,
                                                 backdrop: 'rgba(10, 17, 19, 0.8)'
                                            });
                                         } else if (data5.ad == 59) {
                                            Swal.fire({
                                                 customClass: {
                                                     confirmButton: 'custom-ok-button',
                                                 },
                                                 background: '#19292E',
                                                 html:
                                                 `<img style="height: 100%;" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/s-fonom.gif" class="gif">` +
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы получили <br> бонусный ключ!</div>`+
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You got <br> bonus key!</div>`,
                                                 imageAlt: 'succes_icon',
                                                 confirmButtonText: confirmButtonText,
                                                 confirmButtonColor: 'rgb(40, 131, 43)',
                                                 showConfirmButton: true,
                                                 backdrop: 'rgba(10, 17, 19, 0.8)'
                                            });
                                         } else if (data5.ad == 39) {
                                            let currentLang = document.documentElement.lang;
                                            if (currentLang === 'ru') {
                                                confirmButtonText = 'Забрать';
                                            } else if (currentLang === 'en') {
                                                confirmButtonText = 'Pick up';
                                            }
                                            Swal.fire({
                                                customClass: {
                                                    confirmButton: 'custom-ok-button',
                                                },
                                                background: '#19292E',
                                                html:
                                                    `<div class="containerPopUp">
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Награда</div>
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Reward</div>
                                                    <div class="row_union">
                                                        <div class="reward_row">
                                                            <div class="row_small pr4">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/TWR.png" class="twrSmall">
                                                            <p class="textUsual">TWR</p>
                                                            <p class="textUsual">100</p>
                                                            </div>
                                                            <div class="row_small pr4">
                                                            <img class="refSmall" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/bfcc31b7e3c9e9084ed7ee38d5ad963d.svg">
                                                            <p class="textUsual">REF</p>
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                            <div class="row_small">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/key.svg" class="keySmall">
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                       </div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы просмотрели половину доступных роликов!</div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You've watched half of the available commercials!</div>
                                                    </div>
                                         </div>`,
                                                imageAlt: 'error-icon',
                                                confirmButtonText: confirmButtonText,
                                                confirmButtonColor: 'rgb(80, 200, 120)',
                                                showConfirmButton: true,
                                                backdrop: 'rgba(10, 17, 19, 0.8)',
                                            });
                                         } else if (data5.ad == 79) {
                                            let currentLang = document.documentElement.lang;
                                            if (currentLang === 'ru') {
                                                confirmButtonText = 'Забрать';
                                            } else if (currentLang === 'en') {
                                                confirmButtonText = 'Pick up';
                                            }
                                            Swal.fire({
                                                customClass: {
                                                    confirmButton: 'custom-ok-button',
                                                },
                                                background: '#19292E',
                                                html:
                                                    `<div class="containerPopUp">
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Награда</div>
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Reward</div>
                                                    <div class="row_union">
                                                        <div class="reward_row">
                                                            <div class="row_small pr4">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/TWR.png" class="twrSmall">
                                                            <p class="textUsual">TWR</p>
                                                            <p class="textUsual">100</p>
                                                            </div>
                                                            <div class="row_small pr4">
                                                            <img class="refSmall" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/bfcc31b7e3c9e9084ed7ee38d5ad963d.svg">
                                                            <p class="textUsual">REF</p>
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                            <div class="row_small">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/key.svg" class="keySmall">
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                       </div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы просмотрели все доступные рекламные ролики!</div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You've watched all the available commercials!</div>
                                                    </div>
                                         </div>`,
                                                imageAlt: 'error-icon',
                                                confirmButtonText: confirmButtonText,
                                                confirmButtonColor: 'rgb(80, 200, 120)',
                                                showConfirmButton: true,
                                                backdrop: 'rgba(10, 17, 19, 0.8)',
                                            });

                                         } else {
                                            Swal.fire({
                                                 customClass: {
                                                     title: 'titleSemiBold titleMain',
                                                     content: 'textUsual',
                                                     confirmButton: 'custom-ok-button',
                                                 },
                                                 background: '#19292E',
                                                 html:
                                                     `<div class="containerPopUp">
                                                 <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/success.svg" class="success-icon">
                                                 <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Отлично!</div>
                                                 <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Great!</div>
                                                 <div class="textUsual" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы ускорили <br> создание ключа</div>
                                                 <div class="textUsual" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}" >You have accelerated <br>the creation of the key</div>
                                         </div>`,
                                                 imageAlt: 'succes_icon',
                                                 confirmButtonText: confirmButtonText,
                                                 confirmButtonColor: 'rgb(80, 200, 120)',
                                                 showConfirmButton: true,
                                                 backdrop: 'rgba(10, 17, 19, 0.8)'
                                             });
                                         }
                                       ctime += Math.floor(fulltime/20);
                                       limads.textContent = data5.ad+1
                                       return fetch('/boostspeed', {
                                         method: 'POST',
                                         headers: { 'Content-Type': 'application/json' },
                                         body: JSON.stringify({ user_id: userId, ad: data5.ads })
                                       });

                                     })
                                     .then((response) => {
                                       if (!response.ok) {
                                         throw new Error(`HTTP error! status: ${response.status}`);
                                       }
                                       return response.json();
                                     })
                                     .then((data) => {
                                       // process the data if needed
                                     })
                                     .catch((error) => {
                                       console.error('Error:', error);
                                       // handle the error
                                     });
                        } else if (data5.ads == "Gigapub") {
                            window.showGiga()
                              .then(() => {
                                    if (data5.ad == 19) {
                                            Swal.fire({
                                                 customClass: {
                                                     confirmButton: 'custom-ok-button',
                                                 },
                                                 background: '#19292E',
                                                 html:
                                                 `<img style="height: 100%;" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/s-fonom.gif" class="gif">` +
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы получили <br> бонусный ключ!</div>`+
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You got <br> bonus key!</div>`,
                                                 imageAlt: 'succes_icon',
                                                 confirmButtonText: confirmButtonText,
                                                 confirmButtonColor: 'rgb(40, 131, 43)',
                                                 showConfirmButton: true,
                                                 backdrop: 'rgba(10, 17, 19, 0.8)'
                                            });
                                    } else if (data5.ad == 59) {
                                            Swal.fire({
                                                 customClass: {
                                                     confirmButton: 'custom-ok-button',
                                                 },
                                                 background: '#19292E',
                                                 html:
                                                 `<img style="height: 100%;" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/s-fonom.gif" class="gif">` +
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы получили <br> бонусный ключ!</div>`+
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You got <br> bonus key!</div>`,
                                                 imageAlt: 'succes_icon',
                                                 confirmButtonText: confirmButtonText,
                                                 confirmButtonColor: 'rgb(40, 131, 43)',
                                                 showConfirmButton: true,
                                                 backdrop: 'rgba(10, 17, 19, 0.8)'
                                            });
                                    } else if (data5.ad == 39) {
                                            let currentLang = document.documentElement.lang;
                                            if (currentLang === 'ru') {
                                                confirmButtonText = 'Забрать';
                                            } else if (currentLang === 'en') {
                                                confirmButtonText = 'Pick up';
                                            }
                                            Swal.fire({
                                                customClass: {
                                                    confirmButton: 'custom-ok-button',
                                                },
                                                background: '#19292E',
                                                html:
                                                    `<div class="containerPopUp">
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Награда</div>
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Reward</div>
                                                    <div class="row_union">
                                                        <div class="reward_row">
                                                            <div class="row_small pr4">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/TWR.png" class="twrSmall">
                                                            <p class="textUsual">TWR</p>
                                                            <p class="textUsual">100</p>
                                                            </div>
                                                            <div class="row_small pr4">
                                                            <img class="refSmall" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/bfcc31b7e3c9e9084ed7ee38d5ad963d.svg">
                                                            <p class="textUsual">REF</p>
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                            <div class="row_small">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/key.svg" class="keySmall">
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                       </div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы просмотрели половину доступных роликов!</div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You've watched half of the available commercials!</div>
                                                    </div>
                                         </div>`,
                                                imageAlt: 'error-icon',
                                                confirmButtonText: confirmButtonText,
                                                confirmButtonColor: 'rgb(80, 200, 120)',
                                                showConfirmButton: true,
                                                backdrop: 'rgba(10, 17, 19, 0.8)',
                                            });
                                    } else if (data5.ad == 79) {
                                            let currentLang = document.documentElement.lang;
                                            if (currentLang === 'ru') {
                                                confirmButtonText = 'Забрать';
                                            } else if (currentLang === 'en') {
                                                confirmButtonText = 'Pick up';
                                            }
                                            Swal.fire({
                                                customClass: {
                                                    confirmButton: 'custom-ok-button',
                                                },
                                                background: '#19292E',
                                                html:
                                                    `<div class="containerPopUp">
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Награда</div>
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Reward</div>
                                                    <div class="row_union">
                                                        <div class="reward_row">
                                                            <div class="row_small pr4">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/TWR.png" class="twrSmall">
                                                            <p class="textUsual">TWR</p>
                                                            <p class="textUsual">100</p>
                                                            </div>
                                                            <div class="row_small pr4">
                                                            <img class="refSmall" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/bfcc31b7e3c9e9084ed7ee38d5ad963d.svg">
                                                            <p class="textUsual">REF</p>
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                            <div class="row_small">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/key.svg" class="keySmall">
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                       </div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы просмотрели все доступные рекламные ролики!</div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You've watched all the available commercials!</div>
                                                    </div>
                                         </div>`,
                                                imageAlt: 'error-icon',
                                                confirmButtonText: confirmButtonText,
                                                confirmButtonColor: 'rgb(80, 200, 120)',
                                                showConfirmButton: true,
                                                backdrop: 'rgba(10, 17, 19, 0.8)',
                                            });

                                    } else {
                                            return Swal.fire({
                                                 customClass: {
                                                     title: 'titleSemiBold titleMain',
                                                     content: 'textUsual',
                                                     confirmButton: 'custom-ok-button',
                                                 },
                                                 background: '#19292E',
                                                 html:
                                                     `<div class="containerPopUp">
                                                 <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/success.svg" class="success-icon">
                                                 <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Отлично!</div>
                                                 <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Great!</div>
                                                 <div class="textUsual" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы ускорили <br> создание ключа</div>
                                                 <div class="textUsual" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}" >You have accelerated <br>the creation of the key</div>
                                         </div>`,
                                                 imageAlt: 'succes_icon',
                                                 confirmButtonText: confirmButtonText,
                                                 confirmButtonColor: 'rgb(80, 200, 120)',
                                                 showConfirmButton: true,
                                                 backdrop: 'rgba(10, 17, 19, 0.8)'
                                             });
                                         }
                                })
                                .then(() => { // вынесли fetch в отдельный блок then
                                  ctime += Math.floor(fulltime/20);
                                  limads.textContent = data5.ad+1
                                  return fetch('/boostspeed', {
                                    method: 'POST',
                                    headers: { 'Content-Type': 'application/json' },
                                    body: JSON.stringify({ user_id: userId, ad: data5.ads })
                                  });
                              }).catch(e => {
                                Swal.fire({
                                                     customClass: {
                                                         title: 'titleSemiBold titleMain',
                                                         content: 'textUsual',
                                                         confirmButton: 'custom-ok-button',
                                                     },
                                                     background: '#19292E',
                                                     html:
                                                         `<div class="containerPopUp">
                                                 <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/success.svg" class="success-icon">
                                                 <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Отлично!</div>
                                                 <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Great!</div>
                                                 <div class="textUsual" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы ускорили <br> создание ключа</div>
                                                 <div class="textUsual" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}" >You have accelerated <br>the creation of the key</div>
                                         </div>`,
                                                     imageAlt: 'succes_icon',
                                                     confirmButtonText: confirmButtonText,
                                                     confirmButtonColor: 'rgb(80, 200, 120)',
                                                     showConfirmButton: true,
                                                     backdrop: 'rgba(10, 17, 19, 0.8)'
                                                 });
                              })
                        } else if (data5.ads == "Onlick") {
                            let confirmButtonText; // Объявим переменную вне then
                            if (currentLang === 'ru') {
                                confirmButtonText = 'Ок';
                            } else if (currentLang === 'en') {
                                confirmButtonText = 'Ok';
                            }

                            window.show?.()
                                .then(() => {
                                    if (data5.ad == 19) {
                                            Swal.fire({
                                                 customClass: {
                                                     confirmButton: 'custom-ok-button',
                                                 },
                                                 background: '#19292E',
                                                 html:
                                                 `<img style="height: 100%;" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/s-fonom.gif" class="gif">` +
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы получили <br> бонусный ключ!</div>`+
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You got <br> bonus key!</div>`,
                                                 imageAlt: 'succes_icon',
                                                 confirmButtonText: confirmButtonText,
                                                 confirmButtonColor: 'rgb(40, 131, 43)',
                                                 showConfirmButton: true,
                                                 backdrop: 'rgba(10, 17, 19, 0.8)'
                                            });
                                         } else if (data5.ad == 59) {
                                            Swal.fire({
                                                 customClass: {
                                                     confirmButton: 'custom-ok-button',
                                                 },
                                                 background: '#19292E',
                                                 html:
                                                 `<img style="height: 100%;" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/s-fonom.gif" class="gif">` +
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы получили <br> бонусный ключ!</div>`+
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You got <br> bonus key!</div>`,
                                                 imageAlt: 'succes_icon',
                                                 confirmButtonText: confirmButtonText,
                                                 confirmButtonColor: 'rgb(40, 131, 43)',
                                                 showConfirmButton: true,
                                                 backdrop: 'rgba(10, 17, 19, 0.8)'
                                            });
                                         } else if (data5.ad == 39) {
                                            let currentLang = document.documentElement.lang;
                                            if (currentLang === 'ru') {
                                                confirmButtonText = 'Забрать';
                                            } else if (currentLang === 'en') {
                                                confirmButtonText = 'Pick up';
                                            }
                                            Swal.fire({
                                                customClass: {
                                                    confirmButton: 'custom-ok-button',
                                                },
                                                background: '#19292E',
                                                html:
                                                    `<div class="containerPopUp">
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Награда</div>
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Reward</div>
                                                    <div class="row_union">
                                                        <div class="reward_row">
                                                            <div class="row_small pr4">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/TWR.png" class="twrSmall">
                                                            <p class="textUsual">TWR</p>
                                                            <p class="textUsual">100</p>
                                                            </div>
                                                            <div class="row_small pr4">
                                                            <img class="refSmall" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/bfcc31b7e3c9e9084ed7ee38d5ad963d.svg">
                                                            <p class="textUsual">REF</p>
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                            <div class="row_small">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/key.svg" class="keySmall">
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                       </div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы просмотрели половину доступных роликов!</div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You've watched half of the available commercials!</div>
                                                    </div>
                                         </div>`,
                                                imageAlt: 'error-icon',
                                                confirmButtonText: confirmButtonText,
                                                confirmButtonColor: 'rgb(80, 200, 120)',
                                                showConfirmButton: true,
                                                backdrop: 'rgba(10, 17, 19, 0.8)',
                                            });
                                         } else if (data5.ad == 79) {
                                            let currentLang = document.documentElement.lang;
                                            if (currentLang === 'ru') {
                                                confirmButtonText = 'Забрать';
                                            } else if (currentLang === 'en') {
                                                confirmButtonText = 'Pick up';
                                            }
                                            Swal.fire({
                                                customClass: {
                                                    confirmButton: 'custom-ok-button',
                                                },
                                                background: '#19292E',
                                                html:
                                                    `<div class="containerPopUp">
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Награда</div>
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Reward</div>
                                                    <div class="row_union">
                                                        <div class="reward_row">
                                                            <div class="row_small pr4">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/TWR.png" class="twrSmall">
                                                            <p class="textUsual">TWR</p>
                                                            <p class="textUsual">100</p>
                                                            </div>
                                                            <div class="row_small pr4">
                                                            <img class="refSmall" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/bfcc31b7e3c9e9084ed7ee38d5ad963d.svg">
                                                            <p class="textUsual">REF</p>
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                            <div class="row_small">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/key.svg" class="keySmall">
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                       </div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы просмотрели все доступные рекламные ролики!</div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You've watched all the available commercials!</div>
                                                    </div>
                                         </div>`,
                                                imageAlt: 'error-icon',
                                                confirmButtonText: confirmButtonText,
                                                confirmButtonColor: 'rgb(80, 200, 120)',
                                                showConfirmButton: true,
                                                backdrop: 'rgba(10, 17, 19, 0.8)',
                                            });

                                    } else {
                                            return Swal.fire({
                                                 customClass: {
                                                     title: 'titleSemiBold titleMain',
                                                     content: 'textUsual',
                                                     confirmButton: 'custom-ok-button',
                                                 },
                                                 background: '#19292E',
                                                 html:
                                                     `<div class="containerPopUp">
                                                 <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/success.svg" class="success-icon">
                                                 <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Отлично!</div>
                                                 <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Great!</div>
                                                 <div class="textUsual" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы ускорили <br> создание ключа</div>
                                                 <div class="textUsual" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}" >You have accelerated <br>the creation of the key</div>
                                         </div>`,
                                                 imageAlt: 'succes_icon',
                                                 confirmButtonText: confirmButtonText,
                                                 confirmButtonColor: 'rgb(80, 200, 120)',
                                                 showConfirmButton: true,
                                                 backdrop: 'rgba(10, 17, 19, 0.8)'
                                             });
                                         }
                                })
                                .then(() => { // вынесли fetch в отдельный блок then
                                  ctime += Math.floor(fulltime/20);
                                  limads.textContent = data5.ad+1
                                  return fetch('/boostspeed', {
                                    method: 'POST',
                                    headers: { 'Content-Type': 'application/json' },
                                    body: JSON.stringify({ user_id: userId, ad: data5.ads })
                                  });
                              })
                               .catch(e => {
                                    console.log(e);
                                    console.log("ошибка")
                                    return Swal.fire({
                                         customClass: {
                                             title: 'titleSemiBold titleMain',
                                             content: 'textUsual',
                                             confirmButton: 'error-ok-button',
                                         },
                                         background: '#19292E',
                                         html:
                                             `<div class="containerPopUp">
                                             <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/error.svg" class="error-icon">
                                         <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Реклама</div>
                                         <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Advertisement</div>
                                         <div class="textUsual" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Для вас сейчас нет рекламы от этого партнёра, попробуйте ещё раз</div>
                                         <div class="textUsual" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">There is no advertisement for you from that partner</div>
                               </div>`,
                                        imageAlt: 'error_icon',
                                         showConfirmButton: true,
                                         confirmButtonColor: 'rgb(163, 57, 26)',
                                         confirmButtonText: confirmButtonText,
                                         backdrop: 'rgba(10, 17, 19, 0.8)'
                                    });
                               });
                        } else if (data5.ads == "Adextra") {
                            let confirmButtonText; // Объявим переменную вне then
                            if (currentLang === 'ru') {
                                confirmButtonText = 'Ок';
                            } else if (currentLang === 'en') {
                                confirmButtonText = 'Ok';
                            }
                            id = '8b3998992794ae102e307a783a445dac32e33a7e';
                            p = function(){}
                                window.setTimeout('p_adextra(p,p)',2000)
                            var onError = () => {
                                        window.showGiga()
                                          .then(() => {
                                                if (data5.ad == 19) {
                                                        Swal.fire({
                                                             customClass: {
                                                                 confirmButton: 'custom-ok-button',
                                                             },
                                                             background: '#19292E',
                                                             html:
                                                             `<img style="height: 100%;" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/s-fonom.gif" class="gif">` +
                                                                 `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы получили <br> бонусный ключ!</div>`+
                                                                 `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You got <br> bonus key!</div>`,
                                                             imageAlt: 'succes_icon',
                                                             confirmButtonText: confirmButtonText,
                                                             confirmButtonColor: 'rgb(40, 131, 43)',
                                                             showConfirmButton: true,
                                                             backdrop: 'rgba(10, 17, 19, 0.8)'
                                                        });
                                                } else if (data5.ad == 59) {
                                                        Swal.fire({
                                                             customClass: {
                                                                 confirmButton: 'custom-ok-button',
                                                             },
                                                             background: '#19292E',
                                                             html:
                                                             `<img style="height: 100%;" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/s-fonom.gif" class="gif">` +
                                                                 `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы получили <br> бонусный ключ!</div>`+
                                                                 `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You got <br> bonus key!</div>`,
                                                             imageAlt: 'succes_icon',
                                                             confirmButtonText: confirmButtonText,
                                                             confirmButtonColor: 'rgb(40, 131, 43)',
                                                             showConfirmButton: true,
                                                             backdrop: 'rgba(10, 17, 19, 0.8)'
                                                        });
                                                } else if (data5.ad == 39) {
                                                        let currentLang = document.documentElement.lang;
                                                        if (currentLang === 'ru') {
                                                            confirmButtonText = 'Забрать';
                                                        } else if (currentLang === 'en') {
                                                            confirmButtonText = 'Pick up';
                                                        }
                                                        Swal.fire({
                                                            customClass: {
                                                                confirmButton: 'custom-ok-button',
                                                            },
                                                            background: '#19292E',
                                                            html:
                                                                `<div class="containerPopUp">
                                                                <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Награда</div>
                                                                <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Reward</div>
                                                                <div class="row_union">
                                                                    <div class="reward_row">
                                                                        <div class="row_small pr4">
                                                                        <img src="https://storage.tower-ton.com/3e21e5c9-towerton/TWR.png" class="twrSmall">
                                                                        <p class="textUsual">TWR</p>
                                                                        <p class="textUsual">100</p>
                                                                        </div>
                                                                        <div class="row_small pr4">
                                                                        <img class="refSmall" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/bfcc31b7e3c9e9084ed7ee38d5ad963d.svg">
                                                                        <p class="textUsual">REF</p>
                                                                        <p class="textUsual">1</p>
                                                                        </div>
                                                                        <div class="row_small">
                                                                        <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/key.svg" class="keySmall">
                                                                        <p class="textUsual">1</p>
                                                                        </div>
                                                                   </div>
                                                                   <div class="textUsual pale_blue" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы просмотрели половину доступных роликов!</div>
                                                                   <div class="textUsual pale_blue" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You've watched half of the available commercials!</div>
                                                                </div>
                                                     </div>`,
                                                            imageAlt: 'error-icon',
                                                            confirmButtonText: confirmButtonText,
                                                            confirmButtonColor: 'rgb(80, 200, 120)',
                                                            showConfirmButton: true,
                                                            backdrop: 'rgba(10, 17, 19, 0.8)',
                                                        });
                                                } else if (data5.ad == 79) {
                                                        let currentLang = document.documentElement.lang;
                                                        if (currentLang === 'ru') {
                                                            confirmButtonText = 'Забрать';
                                                        } else if (currentLang === 'en') {
                                                            confirmButtonText = 'Pick up';
                                                        }
                                                        Swal.fire({
                                                            customClass: {
                                                                confirmButton: 'custom-ok-button',
                                                            },
                                                            background: '#19292E',
                                                            html:
                                                                `<div class="containerPopUp">
                                                                <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Награда</div>
                                                                <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Reward</div>
                                                                <div class="row_union">
                                                                    <div class="reward_row">
                                                                        <div class="row_small pr4">
                                                                        <img src="https://storage.tower-ton.com/3e21e5c9-towerton/TWR.png" class="twrSmall">
                                                                        <p class="textUsual">TWR</p>
                                                                        <p class="textUsual">100</p>
                                                                        </div>
                                                                        <div class="row_small pr4">
                                                                        <img class="refSmall" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/bfcc31b7e3c9e9084ed7ee38d5ad963d.svg">
                                                                        <p class="textUsual">REF</p>
                                                                        <p class="textUsual">1</p>
                                                                        </div>
                                                                        <div class="row_small">
                                                                        <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/key.svg" class="keySmall">
                                                                        <p class="textUsual">1</p>
                                                                        </div>
                                                                   </div>
                                                                   <div class="textUsual pale_blue" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы просмотрели все доступные рекламные ролики!</div>
                                                                   <div class="textUsual pale_blue" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You've watched all the available commercials!</div>
                                                                </div>
                                                     </div>`,
                                                            imageAlt: 'error-icon',
                                                            confirmButtonText: confirmButtonText,
                                                            confirmButtonColor: 'rgb(80, 200, 120)',
                                                            showConfirmButton: true,
                                                            backdrop: 'rgba(10, 17, 19, 0.8)',
                                                        });

                                                } else {
                                                        return Swal.fire({
                                                             customClass: {
                                                                 title: 'titleSemiBold titleMain',
                                                                 content: 'textUsual',
                                                                 confirmButton: 'custom-ok-button',
                                                             },
                                                             background: '#19292E',
                                                             html:
                                                                 `<div class="containerPopUp">
                                                         <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/success.svg" class="success-icon">
                                                         <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Отлично!</div>
                                                         <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Great!</div>
                                                         <div class="textUsual" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы ускорили <br> создание ключа</div>
                                                         <div class="textUsual" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}" >You have accelerated <br>the creation of the key</div>
                                                 </div>`,
                                                             imageAlt: 'succes_icon',
                                                             confirmButtonText: confirmButtonText,
                                                             confirmButtonColor: 'rgb(80, 200, 120)',
                                                             showConfirmButton: true,
                                                             backdrop: 'rgba(10, 17, 19, 0.8)'
                                                         });
                                                     }
                                            })
                                            .then(() => { // вынесли fetch в отдельный блок then
                                              ctime += Math.floor(fulltime/20);
                                              limads.textContent = data5.ad+1
                                              return fetch('/boostspeed', {
                                                method: 'POST',
                                                headers: { 'Content-Type': 'application/json' },
                                                body: JSON.stringify({ user_id: userId, ad: "Gigapub" })
                                              });
                                          }).catch(e => {
                                            Swal.fire({
                                                                 customClass: {
                                                                     title: 'titleSemiBold titleMain',
                                                                     content: 'textUsual',
                                                                     confirmButton: 'custom-ok-button',
                                                                 },
                                                                 background: '#19292E',
                                                                 html:
                                                                     `<div class="containerPopUp">
                                                         <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/success.svg" class="success-icon">
                                                         <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Отлично!</div>
                                                         <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Great!</div>
                                                         <div class="textUsual" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы ускорили <br> создание ключа</div>
                                                         <div class="textUsual" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}" >You have accelerated <br>the creation of the key</div>
                                                 </div>`,
                                                                 imageAlt: 'succes_icon',
                                                                 confirmButtonText: confirmButtonText,
                                                                 confirmButtonColor: 'rgb(80, 200, 120)',
                                                                 showConfirmButton: true,
                                                                 backdrop: 'rgba(10, 17, 19, 0.8)'
                                                             });
                                          })
                            }
                            var onSuccess = () => {
                                if (data5.ad == 19) {
                                            Swal.fire({
                                                 customClass: {
                                                     confirmButton: 'custom-ok-button',
                                                 },
                                                 background: '#19292E',
                                                 html:
                                                 `<img style="height: 100%;" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/s-fonom.gif" class="gif">` +
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы получили <br> бонусный ключ!</div>`+
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You got <br> bonus key!</div>`,
                                                 imageAlt: 'succes_icon',
                                                 confirmButtonText: confirmButtonText,
                                                 confirmButtonColor: 'rgb(40, 131, 43)',
                                                 showConfirmButton: true,
                                                 backdrop: 'rgba(10, 17, 19, 0.8)'
                                            });
                                         } else if (data5.ad == 59) {
                                            Swal.fire({
                                                 customClass: {
                                                     confirmButton: 'custom-ok-button',
                                                 },
                                                 background: '#19292E',
                                                 html:
                                                 `<img style="height: 100%;" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/s-fonom.gif" class="gif">` +
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы получили <br> бонусный ключ!</div>`+
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You got <br> bonus key!</div>`,
                                                 imageAlt: 'succes_icon',
                                                 confirmButtonText: confirmButtonText,
                                                 confirmButtonColor: 'rgb(40, 131, 43)',
                                                 showConfirmButton: true,
                                                 backdrop: 'rgba(10, 17, 19, 0.8)'
                                            });
                                         } else if (data5.ad == 39) {
                                            let currentLang = document.documentElement.lang;
                                            if (currentLang === 'ru') {
                                                confirmButtonText = 'Забрать';
                                            } else if (currentLang === 'en') {
                                                confirmButtonText = 'Pick up';
                                            }
                                            Swal.fire({
                                                customClass: {
                                                    confirmButton: 'custom-ok-button',
                                                },
                                                background: '#19292E',
                                                html:
                                                    `<div class="containerPopUp">
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Награда</div>
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Reward</div>
                                                    <div class="row_union">
                                                        <div class="reward_row">
                                                            <div class="row_small pr4">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/TWR.png" class="twrSmall">
                                                            <p class="textUsual">TWR</p>
                                                            <p class="textUsual">100</p>
                                                            </div>
                                                            <div class="row_small pr4">
                                                            <img class="refSmall" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/bfcc31b7e3c9e9084ed7ee38d5ad963d.svg">
                                                            <p class="textUsual">REF</p>
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                            <div class="row_small">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/key.svg" class="keySmall">
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                       </div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы просмотрели половину доступных роликов!</div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You've watched half of the available commercials!</div>
                                                    </div>
                                         </div>`,
                                                imageAlt: 'error-icon',
                                                confirmButtonText: confirmButtonText,
                                                confirmButtonColor: 'rgb(80, 200, 120)',
                                                showConfirmButton: true,
                                                backdrop: 'rgba(10, 17, 19, 0.8)',
                                            });
                                         } else if (data5.ad == 79) {
                                            let currentLang = document.documentElement.lang;
                                            if (currentLang === 'ru') {
                                                confirmButtonText = 'Забрать';
                                            } else if (currentLang === 'en') {
                                                confirmButtonText = 'Pick up';
                                            }
                                            Swal.fire({
                                                customClass: {
                                                    confirmButton: 'custom-ok-button',
                                                },
                                                background: '#19292E',
                                                html:
                                                    `<div class="containerPopUp">
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Награда</div>
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Reward</div>
                                                    <div class="row_union">
                                                        <div class="reward_row">
                                                            <div class="row_small pr4">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/TWR.png" class="twrSmall">
                                                            <p class="textUsual">TWR</p>
                                                            <p class="textUsual">100</p>
                                                            </div>
                                                            <div class="row_small pr4">
                                                            <img class="refSmall" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/bfcc31b7e3c9e9084ed7ee38d5ad963d.svg">
                                                            <p class="textUsual">REF</p>
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                            <div class="row_small">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/key.svg" class="keySmall">
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                       </div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы просмотрели все доступные рекламные ролики!</div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You've watched all the available commercials!</div>
                                                    </div>
                                         </div>`,
                                                imageAlt: 'error-icon',
                                                confirmButtonText: confirmButtonText,
                                                confirmButtonColor: 'rgb(80, 200, 120)',
                                                showConfirmButton: true,
                                                backdrop: 'rgba(10, 17, 19, 0.8)',
                                            });

                                } else {
                                                Swal.fire({
                                                     customClass: {
                                                         title: 'titleSemiBold titleMain',
                                                         content: 'textUsual',
                                                         confirmButton: 'custom-ok-button',
                                                     },
                                                     background: '#19292E',
                                                     html:
                                                         `<div class="containerPopUp">
                                                 <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/success.svg" class="success-icon">
                                                 <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Отлично!</div>
                                                 <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Great!</div>
                                                 <div class="textUsual" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы ускорили <br> создание ключа</div>
                                                 <div class="textUsual" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}" >You have accelerated <br>the creation of the key</div>
                                         </div>`,
                                                     imageAlt: 'succes_icon',
                                                     confirmButtonText: confirmButtonText,
                                                     confirmButtonColor: 'rgb(80, 200, 120)',
                                                     showConfirmButton: true,
                                                     backdrop: 'rgba(10, 17, 19, 0.8)'
                                                 });
                                             }
                                ctime += Math.floor(fulltime/20);
                                  limads.textContent = data5.ad+1
                                  return fetch('/boostspeed', {
                                    method: 'POST',
                                    headers: { 'Content-Type': 'application/json' },
                                    body: JSON.stringify({ user_id: userId, ad: data5.ads })
                                  });
                            }
                            p_adextra(onSuccess, onError);
                        }

                    } else if (data5.status == 2) {
                        let currentLang = document.documentElement.lang;
                        if (currentLang === 'ru') {
                            confirmButtonText = 'Ок';
                        } else if (currentLang === 'en') {
                            confirmButtonText = 'Ok';
                        }
                        Swal.fire({
                            customClass: {
                                title: 'titleSemiBold titleMain',
                                content: 'textUsual',
                                confirmButton: 'error-ok-button',
                            },
                            background: '#19292E',
                            html:
                                `<div class="containerPopUp">
                                <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/error.svg" class="error-icon">
                            <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Реклама</div>
                            <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Advertisement</div>
                            <div class="textUsual" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Ещё не прошли 2 секунды.</div>
                            <div class="textUsual" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">It hasn\'t been 2 seconds yet.</div>
                    </div>`,
                            imageAlt: 'error_icon',
                            showConfirmButton: true,
                            confirmButtonColor: 'rgb(163, 57, 26)',
                            confirmButtonText: confirmButtonText,
                            backdrop: 'rgba(10, 17, 19, 0.8)'
                        });
                    } else {
                        let currentLang = document.documentElement.lang;
                        if (currentLang === 'ru') {
                            confirmButtonText = 'Ок';
                        } else if (currentLang === 'en') {
                            confirmButtonText = 'Ok';
                        }
                        Swal.fire({
                            customClass: {
                                title: 'titleSemiBold titleMain',
                                content: 'textUsual',
                                confirmButton: 'error-ok-button',
                            },
                            background: '#19292E',
                            html:
                                `<div class="containerPopUp">
                                <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/error.svg" class="error-icon">
                            <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Реклама</div>
                            <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Advertisement</div>
                            <div class="textUsual" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Лимит просмотров в этих сутках исчерпан.</div>
                            <div class="textUsual" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}" style="display: none;">The limit of views in these days is exhausted.</div>
                    </div>`,
                            imageAlt: 'error_icon',
                            showConfirmButton: true,
                            confirmButtonColor: 'rgb(163, 57, 26)',
                            confirmButtonText: confirmButtonText,
                            backdrop: 'rgba(10, 17, 19, 0.8)'
                        });
                    }
                  }
                });
            }, wait);
        }

    });

    tenperc.addEventListener('click', async (event) => {
        // Отправка запроса на сервер и обновление баланса
        const response = await fetch('/getkey', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ user_id: userId })
        });
        const data = await response.json();
        const response4 = await fetch('/get_musics', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ user_id: userId })
                    });
        const data4 = await response4.json();
        let soundenabled = data4.music
        let wait = soundenabled === 1 ? 0 : 0
        if (data.result == 1) {
            setTimeout(async () => {
                let currentLang = document.documentElement.lang;
                if (currentLang === 'ru') {
                    confirmButtonText = 'Ок';
                } else if (currentLang === 'en') {
                    confirmButtonText = 'Ok';
                }
                Swal.fire({
                    customClass: {
                        title: 'titleSemiBold titleMain',
                        content: 'textUsual',
                        confirmButton: 'custom-ok-button',
                    },
                    background: '#19292E',
                    html:
                        `<div class="containerPopUp">
                        <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/success.svg" class="success-icon">
                    <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Кузнец</div>
                    <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Blacksmith</div>
                    <div class="textUsual" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы получили ключ</div>
                    <div class="textUsual" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You have received the key</div>
            </div>`,
                    imageAlt: 'succes_icon',
                    confirmButtonText: confirmButtonText,
                    confirmButtonColor: 'rgb(80, 200, 120)',
                    showConfirmButton: true,
                    backdrop: 'rgba(10, 17, 19, 0.8)'
                });
                ctime = Math.floor(lefttime-fulltime);
            }, 100);
        } else {

            setTimeout(async () => {
                let currentLang = document.documentElement.lang;
                if (currentLang === 'ru') {
                    confirmButtonText = 'Да';
                    cancelButtonText = 'Закрыть';
                } else if (currentLang === 'en') {
                    confirmButtonText = 'Yes';
                    cancelButtonText = 'Close';
                }
                Swal.fire({
                    customClass: {
                        title: 'titleSemiBold titleMain',
                        content: 'textUsual',
                        confirmButton: 'custom-ok-button',
                        cancelButton: 'close_btn'
                    },
                    background: '#19292E',
                    color: 'white',
                    html:
                        `<div class="containerPopUp">
                        <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/keys5.png" class="warning-icon" alt="warning_icon">
                        <div class="textUsual" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Ускорить ковку на 10%?</div>
                        <div class="textUsual" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Speed up forging by 10%?</div>
                        </div>`,
                    imageWidth: 81.04, // Ширина иконки
                    imageHeight: 80.94, // Высота иконки
                    showCancelButton: true,
                    showConfirmButton: true,

                    confirmButtonText: confirmButtonText,
                    cancelButtonText: cancelButtonText,
                    confirmButtonColor: 'rgb(80, 200, 120)',
                    cancelButtonColor: 'rgba(249, 192, 80, 0)',
                    customClass: {
                        confirmButton: 'button_speed',
                        cancelButton: 'close_btn',
                    },
                    backdrop: 'rgba(10, 17, 19, 0.8)'
                }).then(async (result) => {
                  if (result.isConfirmed) {
                    window.initCdTma?.({ id: 6052529 })
                    .then(show => window.show = show)
                    .catch(e => {
                        console.log(e)
                        cdTmaError = e;
                    });
                    const response5 = await fetch('/checkadten', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ user_id: userId, cdTmaError:cdTmaError })
                    });
                    const data5 = await response5.json();
                    if (data5.status == 1) {
                        console.log("Текущая реклама" + data5.ads);
                        if (data5.ads == "Adsgram") {
                                AdController.show()
                                     .then((result) => {
                                         if (currentLang === 'ru') {
                                             confirmButtonText = 'Ок';
                                         } else if (currentLang === 'en') {
                                             confirmButtonText = 'Ok';
                                         }
                                         if (data5.ad == 19) {
                                            Swal.fire({
                                                 customClass: {
                                                     confirmButton: 'custom-ok-button',
                                                 },
                                                 background: '#19292E',
                                                 html:
                                                 `<img style="height: 100%;" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/s-fonom.gif" class="gif">` +
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы получили <br> бонусный ключ!</div>`+
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You got <br> bonus key!</div>`,
                                                 imageAlt: 'succes_icon',
                                                 confirmButtonText: confirmButtonText,
                                                 confirmButtonColor: 'rgb(40, 131, 43)',
                                                 showConfirmButton: true,
                                                 backdrop: 'rgba(10, 17, 19, 0.8)'
                                            });
                                         } else if (data5.ad == 59) {
                                            Swal.fire({
                                                 customClass: {
                                                     confirmButton: 'custom-ok-button',
                                                 },
                                                 background: '#19292E',
                                                 html:
                                                 `<img style="height: 100%;" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/s-fonom.gif" class="gif">` +
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы получили <br> бонусный ключ!</div>`+
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You got <br> bonus key!</div>`,
                                                 imageAlt: 'succes_icon',
                                                 confirmButtonText: confirmButtonText,
                                                 confirmButtonColor: 'rgb(40, 131, 43)',
                                                 showConfirmButton: true,
                                                 backdrop: 'rgba(10, 17, 19, 0.8)'
                                            });
                                         } else if (data5.ad == 39) {
                                            let currentLang = document.documentElement.lang;
                                            if (currentLang === 'ru') {
                                                confirmButtonText = 'Забрать';
                                            } else if (currentLang === 'en') {
                                                confirmButtonText = 'Pick up';
                                            }
                                            Swal.fire({
                                                customClass: {
                                                    confirmButton: 'custom-ok-button',
                                                },
                                                background: '#19292E',
                                                html:
                                                    `<div class="containerPopUp">
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Награда</div>
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Reward</div>
                                                    <div class="row_union">
                                                        <div class="reward_row">
                                                            <div class="row_small pr4">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/TWR.png" class="twrSmall">
                                                            <p class="textUsual">TWR</p>
                                                            <p class="textUsual">100</p>
                                                            </div>
                                                            <div class="row_small pr4">
                                                            <img class="refSmall" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/bfcc31b7e3c9e9084ed7ee38d5ad963d.svg">
                                                            <p class="textUsual">REF</p>
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                            <div class="row_small">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/key.svg" class="keySmall">
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                       </div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы просмотрели половину доступных роликов!</div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You've watched half of the available commercials!</div>
                                                    </div>
                                         </div>`,
                                                imageAlt: 'error-icon',
                                                confirmButtonText: confirmButtonText,
                                                confirmButtonColor: 'rgb(80, 200, 120)',
                                                showConfirmButton: true,
                                                backdrop: 'rgba(10, 17, 19, 0.8)',
                                            });
                                         } else if (data5.ad == 79) {
                                            let currentLang = document.documentElement.lang;
                                            if (currentLang === 'ru') {
                                                confirmButtonText = 'Забрать';
                                            } else if (currentLang === 'en') {
                                                confirmButtonText = 'Pick up';
                                            }
                                            Swal.fire({
                                                customClass: {
                                                    confirmButton: 'custom-ok-button',
                                                },
                                                background: '#19292E',
                                                html:
                                                    `<div class="containerPopUp">
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Награда</div>
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Reward</div>
                                                    <div class="row_union">
                                                        <div class="reward_row">
                                                            <div class="row_small pr4">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/TWR.png" class="twrSmall">
                                                            <p class="textUsual">TWR</p>
                                                            <p class="textUsual">100</p>
                                                            </div>
                                                            <div class="row_small pr4">
                                                            <img class="refSmall" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/bfcc31b7e3c9e9084ed7ee38d5ad963d.svg">
                                                            <p class="textUsual">REF</p>
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                            <div class="row_small">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/key.svg" class="keySmall">
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                       </div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы просмотрели все доступные рекламные ролики!</div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You've watched all the available commercials!</div>
                                                    </div>
                                         </div>`,
                                                imageAlt: 'error-icon',
                                                confirmButtonText: confirmButtonText,
                                                confirmButtonColor: 'rgb(80, 200, 120)',
                                                showConfirmButton: true,
                                                backdrop: 'rgba(10, 17, 19, 0.8)',
                                            });

                                         } else {
                                            Swal.fire({
                                                 customClass: {
                                                     title: 'titleSemiBold titleMain',
                                                     content: 'textUsual',
                                                     confirmButton: 'custom-ok-button',
                                                 },
                                                 background: '#19292E',
                                                 html:
                                                     `<div class="containerPopUp">
                                                 <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/success.svg" class="success-icon">
                                                 <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Отлично!</div>
                                                 <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Great!</div>
                                                 <div class="textUsual" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы ускорили <br> создание ключа</div>
                                                 <div class="textUsual" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}" >You have accelerated <br>the creation of the key</div>
                                         </div>`,
                                                 imageAlt: 'succes_icon',
                                                 confirmButtonText: confirmButtonText,
                                                 confirmButtonColor: 'rgb(80, 200, 120)',
                                                 showConfirmButton: true,
                                                 backdrop: 'rgba(10, 17, 19, 0.8)'
                                             });
                                         }
                                       ctime += Math.floor(fulltime/10);
                                       limads.textContent = data5.ad+1
                                       if (data5.ten >= 19) {
                                            tenperc.remove()
                                       }
                                       return fetch('/boostspeedten', {
                                         method: 'POST',
                                         headers: { 'Content-Type': 'application/json' },
                                         body: JSON.stringify({ user_id: userId, ad: data5.ads })
                                       });

                                     })
                                     .then((response) => {
                                       if (!response.ok) {
                                         throw new Error(`HTTP error! status: ${response.status}`);
                                       }
                                       return response.json();
                                     })
                                     .then((data) => {
                                       // process the data if needed
                                     })
                                     .catch((error) => {
                                       console.error('Error:', error);
                                       // handle the error
                                     });
                        } else if (data5.ads == "Gigapub") {
                            window.showGiga()
                              .then(() => {
                                    if (data5.ad == 19) {
                                            Swal.fire({
                                                 customClass: {
                                                     confirmButton: 'custom-ok-button',
                                                 },
                                                 background: '#19292E',
                                                 html:
                                                 `<img style="height: 100%;" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/s-fonom.gif" class="gif">` +
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы получили <br> бонусный ключ!</div>`+
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You got <br> bonus key!</div>`,
                                                 imageAlt: 'succes_icon',
                                                 confirmButtonText: confirmButtonText,
                                                 confirmButtonColor: 'rgb(40, 131, 43)',
                                                 showConfirmButton: true,
                                                 backdrop: 'rgba(10, 17, 19, 0.8)'
                                            });
                                         } else if (data5.ad == 59) {
                                            Swal.fire({
                                                 customClass: {
                                                     confirmButton: 'custom-ok-button',
                                                 },
                                                 background: '#19292E',
                                                 html:
                                                 `<img style="height: 100%;" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/s-fonom.gif" class="gif">` +
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы получили <br> бонусный ключ!</div>`+
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You got <br> bonus key!</div>`,
                                                 imageAlt: 'succes_icon',
                                                 confirmButtonText: confirmButtonText,
                                                 confirmButtonColor: 'rgb(40, 131, 43)',
                                                 showConfirmButton: true,
                                                 backdrop: 'rgba(10, 17, 19, 0.8)'
                                            });
                                         } else if (data5.ad == 39) {
                                            let currentLang = document.documentElement.lang;
                                            if (currentLang === 'ru') {
                                                confirmButtonText = 'Забрать';
                                            } else if (currentLang === 'en') {
                                                confirmButtonText = 'Pick up';
                                            }
                                            Swal.fire({
                                                customClass: {
                                                    confirmButton: 'custom-ok-button',
                                                },
                                                background: '#19292E',
                                                html:
                                                    `<div class="containerPopUp">
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Награда</div>
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Reward</div>
                                                    <div class="row_union">
                                                        <div class="reward_row">
                                                            <div class="row_small pr4">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/TWR.png" class="twrSmall">
                                                            <p class="textUsual">TWR</p>
                                                            <p class="textUsual">100</p>
                                                            </div>
                                                            <div class="row_small pr4">
                                                            <img class="refSmall" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/bfcc31b7e3c9e9084ed7ee38d5ad963d.svg">
                                                            <p class="textUsual">REF</p>
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                            <div class="row_small">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/key.svg" class="keySmall">
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                       </div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы просмотрели половину доступных роликов!</div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You've watched half of the available commercials!</div>
                                                    </div>
                                         </div>`,
                                                imageAlt: 'error-icon',
                                                confirmButtonText: confirmButtonText,
                                                confirmButtonColor: 'rgb(80, 200, 120)',
                                                showConfirmButton: true,
                                                backdrop: 'rgba(10, 17, 19, 0.8)',
                                            });
                                         } else if (data5.ad == 79) {
                                            let currentLang = document.documentElement.lang;
                                            if (currentLang === 'ru') {
                                                confirmButtonText = 'Забрать';
                                            } else if (currentLang === 'en') {
                                                confirmButtonText = 'Pick up';
                                            }
                                            Swal.fire({
                                                customClass: {
                                                    confirmButton: 'custom-ok-button',
                                                },
                                                background: '#19292E',
                                                html:
                                                    `<div class="containerPopUp">
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Награда</div>
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Reward</div>
                                                    <div class="row_union">
                                                        <div class="reward_row">
                                                            <div class="row_small pr4">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/TWR.png" class="twrSmall">
                                                            <p class="textUsual">TWR</p>
                                                            <p class="textUsual">100</p>
                                                            </div>
                                                            <div class="row_small pr4">
                                                            <img class="refSmall" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/bfcc31b7e3c9e9084ed7ee38d5ad963d.svg">
                                                            <p class="textUsual">REF</p>
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                            <div class="row_small">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/key.svg" class="keySmall">
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                       </div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы просмотрели все доступные рекламные ролики!</div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You've watched all the available commercials!</div>
                                                    </div>
                                         </div>`,
                                                imageAlt: 'error-icon',
                                                confirmButtonText: confirmButtonText,
                                                confirmButtonColor: 'rgb(80, 200, 120)',
                                                showConfirmButton: true,
                                                backdrop: 'rgba(10, 17, 19, 0.8)',
                                            });

                                    } else {
                                            return Swal.fire({
                                                 customClass: {
                                                     title: 'titleSemiBold titleMain',
                                                     content: 'textUsual',
                                                     confirmButton: 'custom-ok-button',
                                                 },
                                                 background: '#19292E',
                                                 html:
                                                     `<div class="containerPopUp">
                                                 <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/success.svg" class="success-icon">
                                                 <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Отлично!</div>
                                                 <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Great!</div>
                                                 <div class="textUsual" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы ускорили <br> создание ключа</div>
                                                 <div class="textUsual" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}" >You have accelerated <br>the creation of the key</div>
                                         </div>`,
                                                 imageAlt: 'succes_icon',
                                                 confirmButtonText: confirmButtonText,
                                                 confirmButtonColor: 'rgb(80, 200, 120)',
                                                 showConfirmButton: true,
                                                 backdrop: 'rgba(10, 17, 19, 0.8)'
                                             });
                                         }
                                })
                                .then(() => { // вынесли fetch в отдельный блок then
                                  ctime += Math.floor(fulltime/10);
                                  limads.textContent = data5.ad+1
                                  return fetch('/boostspeedten', {
                                    method: 'POST',
                                    headers: { 'Content-Type': 'application/json' },
                                    body: JSON.stringify({ user_id: userId, ad: data5.ads })
                                  });
                              }).catch(e => {
                                Swal.fire({
                                                     customClass: {
                                                         title: 'titleSemiBold titleMain',
                                                         content: 'textUsual',
                                                         confirmButton: 'custom-ok-button',
                                                     },
                                                     background: '#19292E',
                                                     html:
                                                         `<div class="containerPopUp">
                                                 <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/success.svg" class="success-icon">
                                                 <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Отлично!</div>
                                                 <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Great!</div>
                                                 <div class="textUsual" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы ускорили <br> создание ключа</div>
                                                 <div class="textUsual" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}" >You have accelerated <br>the creation of the key</div>
                                         </div>`,
                                                     imageAlt: 'succes_icon',
                                                     confirmButtonText: confirmButtonText,
                                                     confirmButtonColor: 'rgb(80, 200, 120)',
                                                     showConfirmButton: true,
                                                     backdrop: 'rgba(10, 17, 19, 0.8)'
                                                 });
                              })
                        } else if (data5.ads == "Adextra") {
                                    let confirmButtonText; // Объявим переменную вне then
                                    if (currentLang === 'ru') {
                                        confirmButtonText = 'Ок';
                                    } else if (currentLang === 'en') {
                                        confirmButtonText = 'Ok';
                                    }
                                    id = '8b3998992794ae102e307a783a445dac32e33a7e';
                                    p = function(){}
                                        window.setTimeout('p_adextra(p,p)',2000)
                                    var onError = () => {
                                        window.showGiga()
                                          .then(() => {
                                                if (data5.ad == 19) {
                                            Swal.fire({
                                                 customClass: {
                                                     confirmButton: 'custom-ok-button',
                                                 },
                                                 background: '#19292E',
                                                 html:
                                                 `<img style="height: 100%;" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/s-fonom.gif" class="gif">` +
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы получили <br> бонусный ключ!</div>`+
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You got <br> bonus key!</div>`,
                                                 imageAlt: 'succes_icon',
                                                 confirmButtonText: confirmButtonText,
                                                 confirmButtonColor: 'rgb(40, 131, 43)',
                                                 showConfirmButton: true,
                                                 backdrop: 'rgba(10, 17, 19, 0.8)'
                                            });
                                         } else if (data5.ad == 59) {
                                            Swal.fire({
                                                 customClass: {
                                                     confirmButton: 'custom-ok-button',
                                                 },
                                                 background: '#19292E',
                                                 html:
                                                 `<img style="height: 100%;" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/s-fonom.gif" class="gif">` +
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы получили <br> бонусный ключ!</div>`+
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You got <br> bonus key!</div>`,
                                                 imageAlt: 'succes_icon',
                                                 confirmButtonText: confirmButtonText,
                                                 confirmButtonColor: 'rgb(40, 131, 43)',
                                                 showConfirmButton: true,
                                                 backdrop: 'rgba(10, 17, 19, 0.8)'
                                            });
                                         } else if (data5.ad == 39) {
                                            let currentLang = document.documentElement.lang;
                                            if (currentLang === 'ru') {
                                                confirmButtonText = 'Забрать';
                                            } else if (currentLang === 'en') {
                                                confirmButtonText = 'Pick up';
                                            }
                                            Swal.fire({
                                                customClass: {
                                                    confirmButton: 'custom-ok-button',
                                                },
                                                background: '#19292E',
                                                html:
                                                    `<div class="containerPopUp">
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Награда</div>
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Reward</div>
                                                    <div class="row_union">
                                                        <div class="reward_row">
                                                            <div class="row_small pr4">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/TWR.png" class="twrSmall">
                                                            <p class="textUsual">TWR</p>
                                                            <p class="textUsual">100</p>
                                                            </div>
                                                            <div class="row_small pr4">
                                                            <img class="refSmall" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/bfcc31b7e3c9e9084ed7ee38d5ad963d.svg">
                                                            <p class="textUsual">REF</p>
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                            <div class="row_small">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/key.svg" class="keySmall">
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                       </div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы просмотрели половину доступных роликов!</div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You've watched half of the available commercials!</div>
                                                    </div>
                                         </div>`,
                                                imageAlt: 'error-icon',
                                                confirmButtonText: confirmButtonText,
                                                confirmButtonColor: 'rgb(80, 200, 120)',
                                                showConfirmButton: true,
                                                backdrop: 'rgba(10, 17, 19, 0.8)',
                                            });
                                         } else if (data5.ad == 79) {
                                            let currentLang = document.documentElement.lang;
                                            if (currentLang === 'ru') {
                                                confirmButtonText = 'Забрать';
                                            } else if (currentLang === 'en') {
                                                confirmButtonText = 'Pick up';
                                            }
                                            Swal.fire({
                                                customClass: {
                                                    confirmButton: 'custom-ok-button',
                                                },
                                                background: '#19292E',
                                                html:
                                                    `<div class="containerPopUp">
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Награда</div>
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Reward</div>
                                                    <div class="row_union">
                                                        <div class="reward_row">
                                                            <div class="row_small pr4">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/TWR.png" class="twrSmall">
                                                            <p class="textUsual">TWR</p>
                                                            <p class="textUsual">100</p>
                                                            </div>
                                                            <div class="row_small pr4">
                                                            <img class="refSmall" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/bfcc31b7e3c9e9084ed7ee38d5ad963d.svg">
                                                            <p class="textUsual">REF</p>
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                            <div class="row_small">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/key.svg" class="keySmall">
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                       </div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы просмотрели все доступные рекламные ролики!</div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You've watched all the available commercials!</div>
                                                    </div>
                                         </div>`,
                                                imageAlt: 'error-icon',
                                                confirmButtonText: confirmButtonText,
                                                confirmButtonColor: 'rgb(80, 200, 120)',
                                                showConfirmButton: true,
                                                backdrop: 'rgba(10, 17, 19, 0.8)',
                                            });

                                         } else {
                                                        return Swal.fire({
                                                             customClass: {
                                                                 title: 'titleSemiBold titleMain',
                                                                 content: 'textUsual',
                                                                 confirmButton: 'custom-ok-button',
                                                             },
                                                             background: '#19292E',
                                                             html:
                                                                 `<div class="containerPopUp">
                                                         <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/success.svg" class="success-icon">
                                                         <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Отлично!</div>
                                                         <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Great!</div>
                                                         <div class="textUsual" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы ускорили <br> создание ключа</div>
                                                         <div class="textUsual" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}" >You have accelerated <br>the creation of the key</div>
                                                 </div>`,
                                                             imageAlt: 'succes_icon',
                                                             confirmButtonText: confirmButtonText,
                                                             confirmButtonColor: 'rgb(80, 200, 120)',
                                                             showConfirmButton: true,
                                                             backdrop: 'rgba(10, 17, 19, 0.8)'
                                                         });
                                                     }
                                            })
                                            .then(() => { // вынесли fetch в отдельный блок then
                                              ctime += Math.floor(fulltime/10);
                                              limads.textContent = data5.ad+1
                                              return fetch('/boostspeedten', {
                                                method: 'POST',
                                                headers: { 'Content-Type': 'application/json' },
                                                body: JSON.stringify({ user_id: userId, ad: "Gigapub" })
                                              });
                                          }).catch(e => {
                                            Swal.fire({
                                                                 customClass: {
                                                                     title: 'titleSemiBold titleMain',
                                                                     content: 'textUsual',
                                                                     confirmButton: 'custom-ok-button',
                                                                 },
                                                                 background: '#19292E',
                                                                 html:
                                                                     `<div class="containerPopUp">
                                                         <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/success.svg" class="success-icon">
                                                         <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Отлично!</div>
                                                         <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Great!</div>
                                                         <div class="textUsual" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы ускорили <br> создание ключа</div>
                                                         <div class="textUsual" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}" >You have accelerated <br>the creation of the key</div>
                                                 </div>`,
                                                                 imageAlt: 'succes_icon',
                                                                 confirmButtonText: confirmButtonText,
                                                                 confirmButtonColor: 'rgb(80, 200, 120)',
                                                                 showConfirmButton: true,
                                                                 backdrop: 'rgba(10, 17, 19, 0.8)'
                                                             });
                                          })
                                    }
                                    var onSuccess = () => {
                                            if (data5.ad == 19) {
                                            Swal.fire({
                                                 customClass: {
                                                     confirmButton: 'custom-ok-button',
                                                 },
                                                 background: '#19292E',
                                                 html:
                                                 `<img style="height: 100%;" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/s-fonom.gif" class="gif">` +
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы получили <br> бонусный ключ!</div>`+
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You got <br> bonus key!</div>`,
                                                 imageAlt: 'succes_icon',
                                                 confirmButtonText: confirmButtonText,
                                                 confirmButtonColor: 'rgb(40, 131, 43)',
                                                 showConfirmButton: true,
                                                 backdrop: 'rgba(10, 17, 19, 0.8)'
                                            });
                                         } else if (data5.ad == 59) {
                                            Swal.fire({
                                                 customClass: {
                                                     confirmButton: 'custom-ok-button',
                                                 },
                                                 background: '#19292E',
                                                 html:
                                                 `<img style="height: 100%;" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/s-fonom.gif" class="gif">` +
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы получили <br> бонусный ключ!</div>`+
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You got <br> bonus key!</div>`,
                                                 imageAlt: 'succes_icon',
                                                 confirmButtonText: confirmButtonText,
                                                 confirmButtonColor: 'rgb(40, 131, 43)',
                                                 showConfirmButton: true,
                                                 backdrop: 'rgba(10, 17, 19, 0.8)'
                                            });
                                         } else if (data5.ad == 39) {
                                            let currentLang = document.documentElement.lang;
                                            if (currentLang === 'ru') {
                                                confirmButtonText = 'Забрать';
                                            } else if (currentLang === 'en') {
                                                confirmButtonText = 'Pick up';
                                            }
                                            Swal.fire({
                                                customClass: {
                                                    confirmButton: 'custom-ok-button',
                                                },
                                                background: '#19292E',
                                                html:
                                                    `<div class="containerPopUp">
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Награда</div>
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Reward</div>
                                                    <div class="row_union">
                                                        <div class="reward_row">
                                                            <div class="row_small pr4">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/TWR.png" class="twrSmall">
                                                            <p class="textUsual">TWR</p>
                                                            <p class="textUsual">100</p>
                                                            </div>
                                                            <div class="row_small pr4">
                                                            <img class="refSmall" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/bfcc31b7e3c9e9084ed7ee38d5ad963d.svg">
                                                            <p class="textUsual">REF</p>
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                            <div class="row_small">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/key.svg" class="keySmall">
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                       </div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы просмотрели половину доступных роликов!</div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You've watched half of the available commercials!</div>
                                                    </div>
                                         </div>`,
                                                imageAlt: 'error-icon',
                                                confirmButtonText: confirmButtonText,
                                                confirmButtonColor: 'rgb(80, 200, 120)',
                                                showConfirmButton: true,
                                                backdrop: 'rgba(10, 17, 19, 0.8)',
                                            });
                                         } else if (data5.ad == 79) {
                                            let currentLang = document.documentElement.lang;
                                            if (currentLang === 'ru') {
                                                confirmButtonText = 'Забрать';
                                            } else if (currentLang === 'en') {
                                                confirmButtonText = 'Pick up';
                                            }
                                            Swal.fire({
                                                customClass: {
                                                    confirmButton: 'custom-ok-button',
                                                },
                                                background: '#19292E',
                                                html:
                                                    `<div class="containerPopUp">
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Награда</div>
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Reward</div>
                                                    <div class="row_union">
                                                        <div class="reward_row">
                                                            <div class="row_small pr4">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/TWR.png" class="twrSmall">
                                                            <p class="textUsual">TWR</p>
                                                            <p class="textUsual">100</p>
                                                            </div>
                                                            <div class="row_small pr4">
                                                            <img class="refSmall" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/bfcc31b7e3c9e9084ed7ee38d5ad963d.svg">
                                                            <p class="textUsual">REF</p>
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                            <div class="row_small">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/key.svg" class="keySmall">
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                       </div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы просмотрели все доступные рекламные ролики!</div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You've watched all the available commercials!</div>
                                                    </div>
                                         </div>`,
                                                imageAlt: 'error-icon',
                                                confirmButtonText: confirmButtonText,
                                                confirmButtonColor: 'rgb(80, 200, 120)',
                                                showConfirmButton: true,
                                                backdrop: 'rgba(10, 17, 19, 0.8)',
                                            });

                                         } else {
                                                    Swal.fire({
                                                         customClass: {
                                                             title: 'titleSemiBold titleMain',
                                                             content: 'textUsual',
                                                             confirmButton: 'custom-ok-button',
                                                         },
                                                         background: '#19292E',
                                                         html:
                                                             `<div class="containerPopUp">
                                                     <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/success.svg" class="success-icon">
                                                     <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Отлично!</div>
                                                     <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Great!</div>
                                                     <div class="textUsual" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы ускорили <br> создание ключа</div>
                                                     <div class="textUsual" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}" >You have accelerated <br>the creation of the key</div>
                                             </div>`,
                                                         imageAlt: 'succes_icon',
                                                         confirmButtonText: confirmButtonText,
                                                         confirmButtonColor: 'rgb(80, 200, 120)',
                                                         showConfirmButton: true,
                                                         backdrop: 'rgba(10, 17, 19, 0.8)'
                                                     });
                                                 }
                                        ctime += Math.floor(fulltime/10);
                                          limads.textContent = data5.ad+1
                                          return fetch('/boostspeedten', {
                                            method: 'POST',
                                            headers: { 'Content-Type': 'application/json' },
                                            body: JSON.stringify({ user_id: userId, ad: data5.ads })
                                          });
                                    }
                                    p_adextra(onSuccess, onError);
                        } else if (data5.ads == "Onlick") {
                                let confirmButtonText; // Объявим переменную вне then
                                if (currentLang === 'ru') {
                                    confirmButtonText = 'Ок';
                                } else if (currentLang === 'en') {
                                    confirmButtonText = 'Ok';
                                }

                                window.show?.()
                                .then(() => {
                                    console.log('here');
                                    if (data5.ad == 19) {
                                            Swal.fire({
                                                 customClass: {
                                                     confirmButton: 'custom-ok-button',
                                                 },
                                                 background: '#19292E',
                                                 html:
                                                 `<img style="height: 100%;" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/s-fonom.gif" class="gif">` +
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы получили <br> бонусный ключ!</div>`+
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You got <br> bonus key!</div>`,
                                                 imageAlt: 'succes_icon',
                                                 confirmButtonText: confirmButtonText,
                                                 confirmButtonColor: 'rgb(40, 131, 43)',
                                                 showConfirmButton: true,
                                                 backdrop: 'rgba(10, 17, 19, 0.8)'
                                            });
                                         } else if (data5.ad == 59) {
                                            Swal.fire({
                                                 customClass: {
                                                     confirmButton: 'custom-ok-button',
                                                 },
                                                 background: '#19292E',
                                                 html:
                                                 `<img style="height: 100%;" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/s-fonom.gif" class="gif">` +
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы получили <br> бонусный ключ!</div>`+
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You got <br> bonus key!</div>`,
                                                 imageAlt: 'succes_icon',
                                                 confirmButtonText: confirmButtonText,
                                                 confirmButtonColor: 'rgb(40, 131, 43)',
                                                 showConfirmButton: true,
                                                 backdrop: 'rgba(10, 17, 19, 0.8)'
                                            });
                                         } else if (data5.ad == 39) {
                                            let currentLang = document.documentElement.lang;
                                            if (currentLang === 'ru') {
                                                confirmButtonText = 'Забрать';
                                            } else if (currentLang === 'en') {
                                                confirmButtonText = 'Pick up';
                                            }
                                            Swal.fire({
                                                customClass: {
                                                    confirmButton: 'custom-ok-button',
                                                },
                                                background: '#19292E',
                                                html:
                                                    `<div class="containerPopUp">
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Награда</div>
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Reward</div>
                                                    <div class="row_union">
                                                        <div class="reward_row">
                                                            <div class="row_small pr4">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/TWR.png" class="twrSmall">
                                                            <p class="textUsual">TWR</p>
                                                            <p class="textUsual">100</p>
                                                            </div>
                                                            <div class="row_small pr4">
                                                            <img class="refSmall" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/bfcc31b7e3c9e9084ed7ee38d5ad963d.svg">
                                                            <p class="textUsual">REF</p>
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                            <div class="row_small">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/key.svg" class="keySmall">
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                       </div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы просмотрели половину доступных роликов!</div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You've watched half of the available commercials!</div>
                                                    </div>
                                         </div>`,
                                                imageAlt: 'error-icon',
                                                confirmButtonText: confirmButtonText,
                                                confirmButtonColor: 'rgb(80, 200, 120)',
                                                showConfirmButton: true,
                                                backdrop: 'rgba(10, 17, 19, 0.8)',
                                            });
                                         } else if (data5.ad == 79) {
                                            let currentLang = document.documentElement.lang;
                                            if (currentLang === 'ru') {
                                                confirmButtonText = 'Забрать';
                                            } else if (currentLang === 'en') {
                                                confirmButtonText = 'Pick up';
                                            }
                                            Swal.fire({
                                                customClass: {
                                                    confirmButton: 'custom-ok-button',
                                                },
                                                background: '#19292E',
                                                html:
                                                    `<div class="containerPopUp">
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Награда</div>
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Reward</div>
                                                    <div class="row_union">
                                                        <div class="reward_row">
                                                            <div class="row_small pr4">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/TWR.png" class="twrSmall">
                                                            <p class="textUsual">TWR</p>
                                                            <p class="textUsual">100</p>
                                                            </div>
                                                            <div class="row_small pr4">
                                                            <img class="refSmall" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/bfcc31b7e3c9e9084ed7ee38d5ad963d.svg">
                                                            <p class="textUsual">REF</p>
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                            <div class="row_small">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/key.svg" class="keySmall">
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                       </div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы просмотрели все доступные рекламные ролики!</div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You've watched all the available commercials!</div>
                                                    </div>
                                         </div>`,
                                                imageAlt: 'error-icon',
                                                confirmButtonText: confirmButtonText,
                                                confirmButtonColor: 'rgb(80, 200, 120)',
                                                showConfirmButton: true,
                                                backdrop: 'rgba(10, 17, 19, 0.8)',
                                            });

                                         } else {
                                            return Swal.fire({
                                                 customClass: {
                                                     title: 'titleSemiBold titleMain',
                                                     content: 'textUsual',
                                                     confirmButton: 'custom-ok-button',
                                                 },
                                                 background: '#19292E',
                                                 html:
                                                     `<div class="containerPopUp">
                                                 <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/success.svg" class="success-icon">
                                                 <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Отлично!</div>
                                                 <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Great!</div>
                                                 <div class="textUsual" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы ускорили <br> создание ключа</div>
                                                 <div class="textUsual" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}" >You have accelerated <br>the creation of the key</div>
                                         </div>`,
                                                 imageAlt: 'succes_icon',
                                                 confirmButtonText: confirmButtonText,
                                                 confirmButtonColor: 'rgb(80, 200, 120)',
                                                 showConfirmButton: true,
                                                 backdrop: 'rgba(10, 17, 19, 0.8)'
                                             });
                                         }
                                })
                                .then(() => { // вынесли fetch в отдельный блок then
                                  ctime += Math.floor(fulltime/10);
                                  limads.textContent = data5.ad+1
                                  if (data5.ten >= 19) {
                                            tenperc.remove()
                                  }
                                  return fetch('/boostspeedten', {
                                    method: 'POST',
                                    headers: { 'Content-Type': 'application/json' },
                                    body: JSON.stringify({ user_id: userId, ad: data5.ads })
                                  });
                              })
                               .catch(e => {
                                    console.log(e);
                                    return Swal.fire({
                                         customClass: {
                                             title: 'titleSemiBold titleMain',
                                             content: 'textUsual',
                                             confirmButton: 'error-ok-button',
                                         },
                                         background: '#19292E',
                                         html:
                                             `<div class="containerPopUp">
                                             <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/error.svg" class="error-icon">
                                         <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Реклама</div>
                                         <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Advertisement</div>
                                         <div class="textUsual" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Для вас сейчас нет рекламы от этого партнёра, попробуйте ещё раз</div>
                                         <div class="textUsual" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">There is no advertisement for you from that partner</div>
                               </div>`,
                                         imageAlt: 'error_icon',
                                         showConfirmButton: true,
                                         confirmButtonColor: 'rgb(163, 57, 26)',
                                         confirmButtonText: confirmButtonText,
                                         backdrop: 'rgba(10, 17, 19, 0.8)'
                                    });
                               });
                            }
                    } else if (data5.status == 2) {
                        let currentLang = document.documentElement.lang;
                        if (currentLang === 'ru') {
                            confirmButtonText = 'Ок';
                        } else if (currentLang === 'en') {
                            confirmButtonText = 'Ok';
                        }
                        Swal.fire({
                            customClass: {
                                title: 'titleSemiBold titleMain',
                                content: 'textUsual',
                                confirmButton: 'error-ok-button',
                            },
                            background: '#19292E',
                            html:
                                `<div class="containerPopUp">
                                <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/error.svg" class="error-icon">
                            <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}"></div>
                            <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}"></div>
                            <div class="textUsual" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Ещё не прошли 2 секунды.</div>
                            <div class="textUsual" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">It hasn\'t been 2 seconds yet.</div>
                    </div>`,
                            imageAlt: 'error_icon',
                            showConfirmButton: true,
                            confirmButtonColor: 'rgb(163, 57, 26)',
                            confirmButtonText: confirmButtonText,
                            backdrop: 'rgba(10, 17, 19, 0.8)'
                        });
                    } else {
                        let currentLang = document.documentElement.lang;
                        if (currentLang === 'ru') {
                            confirmButtonText = 'Ок';
                        } else if (currentLang === 'en') {
                            confirmButtonText = 'Ok';
                        }
                        Swal.fire({
                            customClass: {
                                title: 'titleSemiBold titleMain',
                                content: 'textUsual',
                                confirmButton: 'error-ok-button',
                            },
                            background: '#19292E',
                            html:
                                `<div class="containerPopUp">
                                <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/error.svg" class="error-icon">
                            <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}"></div>
                            <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}"></div>
                            <div class="textUsual" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Лимит ускорений в этих сутках исчерпан.</div>
                            <div class="textUsual" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}" style="display: none;">The limit of boosts in these days is exhausted.</div>
                    </div>`,
                            imageAlt: 'error_icon',
                            showConfirmButton: true,
                            confirmButtonColor: 'rgb(163, 57, 26)',
                            confirmButtonText: confirmButtonText,
                            backdrop: 'rgba(10, 17, 19, 0.8)'
                        });
                        tenperc.remove()
                    }
                  }
                });
            }, wait);
        }

    });

    tenkeys.addEventListener('click', async (event) => {
            const response = await fetch('/get_url', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ user_id: userId })
            });
            const data = await response.json();
            url = data.url;
            window.Telegram.WebApp.openInvoice(url, async (status) => {
                if (status === "cancelled" || status === "failed") {
                    console.log(status);
                } else {
                    limitBUY += 1
                    if (limitBUY >= 10) {
                        tenkeys.remove()
                    }
                    let currentLang = document.documentElement.lang;
                    if (currentLang === 'ru') {
                            confirmButtonText = 'Ок';
                    } else if (currentLang === 'en') {
                            confirmButtonText = 'Ok';
                    }
                    Swal.fire({
                                     customClass: {
                                         title: 'titleSemiBold titleMain',
                                         content: 'customclas2',
                                         confirmButton: 'custom-ok-button',
                                     },
                                     background: '#19292E',
                                     html:
                                         `<div class="containerPopUp">
                                     <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/success.svg" class="success-icon">
                                         <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Отлично!</div>
                                         <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Great!</div>
                                         <div class="textUsual" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы купили 10 ключей!</div>
                                         <div class="textUsual" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}" style="display: none;">You have bought 10 keys!</div>
                </div>`,
                        imageAlt: 'succes_icon',
                                     confirmButtonText: confirmButtonText,
                                     confirmButtonColor: 'rgb(80, 200, 120)',
                                     showConfirmButton: true,
                                     backdrop: 'rgba(10, 17, 19, 0.8)'
                    });
                }
                console.log(status);
            });
    });

    fastkey.addEventListener('click', async (event) => {
        // Отправка запроса на сервер и обновление баланса
        const response = await fetch('/getkey', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ user_id: userId })
        });
        const data = await response.json();
        const response4 = await fetch('/get_musics', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ user_id: userId })
                    });
        const data4 = await response4.json();
        let soundenabled = data4.music
        let wait = soundenabled === 1 ? 0 : 0
        if (data.result == 1) {
            setTimeout(async () => {
                let currentLang = document.documentElement.lang;
                if (currentLang === 'ru') {
                    confirmButtonText = 'Ок';
                } else if (currentLang === 'en') {
                    confirmButtonText = 'Ok';
                }
                Swal.fire({
                    customClass: {
                        title: 'titleSemiBold titleMain',
                        content: 'textUsual',
                        confirmButton: 'custom-ok-button',
                    },
                    background: '#19292E',
                    html:
                        `<div class="containerPopUp">
                        <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/success.svg" class="success-icon">
                    <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Кузнец</div>
                    <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Blacksmith</div>
                    <div class="textUsual" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы получили ключ</div>
                    <div class="textUsual" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You have received the key</div>
            </div>`,
                    imageAlt: 'succes_icon',
                    confirmButtonText: confirmButtonText,
                    confirmButtonColor: 'rgb(80, 200, 120)',
                    showConfirmButton: true,
                    backdrop: 'rgba(10, 17, 19, 0.8)'
                });
                ctime = Math.floor(lefttime-fulltime);
            }, 100);
        } else {

            setTimeout(async () => {
                let currentLang = document.documentElement.lang;
                if (currentLang === 'ru') {
                    confirmButtonText = 'Да';
                    cancelButtonText = 'Нет';
                } else if (currentLang === 'en') {
                    confirmButtonText = 'Yes';
                    cancelButtonText = 'No';
                }
                Swal.fire({
                    customClass: {
                        title: 'titleSemiBold titleMain',
                        content: 'textUsual',
                        confirmButton: 'custom-ok-button',
                        cancelButton: 'button_second'
                    },
                    background: '#19292E',
                    color: 'white',
                    html:
                        `<div class="containerPopUp">
                       <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/keys5.png" class="warning-icon" alt="warning_icon">
                       <div class="textUsual" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Получить быстрый ключ?</div>
                       <div class="textUsual" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Get a fast key?</div>
</div>`,
                    imageWidth: 81.04, // Ширина иконки
                    imageHeight: 80.94, // Высота иконки
                    showCancelButton: true,
                    showConfirmButton: true,

                    confirmButtonText: confirmButtonText,
                    cancelButtonText: cancelButtonText,
                    confirmButtonColor: 'rgb(80, 200, 120)',
                    cancelButtonColor: 'rgb(139, 86, 40)',
                    customClass: {
                        confirmButton: 'button_speed',
                        cancelButton: 'button_second',
                    },
                    backdrop: 'rgba(10, 17, 19, 0.8)'
                }).then(async (result) => {
                  if (result.isConfirmed) {
                    window.initCdTma?.({ id: 6052529 })
                    .then(show => window.show = show)
                    .catch(e => {
                        console.log(e)
                        cdTmaError = e;
                    });
                    const response5 = await fetch('/checkadkey', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ user_id: userId, cdTmaError: cdTmaError })
                    });
                    const data5 = await response5.json();
                    if (data5.status == 1) {
                        console.log("Текущая реклама" + data5.ads);
                        if (data5.ads == "Adsgram") {
                                AdController.show()
                                     .then((result) => {
                                         if (currentLang === 'ru') {
                                             confirmButtonText = 'Ок';
                                         } else if (currentLang === 'en') {
                                             confirmButtonText = 'Ok';
                                         }
                                         Swal.fire({
                                                 customClass: {
                                                     confirmButton: 'custom-ok-button',
                                                 },
                                                 background: '#19292E',
                                                 html:
                                                 `<img style="height: 100%;" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/s-fonom.gif" class="gif">` +
                                             `<div class="titleSemiBold titleMain white" style="margin-top: -53.02px; ${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы получили <br> быстрый ключ!</div>`+
                                             `<div class="titleSemiBold titleMain white" style="margin-top: -53.02px; ${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You got <br> fast key!</div>`,
                                             imageAlt: 'succes_icon',
                                                 confirmButtonText: confirmButtonText,
                                                 confirmButtonColor: 'rgb(40, 131, 43)',
                                                 showConfirmButton: true,
                                                 backdrop: 'rgba(10, 17, 19, 0.8)'
                                         });
                                       limads.textContent = data5.ad+1
                                       fastkey.remove()
                                       return fetch('/boostspeedkey', {
                                         method: 'POST',
                                         headers: { 'Content-Type': 'application/json' },
                                         body: JSON.stringify({ user_id: userId, ad: data5.ads })
                                       });

                                     })
                                     .then((response) => {
                                       if (!response.ok) {
                                         throw new Error(`HTTP error! status: ${response.status}`);
                                       }
                                       return response.json();
                                     })
                                     .then((data) => {
                                       // process the data if needed
                                     })
                                     .catch((error) => {
                                       console.error('Error:', error);
                                       // handle the error
                                     });
                            } else if (data5.ads == "Adextra") {
                                    let confirmButtonText; // Объявим переменную вне then
                                    if (currentLang === 'ru') {
                                        confirmButtonText = 'Ок';
                                    } else if (currentLang === 'en') {
                                        confirmButtonText = 'Ok';
                                    }
                                    id = '8b3998992794ae102e307a783a445dac32e33a7e';
                                    p = function(){}
                                        window.setTimeout('p_adextra(p,p)',2000)
                                    var onError = () => {
                                        return Swal.fire({
                                             customClass: {
                                                 title: 'titleSemiBold titleMain',
                                                 content: 'textUsual',
                                                 confirmButton: 'error-ok-button',
                                             },
                                             background: '#19292E',
                                             html:
                                                 `<div class="containerPopUp">
                                                 <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/error.svg" class="error-icon">
                                             <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Реклама</div>
                                             <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Advertisement</div>
                                             <div class="textUsual" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Для вас сейчас нет рекламы от этого партнёра, попробуйте ещё раз</div>
                                             <div class="textUsual" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">There is no advertisement for you from that partner</div>
                                   </div>`,
                                             imageAlt: 'error_icon',
                                             showConfirmButton: true,
                                             confirmButtonColor: 'rgb(163, 57, 26)',
                                             confirmButtonText: confirmButtonText,
                                             backdrop: 'rgba(10, 17, 19, 0.8)'
                                        });
                                    }
                                    var onSuccess = () => {
                                         if (data5.ad == 19) {
                                            Swal.fire({
                                                 customClass: {
                                                     confirmButton: 'custom-ok-button',
                                                 },
                                                 background: '#19292E',
                                                 html:
                                                 `<img style="height: 100%;" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/s-fonom.gif" class="gif">` +
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы получили <br> бонусный ключ!</div>`+
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You got <br> bonus key!</div>`,
                                                 imageAlt: 'succes_icon',
                                                 confirmButtonText: confirmButtonText,
                                                 confirmButtonColor: 'rgb(40, 131, 43)',
                                                 showConfirmButton: true,
                                                 backdrop: 'rgba(10, 17, 19, 0.8)'
                                            });
                                         } else if (data5.ad == 59) {
                                            Swal.fire({
                                                 customClass: {
                                                     confirmButton: 'custom-ok-button',
                                                 },
                                                 background: '#19292E',
                                                 html:
                                                 `<img style="height: 100%;" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/s-fonom.gif" class="gif">` +
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы получили <br> бонусный ключ!</div>`+
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You got <br> bonus key!</div>`,
                                                 imageAlt: 'succes_icon',
                                                 confirmButtonText: confirmButtonText,
                                                 confirmButtonColor: 'rgb(40, 131, 43)',
                                                 showConfirmButton: true,
                                                 backdrop: 'rgba(10, 17, 19, 0.8)'
                                            });
                                         } else if (data5.ad == 39) {
                                            let currentLang = document.documentElement.lang;
                                            if (currentLang === 'ru') {
                                                confirmButtonText = 'Забрать';
                                            } else if (currentLang === 'en') {
                                                confirmButtonText = 'Pick up';
                                            }
                                            Swal.fire({
                                                customClass: {
                                                    confirmButton: 'custom-ok-button',
                                                },
                                                background: '#19292E',
                                                html:
                                                    `<div class="containerPopUp">
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Награда</div>
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Reward</div>
                                                    <div class="row_union">
                                                        <div class="reward_row">
                                                            <div class="row_small pr4">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/TWR.png" class="twrSmall">
                                                            <p class="textUsual">TWR</p>
                                                            <p class="textUsual">100</p>
                                                            </div>
                                                            <div class="row_small pr4">
                                                            <img class="refSmall" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/bfcc31b7e3c9e9084ed7ee38d5ad963d.svg">
                                                            <p class="textUsual">REF</p>
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                            <div class="row_small">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/key.svg" class="keySmall">
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                       </div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы просмотрели половину доступных роликов!</div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You've watched half of the available commercials!</div>
                                                    </div>
                                         </div>`,
                                                imageAlt: 'error-icon',
                                                confirmButtonText: confirmButtonText,
                                                confirmButtonColor: 'rgb(80, 200, 120)',
                                                showConfirmButton: true,
                                                backdrop: 'rgba(10, 17, 19, 0.8)',
                                            });
                                         } else if (data5.ad == 79) {
                                            let currentLang = document.documentElement.lang;
                                            if (currentLang === 'ru') {
                                                confirmButtonText = 'Забрать';
                                            } else if (currentLang === 'en') {
                                                confirmButtonText = 'Pick up';
                                            }
                                            Swal.fire({
                                                customClass: {
                                                    confirmButton: 'custom-ok-button',
                                                },
                                                background: '#19292E',
                                                html:
                                                    `<div class="containerPopUp">
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Награда</div>
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Reward</div>
                                                    <div class="row_union">
                                                        <div class="reward_row">
                                                            <div class="row_small pr4">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/TWR.png" class="twrSmall">
                                                            <p class="textUsual">TWR</p>
                                                            <p class="textUsual">100</p>
                                                            </div>
                                                            <div class="row_small pr4">
                                                            <img class="refSmall" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/bfcc31b7e3c9e9084ed7ee38d5ad963d.svg">
                                                            <p class="textUsual">REF</p>
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                            <div class="row_small">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/key.svg" class="keySmall">
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                       </div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы просмотрели все доступные рекламные ролики!</div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You've watched all the available commercials!</div>
                                                    </div>
                                         </div>`,
                                                imageAlt: 'error-icon',
                                                confirmButtonText: confirmButtonText,
                                                confirmButtonColor: 'rgb(80, 200, 120)',
                                                showConfirmButton: true,
                                                backdrop: 'rgba(10, 17, 19, 0.8)',
                                            });

                                         } else {
                                                    Swal.fire({
                                                                 customClass: {
                                                                     confirmButton: 'custom-ok-button',
                                                                 },
                                                                 background: '#19292E',
                                                                 html:
                                                            `<img style="height: 100%;" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/s-fonom.gif" class="gif">` +
                                                        `<div class="titleSemiBold titleMain white" style="margin-top: -53.02px; ${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы получили <br> быстрый ключ!</div>`+
                                                        `<div class="titleSemiBold titleMain white" style="margin-top: -53.02px; ${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You got <br> fast key!</div>`,
                                                                 imageAlt: 'succes_icon',
                                                                 confirmButtonText: confirmButtonText,
                                                                 confirmButtonColor: 'rgb(40, 131, 43)',
                                                                 showConfirmButton: true,
                                                                 backdrop: 'rgba(10, 17, 19, 0.8)'
                                                    });
                                                 }
                                          limads.textContent = data5.ad+1
                                          fastkey.remove()
                                          return fetch('/boostspeedkey', {
                                            method: 'POST',
                                            headers: { 'Content-Type': 'application/json' },
                                            body: JSON.stringify({ user_id: userId, ad: data5.ads })
                                          });
                                    }
                                    p_adextra(onSuccess, onError);
                            } else if (data5.ads == "Onlick") {
                                let confirmButtonText; // Объявим переменную вне then
                                if (currentLang === 'ru') {
                                    confirmButtonText = 'Ок';
                                } else if (currentLang === 'en') {
                                    confirmButtonText = 'Ok';
                                }

                                console.log("tyt")

                                window.show?.()
                                .then(() => {
                                    console.log("запускаю")
                                    return Swal.fire({
                                                 customClass: {
                                                     confirmButton: 'custom-ok-button',
                                                 },
                                                 background: '#19292E',
                                                 html:
                                            `<img style="height: 100%;" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/s-fonom.gif" class="gif">` +
                                        `<div class="titleSemiBold titleMain white" style="margin-top: -53.02px; ${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы получили <br> быстрый ключ!</div>`+
                                        `<div class="titleSemiBold titleMain white" style="margin-top: -53.02px; ${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You got <br> fast key!</div>`,
                                                 imageAlt: 'succes_icon',
                                                 confirmButtonText: confirmButtonText,
                                                 confirmButtonColor: 'rgb(40, 131, 43)',
                                                 showConfirmButton: true,
                                                 backdrop: 'rgba(10, 17, 19, 0.8)'
                                    });
                                })
                                .then(() => { // вынесли fetch в отдельный блок then
                                  limads.textContent = data5.ad+1
                                  fastkey.remove()
                                  return fetch('/boostspeedkey', {
                                    method: 'POST',
                                    headers: { 'Content-Type': 'application/json' },
                                    body: JSON.stringify({ user_id: userId, ad: data5.ads })
                                  });
                              })
                               .catch(e => {
                                    console.log(e);
                                    Swal.fire({
                                         customClass: {
                                             title: 'titleSemiBold titleMain',
                                             content: 'textUsual',
                                             confirmButton: 'error-ok-button',
                                         },
                                         background: '#19292E',
                                         html:
                                             `<div class="containerPopUp">
                                             <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/error.svg" class="error-icon">
                                         <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Реклама</div>
                                         <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Advertisement</div>
                                         <div class="textUsual" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Для вас сейчас нет рекламы от этого партнёра, попробуйте ещё раз</div>
                                         <div class="textUsual" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">There is no advertisement for you from that partner</div>
                               </div>`,
                                         imageAlt: 'error_icon',
                                         showConfirmButton: true,
                                         confirmButtonColor: 'rgb(163, 57, 26)',
                                         confirmButtonText: confirmButtonText,
                                         backdrop: 'rgba(10, 17, 19, 0.8)'
                                    });
                               });
                            }
                    } else if (data5.status == 2) {
                        let currentLang = document.documentElement.lang;
                        if (currentLang === 'ru') {
                            confirmButtonText = 'Ок';
                        } else if (currentLang === 'en') {
                            confirmButtonText = 'Ok';
                        }
                        Swal.fire({
                            customClass: {
                                title: 'titleSemiBold titleMain',
                                content: 'textUsual',
                                confirmButton: 'error-ok-button',
                            },
                            background: '#19292E',
                            html:
                                `<div class="containerPopUp">
                                <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/error.svg" class="error-icon">
                            <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}"></div>
                            <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}"></div>
                            <div class="textUsual" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Ещё не прошли 2 секунды.</div>
                            <div class="textUsual" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">It hasn\'t been 2 seconds yet.</div>
                    </div>`,
                            imageAlt: 'error_icon',
                            showConfirmButton: true,
                            confirmButtonColor: 'rgb(163, 57, 26)',
                            confirmButtonText: confirmButtonText,
                            backdrop: 'rgba(10, 17, 19, 0.8)'
                        });
                    } else {
                        let currentLang = document.documentElement.lang;
                        if (currentLang === 'ru') {
                            confirmButtonText = 'Ок';
                        } else if (currentLang === 'en') {
                            confirmButtonText = 'Ok';
                        }
                        Swal.fire({
                            customClass: {
                                title: 'titleSemiBold titleMain',
                                content: 'textUsual',
                                confirmButton: 'error-ok-button',
                            },
                            background: '#19292E',
                            html:
                                `<div class="containerPopUp">
                                <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/error.svg" class="error-icon">
                            <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}"></div>
                            <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}"></div>
                            <div class="textUsual" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Лимит ключей в этих сутках исчерпан.</div>
                            <div class="textUsual" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}" style="display: none;">The limit of boosts in these days is exhausted.</div>
                    </div>`,
                            imageAlt: 'error_icon',
                            showConfirmButton: true,
                            confirmButtonColor: 'rgb(163, 57, 26)',
                            confirmButtonText: confirmButtonText,
                            backdrop: 'rgba(10, 17, 19, 0.8)'
                        });
                    }
                  }
                });
            }, wait);
        }

    });


    let isModalOpen = false;
    coines = [coinElement, coinElement3]
    coines.forEach(coin => {
        coin.addEventListener('click', async (event) => {
            if (isModalOpen == false) {
                isModalOpen = true;
                const response4 = await fetch('/get_musics', {
                                method: 'POST',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify({ user_id: userId })
                            });
                const data4 = await response4.json();
                let soundenabled = data4.music
                let wait = soundenabled === 1 ? 2000 : 0
                const response = await fetch('/increment', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ user_id: userId, query: tg.initData })
                    });
                const data = await response.json();
                if (data.result == 0) {
                    wait = 50
                }
                if (getMobileOS() == "iOS") {
                    if (soundenabled == 1){
                        if (data.result != 0) {
                            setTimeout(async () => {
                                const audio = new Audio('https://storage.tower-ton.com/3e21e5c9-towerton/sunduk.mp3');
                                audio.play();
                            }, 400);
                        }
                    }
                } else {
                    if (soundenabled == 1){
                        if (data.result != 0) {
                            coinElement.play();
                            setTimeout(async () => {
                                const audio = new Audio('https://storage.tower-ton.com/3e21e5c9-towerton/sunduk.mp3');
                                audio.play();
                            }, 400);
                        }
                    }
                }
                setTimeout(async () => {
                    if (data.result == 0) {
                        let currentLang = document.documentElement.lang;
                        if (currentLang === 'ru') {
                            confirmButtonText = 'Ок';
                        } else if (currentLang === 'en') {
                            confirmButtonText = 'Ok';
                        }
                        isModalOpen = false;
                        Swal.fire({
                          customClass: {
                            title: 'titleSemiBold titleMain',
                            content: 'textUsual',
                              confirmButton: 'error-ok-button',
                          },
                          background: '#19292E',
                          html:
                              `<div class="containerPopUp">
                                <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/error.svg" class="error-icon">
                            <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Сундук</div>
                            <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Chest</div>
                            <div class="textUsual" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">У вас нет ключей</div>
                            <div class="textUsual" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You don\'t have the keys</div>
                    </div>`,
                            imageAlt: 'error-icon',
                            confirmButtonText: confirmButtonText,
                          confirmButtonColor: 'rgb(163, 57, 26)',
                          showConfirmButton: true,
                          backdrop: 'rgba(10, 17, 19, 0.8)',
                        });
                    } else if (data.result == 1) {
                        let currentLang = document.documentElement.lang;
                        let text;
                        if (currentLang === 'ru') {
                            confirmButtonText = 'Ок';
                            text = "Вы получили:<br>";
                        } else if (currentLang === 'en') {
                            confirmButtonText = 'Ok';
                            text = "You received:<br>";
                        }
                        let isTWR = 0;
                        let TWR = 0;
                        for (let key in data.reward) {
                            if (data.reward.hasOwnProperty(key)) {
                                text += `<div style="display: flex; justify-content: center;"><img src="https://storage.tower-ton.com/3e21e5c9-towerton/${key}.png" alt="{key}" style="width: 20px; height: 20px; vertical-align: middle;">  ${key}: ${data.reward[key]}</div>`;
                                if (key == "TWR"){
                                    isTWR = 1;
                                    TWR = data.reward[key];
                                }
                            }
                        }
                        Swal.fire({
                          customClass: {
                                title: 'titleSemiBold titleMain',
                                content: 'textUsual',
                                confirmButton: 'custom-ok-button',
                            },
                            background: '#19292E',
                            color: 'white',
                            html:
                                `<div class="containerPopUp">
                                <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/success.svg" class="success-icon">
                            <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Награда</div>
                            <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Reward</div>
                            ${text}
                    </div>`,
                          confirmButtonText: confirmButtonText,
                          confirmButtonColor: 'rgb(80, 200, 120)',
                          showConfirmButton: true,
                          backdrop: 'rgba(10, 17, 19, 0.8)'
                        }).then(async (result) => {
                            isModalOpen = false;
                            if (result.isConfirmed || result.dismiss) {
                                const response3 = await fetch('/updateinfo', {
                                    method: 'POST',
                                    headers: { 'Content-Type': 'application/json' },
                                    body: JSON.stringify({ user_id: userId })
                                });
                                const data3 = await response3.json();
                                balanceElement.textContent = data3.balance;
                                openchestElement.textContent = data3.points;
                                if (isTWR == 1) {
                                    const popupElement = document.createElement('div');
                                    popupElement.textContent = `+${TWR.toFixed(1)}`;
                                    popupElement.style.position = 'absolute';
                                    popupElement.style.color = 'lime';
                                    popupElement.style.fontWeight = 'bold';
                                    popupElement.style.padding = '5px';
                                    popupElement.style.zIndex = '1000';
                                    popupElement.style.transition = 'opacity 2s ease, transform 2s ease';
                                    popupElement.style.opacity = '1';
                                    popupElement.style.transform = 'translateY(0)';
                                    document.body.appendChild(popupElement);

                                    const rect = balanceElement.getBoundingClientRect();
                                    popupElement.style.top = `${rect.top + window.scrollY}px`;
                                    popupElement.style.left = `${rect.left + window.scrollX}px`;

                                    setTimeout(() => {
                                        popupElement.style.transform = 'translateY(-30px)';
                                        popupElement.style.opacity = '0';
                                    }, 0);

                                    setTimeout(() => {
                                        popupElement.remove();
                                    }, 2000);
                                }
                            }
                    });
                    } else if (data.result == 2) {
                        let currentLang = document.documentElement.lang;
                        const messages = {
                            ru: {
                                title: 'Ошибка',
                                text: 'На вашем уровне нет доступных монет'
                            },
                            en: {
                                title: 'Mistake',
                                text: 'There are no coins available at your level'
                            }

                        };
                        Swal.fire({
                            customClass: {
                                title: 'titleSemiBold titleMain',
                            },
                            background: '#1f2025',
                            color: 'white',
                            title: messages[currentLang].title,
                            text: messages[currentLang].text,
                            icon: 'error',

                        });
                        isModalOpen = false;
                    }
                    coinElement.currentTime = 0;
                    coinElement.pause();
                }, wait);
                // balanceElement.textContent = 'Balance: ' + data.balance;
                // .style.transition = 'width 0.5s ease-out';
                // energyElement.style.width = ((data.energy / data.max_energy) * 100) + '%';
                // energyElement.textContent = data.energy + 'HP';
            }

        });
    });

    gnomes = [gnomElement, gnomElement2]
    gnomes.forEach(gnom => {
        gnom.addEventListener('click', async (event) => {
            con2.remove()
            if (isModalOpen == false) {
                isModalOpen = true;
                // Отправка запроса на сервер и обновление баланса
                const response = await fetch('/getkey', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ user_id: userId })
                });
                const data = await response.json();
                const response4 = await fetch('/get_musics', {
                                method: 'POST',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify({ user_id: userId })
                            });
                const data4 = await response4.json();
                let soundenabled = data4.music
                let currentLang = document.documentElement.lang;
                if (currentLang == "ru") {
                    asound = "https://storage.tower-ton.com/3e21e5c9-towerton/Gready.mp3"
                } else {
                    asound = "https://storage.tower-ton.com/3e21e5c9-towerton/Eready.mp3"
                }

                let wait = soundenabled === 1 ? 3100 : 0
                if (data.result == 1) {
                    if (soundenabled == 1) {
                        const audio = new Audio(asound);
                        audio.play();
                    }
                    setTimeout(async () => {
                        if (currentLang === 'ru') {
                            confirmButtonText = 'Ок';
                        } else if (currentLang === 'en') {
                            confirmButtonText = 'Ok';
                        }
                        Swal.fire({
                            customClass: {
                                title: 'titleSemiBold titleMain',
                                content: 'textUsual',
                                confirmButton: 'custom-ok-button',
                            },
                            background: '#19292E',
                            html:
                                `<div class="containerPopUp">
                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/success.svg" class="success-icon">
                        <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Кузнец</div>
                        <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Blacksmith</div>
                        <div class="textUsual" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы получили ключ</div>
                        <div class="textUsual" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You have received the key</div>
                </div>`,
                            imageAlt: 'succes_icon',
                            confirmButtonText: confirmButtonText,
                            confirmButtonColor: 'rgb(80, 200, 120)',
                            showConfirmButton: true,
                            backdrop: 'rgba(10, 17, 19, 0.8)'
                        });
                        ctime = Math.floor(lefttime-fulltime);
                        isModalOpen = false;
                    }, wait);
                } else {
                    if (soundenabled == 1) {
                        const audio = new Audio('https://storage.tower-ton.com/3e21e5c9-towerton/GNready.mp3');
                        audio.play();
                    }
                    setTimeout(async () => {
                        if (currentLang === 'ru') {
                            confirmButtonText = 'Да';
                            cancelButtonText = 'Нет';
                        } else if (currentLang === 'en') {
                            confirmButtonText = 'Yes';
                            cancelButtonText = 'No';
                        }
                        Swal.fire({
                            customClass: {
                                title: 'titleSemiBold titleMain',
                                content: 'textUsual',
                                confirmButton: 'custom-ok-button',
                                cancelButton: 'button_second'
                            },
                            background: '#19292E',
                            color: 'white',
                            html:
                                `<div class="containerPopUp">
                                <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/keys5.png" class="warning-icon" alt="warning_icon">
                                <div class="textUsual" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Ключ ещё не готов.<br> Ускорить ковку на 5%?</div>
                                <div class="textUsual" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Speed up forging by 5%?</div>
    </div>`,
                            imageWidth: 81.04, // Ширина иконки
                            imageHeight: 80.94, // Высота иконки
                            showCancelButton: true,
                            showConfirmButton: true,

                            confirmButtonText: confirmButtonText,
                            cancelButtonText: cancelButtonText,
                            confirmButtonColor: 'rgb(80, 200, 120)',
                            cancelButtonColor: 'rgb(139, 86, 40)',
                            customClass: {
                                confirmButton: 'button_speed',
                                cancelButton: 'button_second',
                            },
                            backdrop: 'rgba(10, 17, 19, 0.8)'
                        }).then(async (result) => {
                          if (result.isConfirmed) {
                            window.initCdTma?.({ id: 6052529 })
                            .then(show => window.show = show)
                            .catch(e => {
                                console.log(e)
                                cdTmaError = e;
                            });
                            const response5 = await fetch('/checkad', {
                                method: 'POST',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify({ user_id: userId, cdTmaError: cdTmaError })
                            });
                            const data5 = await response5.json();
                            if (data5.status == 1) {
                                console.log("Текущая реклама" + data5.ads);
                                if (data5.ads == "Adsgram") {
                                    AdController.show()
                                         .then((result) => {
                                             if (currentLang === 'ru') {
                                                 confirmButtonText = 'Ок';
                                             } else if (currentLang === 'en') {
                                                 confirmButtonText = 'Ok';
                                             }
                                             if (data5.ad == 19) {
                                            Swal.fire({
                                                 customClass: {
                                                     confirmButton: 'custom-ok-button',
                                                 },
                                                 background: '#19292E',
                                                 html:
                                                 `<img style="height: 100%;" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/s-fonom.gif" class="gif">` +
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы получили <br> бонусный ключ!</div>`+
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You got <br> bonus key!</div>`,
                                                 imageAlt: 'succes_icon',
                                                 confirmButtonText: confirmButtonText,
                                                 confirmButtonColor: 'rgb(40, 131, 43)',
                                                 showConfirmButton: true,
                                                 backdrop: 'rgba(10, 17, 19, 0.8)'
                                            });
                                         } else if (data5.ad == 59) {
                                            Swal.fire({
                                                 customClass: {
                                                     confirmButton: 'custom-ok-button',
                                                 },
                                                 background: '#19292E',
                                                 html:
                                                 `<img style="height: 100%;" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/s-fonom.gif" class="gif">` +
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы получили <br> бонусный ключ!</div>`+
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You got <br> bonus key!</div>`,
                                                 imageAlt: 'succes_icon',
                                                 confirmButtonText: confirmButtonText,
                                                 confirmButtonColor: 'rgb(40, 131, 43)',
                                                 showConfirmButton: true,
                                                 backdrop: 'rgba(10, 17, 19, 0.8)'
                                            });
                                         } else if (data5.ad == 39) {
                                            let currentLang = document.documentElement.lang;
                                            if (currentLang === 'ru') {
                                                confirmButtonText = 'Забрать';
                                            } else if (currentLang === 'en') {
                                                confirmButtonText = 'Pick up';
                                            }
                                            Swal.fire({
                                                customClass: {
                                                    confirmButton: 'custom-ok-button',
                                                },
                                                background: '#19292E',
                                                html:
                                                    `<div class="containerPopUp">
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Награда</div>
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Reward</div>
                                                    <div class="row_union">
                                                        <div class="reward_row">
                                                            <div class="row_small pr4">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/TWR.png" class="twrSmall">
                                                            <p class="textUsual">TWR</p>
                                                            <p class="textUsual">100</p>
                                                            </div>
                                                            <div class="row_small pr4">
                                                            <img class="refSmall" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/bfcc31b7e3c9e9084ed7ee38d5ad963d.svg">
                                                            <p class="textUsual">REF</p>
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                            <div class="row_small">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/key.svg" class="keySmall">
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                       </div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы просмотрели половину доступных роликов!</div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You've watched half of the available commercials!</div>
                                                    </div>
                                         </div>`,
                                                imageAlt: 'error-icon',
                                                confirmButtonText: confirmButtonText,
                                                confirmButtonColor: 'rgb(80, 200, 120)',
                                                showConfirmButton: true,
                                                backdrop: 'rgba(10, 17, 19, 0.8)',
                                            });
                                         } else if (data5.ad == 79) {
                                            let currentLang = document.documentElement.lang;
                                            if (currentLang === 'ru') {
                                                confirmButtonText = 'Забрать';
                                            } else if (currentLang === 'en') {
                                                confirmButtonText = 'Pick up';
                                            }
                                            Swal.fire({
                                                customClass: {
                                                    confirmButton: 'custom-ok-button',
                                                },
                                                background: '#19292E',
                                                html:
                                                    `<div class="containerPopUp">
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Награда</div>
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Reward</div>
                                                    <div class="row_union">
                                                        <div class="reward_row">
                                                            <div class="row_small pr4">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/TWR.png" class="twrSmall">
                                                            <p class="textUsual">TWR</p>
                                                            <p class="textUsual">100</p>
                                                            </div>
                                                            <div class="row_small pr4">
                                                            <img class="refSmall" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/bfcc31b7e3c9e9084ed7ee38d5ad963d.svg">
                                                            <p class="textUsual">REF</p>
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                            <div class="row_small">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/key.svg" class="keySmall">
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                       </div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы просмотрели все доступные рекламные ролики!</div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You've watched all the available commercials!</div>
                                                    </div>
                                         </div>`,
                                                imageAlt: 'error-icon',
                                                confirmButtonText: confirmButtonText,
                                                confirmButtonColor: 'rgb(80, 200, 120)',
                                                showConfirmButton: true,
                                                backdrop: 'rgba(10, 17, 19, 0.8)',
                                            });

                                         } else {
                                                Swal.fire({
                                                     customClass: {
                                                         title: 'titleSemiBold titleMain',
                                                         content: 'textUsual',
                                                         confirmButton: 'custom-ok-button',
                                                     },
                                                     background: '#19292E',
                                                     html:
                                                         `<div class="containerPopUp">
                                                     <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/success.svg" class="success-icon">
                                                     <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Отлично!</div>
                                                     <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Great!</div>
                                                     <div class="textUsual" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы ускорили <br> создание ключа</div>
                                                     <div class="textUsual" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}" >You have accelerated <br>the creation of the key</div>
                                             </div>`,
                                                     imageAlt: 'succes_icon',
                                                     confirmButtonText: confirmButtonText,
                                                     confirmButtonColor: 'rgb(80, 200, 120)',
                                                     showConfirmButton: true,
                                                     backdrop: 'rgba(10, 17, 19, 0.8)'
                                                 });
                                             }
                                           ctime += Math.floor(fulltime/20);
                                           limads.textContent = data5.ad+1
                                           return fetch('/boostspeed', {
                                             method: 'POST',
                                             headers: { 'Content-Type': 'application/json' },
                                             body: JSON.stringify({ user_id: userId, ad: data5.ads })
                                           });

                                         })
                                         .then((response) => {
                                           if (!response.ok) {
                                             throw new Error(`HTTP error! status: ${response.status}`);
                                           }
                                           return response.json();
                                         })
                                         .then((data) => {
                                           // process the data if needed
                                         })
                                         .catch((error) => {
                                           console.error('Error:', error);
                                           // handle the error
                                         });
                                } else if (data5.ads == "Gigapub") {
                                    window.showGiga()
                                      .then(() => {
                                            if (data5.ad == 19) {
                                            Swal.fire({
                                                 customClass: {
                                                     confirmButton: 'custom-ok-button',
                                                 },
                                                 background: '#19292E',
                                                 html:
                                                 `<img style="height: 100%;" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/s-fonom.gif" class="gif">` +
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы получили <br> бонусный ключ!</div>`+
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You got <br> bonus key!</div>`,
                                                 imageAlt: 'succes_icon',
                                                 confirmButtonText: confirmButtonText,
                                                 confirmButtonColor: 'rgb(40, 131, 43)',
                                                 showConfirmButton: true,
                                                 backdrop: 'rgba(10, 17, 19, 0.8)'
                                            });
                                         } else if (data5.ad == 59) {
                                            Swal.fire({
                                                 customClass: {
                                                     confirmButton: 'custom-ok-button',
                                                 },
                                                 background: '#19292E',
                                                 html:
                                                 `<img style="height: 100%;" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/s-fonom.gif" class="gif">` +
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы получили <br> бонусный ключ!</div>`+
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You got <br> bonus key!</div>`,
                                                 imageAlt: 'succes_icon',
                                                 confirmButtonText: confirmButtonText,
                                                 confirmButtonColor: 'rgb(40, 131, 43)',
                                                 showConfirmButton: true,
                                                 backdrop: 'rgba(10, 17, 19, 0.8)'
                                            });
                                         } else if (data5.ad == 39) {
                                            let currentLang = document.documentElement.lang;
                                            if (currentLang === 'ru') {
                                                confirmButtonText = 'Забрать';
                                            } else if (currentLang === 'en') {
                                                confirmButtonText = 'Pick up';
                                            }
                                            Swal.fire({
                                                customClass: {
                                                    confirmButton: 'custom-ok-button',
                                                },
                                                background: '#19292E',
                                                html:
                                                    `<div class="containerPopUp">
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Награда</div>
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Reward</div>
                                                    <div class="row_union">
                                                        <div class="reward_row">
                                                            <div class="row_small pr4">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/TWR.png" class="twrSmall">
                                                            <p class="textUsual">TWR</p>
                                                            <p class="textUsual">100</p>
                                                            </div>
                                                            <div class="row_small pr4">
                                                            <img class="refSmall" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/bfcc31b7e3c9e9084ed7ee38d5ad963d.svg">
                                                            <p class="textUsual">REF</p>
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                            <div class="row_small">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/key.svg" class="keySmall">
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                       </div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы просмотрели половину доступных роликов!</div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You've watched half of the available commercials!</div>
                                                    </div>
                                         </div>`,
                                                imageAlt: 'error-icon',
                                                confirmButtonText: confirmButtonText,
                                                confirmButtonColor: 'rgb(80, 200, 120)',
                                                showConfirmButton: true,
                                                backdrop: 'rgba(10, 17, 19, 0.8)',
                                            });
                                         } else if (data5.ad == 79) {
                                            let currentLang = document.documentElement.lang;
                                            if (currentLang === 'ru') {
                                                confirmButtonText = 'Забрать';
                                            } else if (currentLang === 'en') {
                                                confirmButtonText = 'Pick up';
                                            }
                                            Swal.fire({
                                                customClass: {
                                                    confirmButton: 'custom-ok-button',
                                                },
                                                background: '#19292E',
                                                html:
                                                    `<div class="containerPopUp">
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Награда</div>
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Reward</div>
                                                    <div class="row_union">
                                                        <div class="reward_row">
                                                            <div class="row_small pr4">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/TWR.png" class="twrSmall">
                                                            <p class="textUsual">TWR</p>
                                                            <p class="textUsual">100</p>
                                                            </div>
                                                            <div class="row_small pr4">
                                                            <img class="refSmall" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/bfcc31b7e3c9e9084ed7ee38d5ad963d.svg">
                                                            <p class="textUsual">REF</p>
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                            <div class="row_small">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/key.svg" class="keySmall">
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                       </div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы просмотрели все доступные рекламные ролики!</div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You've watched all the available commercials!</div>
                                                    </div>
                                         </div>`,
                                                imageAlt: 'error-icon',
                                                confirmButtonText: confirmButtonText,
                                                confirmButtonColor: 'rgb(80, 200, 120)',
                                                showConfirmButton: true,
                                                backdrop: 'rgba(10, 17, 19, 0.8)',
                                            });

                                         } else {
                                                    return Swal.fire({
                                                         customClass: {
                                                             title: 'titleSemiBold titleMain',
                                                             content: 'textUsual',
                                                             confirmButton: 'custom-ok-button',
                                                         },
                                                         background: '#19292E',
                                                         html:
                                                             `<div class="containerPopUp">
                                                     <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/success.svg" class="success-icon">
                                                     <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Отлично!</div>
                                                     <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Great!</div>
                                                     <div class="textUsual" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы ускорили <br> создание ключа</div>
                                                     <div class="textUsual" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}" >You have accelerated <br>the creation of the key</div>
                                             </div>`,
                                                         imageAlt: 'succes_icon',
                                                         confirmButtonText: confirmButtonText,
                                                         confirmButtonColor: 'rgb(80, 200, 120)',
                                                         showConfirmButton: true,
                                                         backdrop: 'rgba(10, 17, 19, 0.8)'
                                                     });
                                                 }
                                        })
                                        .then(() => { // вынесли fetch в отдельный блок then
                                          ctime += Math.floor(fulltime/20);
                                          limads.textContent = data5.ad+1
                                          return fetch('/boostspeed', {
                                            method: 'POST',
                                            headers: { 'Content-Type': 'application/json' },
                                            body: JSON.stringify({ user_id: userId, ad: data5.ads })
                                          });
                                      }).catch(e => {
                                        Swal.fire({
                                                             customClass: {
                                                                 title: 'titleSemiBold titleMain',
                                                                 content: 'textUsual',
                                                                 confirmButton: 'custom-ok-button',
                                                             },
                                                             background: '#19292E',
                                                             html:
                                                                 `<div class="containerPopUp">
                                                     <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/success.svg" class="success-icon">
                                                     <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Отлично!</div>
                                                     <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Great!</div>
                                                     <div class="textUsual" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы ускорили <br> создание ключа</div>
                                                     <div class="textUsual" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}" >You have accelerated <br>the creation of the key</div>
                                             </div>`,
                                                             imageAlt: 'succes_icon',
                                                             confirmButtonText: confirmButtonText,
                                                             confirmButtonColor: 'rgb(80, 200, 120)',
                                                             showConfirmButton: true,
                                                             backdrop: 'rgba(10, 17, 19, 0.8)'
                                                         });
                                      })
                                } else if (data5.ads == "Onlick") {
                                    let confirmButtonText;
                                    if (currentLang === 'ru') {
                                        confirmButtonText = 'Ок';
                                    } else if (currentLang === 'en') {
                                        confirmButtonText = 'Ok';
                                    }

                                    try {
                                        window.show?.()
                                            .then(() => {
                                                if (data5.ad == 19) {
                                            Swal.fire({
                                                 customClass: {
                                                     confirmButton: 'custom-ok-button',
                                                 },
                                                 background: '#19292E',
                                                 html:
                                                 `<img style="height: 100%;" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/s-fonom.gif" class="gif">` +
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы получили <br> бонусный ключ!</div>`+
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You got <br> bonus key!</div>`,
                                                 imageAlt: 'succes_icon',
                                                 confirmButtonText: confirmButtonText,
                                                 confirmButtonColor: 'rgb(40, 131, 43)',
                                                 showConfirmButton: true,
                                                 backdrop: 'rgba(10, 17, 19, 0.8)'
                                            });
                                         } else if (data5.ad == 59) {
                                            Swal.fire({
                                                 customClass: {
                                                     confirmButton: 'custom-ok-button',
                                                 },
                                                 background: '#19292E',
                                                 html:
                                                 `<img style="height: 100%;" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/s-fonom.gif" class="gif">` +
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы получили <br> бонусный ключ!</div>`+
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You got <br> bonus key!</div>`,
                                                 imageAlt: 'succes_icon',
                                                 confirmButtonText: confirmButtonText,
                                                 confirmButtonColor: 'rgb(40, 131, 43)',
                                                 showConfirmButton: true,
                                                 backdrop: 'rgba(10, 17, 19, 0.8)'
                                            });
                                         } else if (data5.ad == 39) {
                                            let currentLang = document.documentElement.lang;
                                            if (currentLang === 'ru') {
                                                confirmButtonText = 'Забрать';
                                            } else if (currentLang === 'en') {
                                                confirmButtonText = 'Pick up';
                                            }
                                            Swal.fire({
                                                customClass: {
                                                    confirmButton: 'custom-ok-button',
                                                },
                                                background: '#19292E',
                                                html:
                                                    `<div class="containerPopUp">
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Награда</div>
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Reward</div>
                                                    <div class="row_union">
                                                        <div class="reward_row">
                                                            <div class="row_small pr4">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/TWR.png" class="twrSmall">
                                                            <p class="textUsual">TWR</p>
                                                            <p class="textUsual">100</p>
                                                            </div>
                                                            <div class="row_small pr4">
                                                            <img class="refSmall" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/bfcc31b7e3c9e9084ed7ee38d5ad963d.svg">
                                                            <p class="textUsual">REF</p>
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                            <div class="row_small">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/key.svg" class="keySmall">
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                       </div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы просмотрели половину доступных роликов!</div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You've watched half of the available commercials!</div>
                                                    </div>
                                         </div>`,
                                                imageAlt: 'error-icon',
                                                confirmButtonText: confirmButtonText,
                                                confirmButtonColor: 'rgb(80, 200, 120)',
                                                showConfirmButton: true,
                                                backdrop: 'rgba(10, 17, 19, 0.8)',
                                            });
                                         } else if (data5.ad == 79) {
                                            let currentLang = document.documentElement.lang;
                                            if (currentLang === 'ru') {
                                                confirmButtonText = 'Забрать';
                                            } else if (currentLang === 'en') {
                                                confirmButtonText = 'Pick up';
                                            }
                                            Swal.fire({
                                                customClass: {
                                                    confirmButton: 'custom-ok-button',
                                                },
                                                background: '#19292E',
                                                html:
                                                    `<div class="containerPopUp">
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Награда</div>
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Reward</div>
                                                    <div class="row_union">
                                                        <div class="reward_row">
                                                            <div class="row_small pr4">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/TWR.png" class="twrSmall">
                                                            <p class="textUsual">TWR</p>
                                                            <p class="textUsual">100</p>
                                                            </div>
                                                            <div class="row_small pr4">
                                                            <img class="refSmall" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/bfcc31b7e3c9e9084ed7ee38d5ad963d.svg">
                                                            <p class="textUsual">REF</p>
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                            <div class="row_small">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/key.svg" class="keySmall">
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                       </div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы просмотрели все доступные рекламные ролики!</div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You've watched all the available commercials!</div>
                                                    </div>
                                         </div>`,
                                                imageAlt: 'error-icon',
                                                confirmButtonText: confirmButtonText,
                                                confirmButtonColor: 'rgb(80, 200, 120)',
                                                showConfirmButton: true,
                                                backdrop: 'rgba(10, 17, 19, 0.8)',
                                            });

                                         } else {
                                                    return Swal.fire({
                                                         customClass: {
                                                             title: 'titleSemiBold titleMain',
                                                             content: 'textUsual',
                                                             confirmButton: 'custom-ok-button',
                                                         },
                                                         background: '#19292E',
                                                         html:
                                                             `<div class="containerPopUp">
                                                     <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/success.svg" class="success-icon">
                                                     <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Отлично!</div>
                                                     <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Great!</div>
                                                     <div class="textUsual" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы ускорили <br> создание ключа</div>
                                                     <div class="textUsual" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}" >You have accelerated <br>the creation of the key</div>
                                             </div>`,
                                                         imageAlt: 'succes_icon',
                                                         confirmButtonText: confirmButtonText,
                                                         confirmButtonColor: 'rgb(80, 200, 120)',
                                                         showConfirmButton: true,
                                                         backdrop: 'rgba(10, 17, 19, 0.8)'
                                                     });
                                                 }
                                            })
                                            .then(() => {
                                                // Эта часть выполнится после закрытия Swal.fire
                                                ctime += Math.floor(fulltime / 20);
                                                limads.textContent = data5.ad + 1;

                                                return fetch('/boostspeed', {
                                                    method: 'POST',
                                                    headers: { 'Content-Type': 'application/json' },
                                                    body: JSON.stringify({ user_id: userId, ad: data5.ads })
                                                });
                                            })
                                            .catch(e => {
                                                console.log(e);
                                                console.log("ошибка");
                                                return Swal.fire({
                                                    customClass: {
                                                        title: 'titleSemiBold titleMain',
                                                        content: 'textUsual',
                                                        confirmButton: 'error-ok-button',
                                                    },
                                                    background: '#19292E',
                                                    html:
                                                        `<div class="containerPopUp">
                                                 <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/error.svg" class="error-icon">
                                             <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Реклама</div>
                                             <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Advertisement</div>
                                             <div class="textUsual" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Для вас сейчас нет рекламы от этого партнёра, попробуйте ещё раз</div>
                                             <div class="textUsual" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">There is no advertisement for you from that partner</div>
                                   </div>`,
                                                    imageAlt: 'error_icon',
                                                    showConfirmButton: true,
                                                    confirmButtonColor: 'rgb(163, 57, 26)',
                                                    confirmButtonText: confirmButtonText,
                                                    backdrop: 'rgba(10, 17, 19, 0.8)'
                                                });
                                            });
                                    } catch (error) {
                                        console.log(error)
                                    }
                                } else if (data5.ads == "Adextra") {
                                    let confirmButtonText; // Объявим переменную вне then
                                    if (currentLang === 'ru') {
                                        confirmButtonText = 'Ок';
                                    } else if (currentLang === 'en') {
                                        confirmButtonText = 'Ok';
                                    }
                                    id = '8b3998992794ae102e307a783a445dac32e33a7e';
                                    p = function(){}
                                        window.setTimeout('p_adextra(p,p)',2000)
                                    var onError = () => {
                                        window.showGiga()
                                          .then(() => {
                                                if (data5.ad == 19) {
                                            Swal.fire({
                                                 customClass: {
                                                     confirmButton: 'custom-ok-button',
                                                 },
                                                 background: '#19292E',
                                                 html:
                                                 `<img style="height: 100%;" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/s-fonom.gif" class="gif">` +
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы получили <br> бонусный ключ!</div>`+
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You got <br> bonus key!</div>`,
                                                 imageAlt: 'succes_icon',
                                                 confirmButtonText: confirmButtonText,
                                                 confirmButtonColor: 'rgb(40, 131, 43)',
                                                 showConfirmButton: true,
                                                 backdrop: 'rgba(10, 17, 19, 0.8)'
                                            });
                                         } else if (data5.ad == 59) {
                                            Swal.fire({
                                                 customClass: {
                                                     confirmButton: 'custom-ok-button',
                                                 },
                                                 background: '#19292E',
                                                 html:
                                                 `<img style="height: 100%;" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/s-fonom.gif" class="gif">` +
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы получили <br> бонусный ключ!</div>`+
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You got <br> bonus key!</div>`,
                                                 imageAlt: 'succes_icon',
                                                 confirmButtonText: confirmButtonText,
                                                 confirmButtonColor: 'rgb(40, 131, 43)',
                                                 showConfirmButton: true,
                                                 backdrop: 'rgba(10, 17, 19, 0.8)'
                                            });
                                         } else if (data5.ad == 39) {
                                            let currentLang = document.documentElement.lang;
                                            if (currentLang === 'ru') {
                                                confirmButtonText = 'Забрать';
                                            } else if (currentLang === 'en') {
                                                confirmButtonText = 'Pick up';
                                            }
                                            Swal.fire({
                                                customClass: {
                                                    confirmButton: 'custom-ok-button',
                                                },
                                                background: '#19292E',
                                                html:
                                                    `<div class="containerPopUp">
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Награда</div>
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Reward</div>
                                                    <div class="row_union">
                                                        <div class="reward_row">
                                                            <div class="row_small pr4">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/TWR.png" class="twrSmall">
                                                            <p class="textUsual">TWR</p>
                                                            <p class="textUsual">100</p>
                                                            </div>
                                                            <div class="row_small pr4">
                                                            <img class="refSmall" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/bfcc31b7e3c9e9084ed7ee38d5ad963d.svg">
                                                            <p class="textUsual">REF</p>
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                            <div class="row_small">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/key.svg" class="keySmall">
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                       </div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы просмотрели половину доступных роликов!</div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You've watched half of the available commercials!</div>
                                                    </div>
                                         </div>`,
                                                imageAlt: 'error-icon',
                                                confirmButtonText: confirmButtonText,
                                                confirmButtonColor: 'rgb(80, 200, 120)',
                                                showConfirmButton: true,
                                                backdrop: 'rgba(10, 17, 19, 0.8)',
                                            });
                                         } else if (data5.ad == 79) {
                                            let currentLang = document.documentElement.lang;
                                            if (currentLang === 'ru') {
                                                confirmButtonText = 'Забрать';
                                            } else if (currentLang === 'en') {
                                                confirmButtonText = 'Pick up';
                                            }
                                            Swal.fire({
                                                customClass: {
                                                    confirmButton: 'custom-ok-button',
                                                },
                                                background: '#19292E',
                                                html:
                                                    `<div class="containerPopUp">
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Награда</div>
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Reward</div>
                                                    <div class="row_union">
                                                        <div class="reward_row">
                                                            <div class="row_small pr4">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/TWR.png" class="twrSmall">
                                                            <p class="textUsual">TWR</p>
                                                            <p class="textUsual">100</p>
                                                            </div>
                                                            <div class="row_small pr4">
                                                            <img class="refSmall" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/bfcc31b7e3c9e9084ed7ee38d5ad963d.svg">
                                                            <p class="textUsual">REF</p>
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                            <div class="row_small">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/key.svg" class="keySmall">
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                       </div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы просмотрели все доступные рекламные ролики!</div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You've watched all the available commercials!</div>
                                                    </div>
                                         </div>`,
                                                imageAlt: 'error-icon',
                                                confirmButtonText: confirmButtonText,
                                                confirmButtonColor: 'rgb(80, 200, 120)',
                                                showConfirmButton: true,
                                                backdrop: 'rgba(10, 17, 19, 0.8)',
                                            });

                                         } else {
                                                        return Swal.fire({
                                                             customClass: {
                                                                 title: 'titleSemiBold titleMain',
                                                                 content: 'textUsual',
                                                                 confirmButton: 'custom-ok-button',
                                                             },
                                                             background: '#19292E',
                                                             html:
                                                                 `<div class="containerPopUp">
                                                         <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/success.svg" class="success-icon">
                                                         <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Отлично!</div>
                                                         <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Great!</div>
                                                         <div class="textUsual" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы ускорили <br> создание ключа</div>
                                                         <div class="textUsual" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}" >You have accelerated <br>the creation of the key</div>
                                                 </div>`,
                                                             imageAlt: 'succes_icon',
                                                             confirmButtonText: confirmButtonText,
                                                             confirmButtonColor: 'rgb(80, 200, 120)',
                                                             showConfirmButton: true,
                                                             backdrop: 'rgba(10, 17, 19, 0.8)'
                                                         });
                                                     }
                                            })
                                            .then(() => { // вынесли fetch в отдельный блок then
                                              ctime += Math.floor(fulltime/20);
                                              limads.textContent = data5.ad+1
                                              return fetch('/boostspeed', {
                                                method: 'POST',
                                                headers: { 'Content-Type': 'application/json' },
                                                body: JSON.stringify({ user_id: userId, ad: "Gigapub" })
                                              });
                                          }).catch(e => {
                                            Swal.fire({
                                                                 customClass: {
                                                                     title: 'titleSemiBold titleMain',
                                                                     content: 'textUsual',
                                                                     confirmButton: 'custom-ok-button',
                                                                 },
                                                                 background: '#19292E',
                                                                 html:
                                                                     `<div class="containerPopUp">
                                                         <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/success.svg" class="success-icon">
                                                         <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Отлично!</div>
                                                         <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Great!</div>
                                                         <div class="textUsual" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы ускорили <br> создание ключа</div>
                                                         <div class="textUsual" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}" >You have accelerated <br>the creation of the key</div>
                                                 </div>`,
                                                                 imageAlt: 'succes_icon',
                                                                 confirmButtonText: confirmButtonText,
                                                                 confirmButtonColor: 'rgb(80, 200, 120)',
                                                                 showConfirmButton: true,
                                                                 backdrop: 'rgba(10, 17, 19, 0.8)'
                                                             });
                                          })
                                    }
                                    var onSuccess = () => {
                                            if (data5.ad == 19) {
                                            Swal.fire({
                                                 customClass: {
                                                     confirmButton: 'custom-ok-button',
                                                 },
                                                 background: '#19292E',
                                                 html:
                                                 `<img style="height: 100%;" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/s-fonom.gif" class="gif">` +
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы получили <br> бонусный ключ!</div>`+
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You got <br> bonus key!</div>`,
                                                 imageAlt: 'succes_icon',
                                                 confirmButtonText: confirmButtonText,
                                                 confirmButtonColor: 'rgb(40, 131, 43)',
                                                 showConfirmButton: true,
                                                 backdrop: 'rgba(10, 17, 19, 0.8)'
                                            });
                                         } else if (data5.ad == 59) {
                                            Swal.fire({
                                                 customClass: {
                                                     confirmButton: 'custom-ok-button',
                                                 },
                                                 background: '#19292E',
                                                 html:
                                                 `<img style="height: 100%;" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/s-fonom.gif" class="gif">` +
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы получили <br> бонусный ключ!</div>`+
                                                     `<div class="titleSemiBold titleMain" style="margin-top: -53.02px; ${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You got <br> bonus key!</div>`,
                                                 imageAlt: 'succes_icon',
                                                 confirmButtonText: confirmButtonText,
                                                 confirmButtonColor: 'rgb(40, 131, 43)',
                                                 showConfirmButton: true,
                                                 backdrop: 'rgba(10, 17, 19, 0.8)'
                                            });
                                         } else if (data5.ad == 39) {
                                            let currentLang = document.documentElement.lang;
                                            if (currentLang === 'ru') {
                                                confirmButtonText = 'Забрать';
                                            } else if (currentLang === 'en') {
                                                confirmButtonText = 'Pick up';
                                            }
                                            Swal.fire({
                                                customClass: {
                                                    confirmButton: 'custom-ok-button',
                                                },
                                                background: '#19292E',
                                                html:
                                                    `<div class="containerPopUp">
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Награда</div>
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Reward</div>
                                                    <div class="row_union">
                                                        <div class="reward_row">
                                                            <div class="row_small pr4">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/TWR.png" class="twrSmall">
                                                            <p class="textUsual">TWR</p>
                                                            <p class="textUsual">100</p>
                                                            </div>
                                                            <div class="row_small pr4">
                                                            <img class="refSmall" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/bfcc31b7e3c9e9084ed7ee38d5ad963d.svg">
                                                            <p class="textUsual">REF</p>
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                            <div class="row_small">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/key.svg" class="keySmall">
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                       </div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы просмотрели половину доступных роликов!</div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You've watched half of the available commercials!</div>
                                                    </div>
                                         </div>`,
                                                imageAlt: 'error-icon',
                                                confirmButtonText: confirmButtonText,
                                                confirmButtonColor: 'rgb(80, 200, 120)',
                                                showConfirmButton: true,
                                                backdrop: 'rgba(10, 17, 19, 0.8)',
                                            });
                                         } else if (data5.ad == 79) {
                                            let currentLang = document.documentElement.lang;
                                            if (currentLang === 'ru') {
                                                confirmButtonText = 'Забрать';
                                            } else if (currentLang === 'en') {
                                                confirmButtonText = 'Pick up';
                                            }
                                            Swal.fire({
                                                customClass: {
                                                    confirmButton: 'custom-ok-button',
                                                },
                                                background: '#19292E',
                                                html:
                                                    `<div class="containerPopUp">
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Награда</div>
                                                    <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Reward</div>
                                                    <div class="row_union">
                                                        <div class="reward_row">
                                                            <div class="row_small pr4">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/TWR.png" class="twrSmall">
                                                            <p class="textUsual">TWR</p>
                                                            <p class="textUsual">100</p>
                                                            </div>
                                                            <div class="row_small pr4">
                                                            <img class="refSmall" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/bfcc31b7e3c9e9084ed7ee38d5ad963d.svg">
                                                            <p class="textUsual">REF</p>
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                            <div class="row_small">
                                                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/key.svg" class="keySmall">
                                                            <p class="textUsual">1</p>
                                                            </div>
                                                       </div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы просмотрели все доступные рекламные ролики!</div>
                                                       <div class="textUsual pale_blue" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You've watched all the available commercials!</div>
                                                    </div>
                                         </div>`,
                                                imageAlt: 'error-icon',
                                                confirmButtonText: confirmButtonText,
                                                confirmButtonColor: 'rgb(80, 200, 120)',
                                                showConfirmButton: true,
                                                backdrop: 'rgba(10, 17, 19, 0.8)',
                                            });

                                         } else {
                                                    Swal.fire({
                                                         customClass: {
                                                             title: 'titleSemiBold titleMain',
                                                             content: 'textUsual',
                                                             confirmButton: 'custom-ok-button',
                                                         },
                                                         background: '#19292E',
                                                         html:
                                                             `<div class="containerPopUp">
                                                     <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/success.svg" class="success-icon">
                                                     <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Отлично!</div>
                                                     <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Great!</div>
                                                     <div class="textUsual" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы ускорили <br> создание ключа</div>
                                                     <div class="textUsual" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}" >You have accelerated <br>the creation of the key</div>
                                             </div>`,
                                                         imageAlt: 'succes_icon',
                                                         confirmButtonText: confirmButtonText,
                                                         confirmButtonColor: 'rgb(80, 200, 120)',
                                                         showConfirmButton: true,
                                                         backdrop: 'rgba(10, 17, 19, 0.8)'
                                                     });
                                                 }
                                        ctime += Math.floor(fulltime/20);
                                          limads.textContent = data5.ad+1
                                          return fetch('/boostspeed', {
                                            method: 'POST',
                                            headers: { 'Content-Type': 'application/json' },
                                            body: JSON.stringify({ user_id: userId, ad: data5.ads })
                                          });
                                    }
                                    p_adextra(onSuccess, onError);
                                }
                            } else if (data5.status == 2) {
                                if (currentLang === 'ru') {
                                    confirmButtonText = 'Ок';
                                } else if (currentLang === 'en') {
                                    confirmButtonText = 'Ok';
                                }
                                Swal.fire({
                                    customClass: {
                                        title: 'titleSemiBold titleMain',
                                        content: 'textUsual',
                                        confirmButton: 'error-ok-button',
                                    },
                                    background: '#19292E',
                                    html:
                                        `<div class="containerPopUp">
                                        <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/error.svg" class="error-icon">
                                    <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Реклама</div>
                                    <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Advertisement</div>
                                    <div class="textUsual" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Ещё не прошло 2 секунды.</div>
                                    <div class="textUsual" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">It hasn\'t been 2 seconds yet.</div>
                            </div>`,
                                    imageAlt: 'error_icon',
                                    showConfirmButton: true,
                                    confirmButtonColor: 'rgb(163, 57, 26)',
                                    confirmButtonText: confirmButtonText,
                                    backdrop: 'rgba(10, 17, 19, 0.8)'
                                });
                            } else {
                                if (currentLang === 'ru') {
                                    confirmButtonText = 'Ок';
                                } else if (currentLang === 'en') {
                                    confirmButtonText = 'Ok';
                                }
                                Swal.fire({
                                    customClass: {
                                        title: 'titleSemiBold titleMain',
                                        content: 'textUsual',
                                        confirmButton: 'error-ok-button',
                                    },
                                    background: '#19292E',
                                    html:
                                        `<div class="containerPopUp">
                                    <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/error.svg" class="error-icon">
                                <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Реклама</div>
                                <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Advertisement</div>
                                <div class="textUsual" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Лимит просмотров в этих сутках исчерпан.</div>
                                <div class="textUsual" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}" style="display: none;">The limit of views in these days is exhausted.</div>
                        </div>`,
                                    imageAlt: 'error_icon',
                                    showConfirmButton: true,
                                    confirmButtonColor: 'rgb(163, 57, 26)',
                                    confirmButtonText: confirmButtonText,
                                    backdrop: 'rgba(10, 17, 19, 0.8)'
                                });
                            }
                          }
                        });
                        isModalOpen = false;
                    }, wait);
                }
            }
        });
    });

    sisi.addEventListener('click', async (event) => {
        const response = await fetch('/gift', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({user_id: userId})
        });
        const data = await response.json();
        if (data.status == 0) {
            let currentLang = document.documentElement.lang;
                    if (currentLang === 'ru') {
                        confirmButtonText = 'Забрать';
                    } else if (currentLang === 'en') {
                        confirmButtonText = 'Pick up';
                    }
            Swal.fire({
                                    customClass: {
                                        title: 'titleSemiBold titleMain',
                                        content: 'textUsual',
                                        confirmButton: 'error-ok-button',
                                    },
                                    background: '#19292E',
                                    html:
                                        `<div class="containerPopUp">
                                    <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/error.svg" class="error-icon">
                                <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Подарок</div>
                                <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Gift</div>
                                <div class="textUsual" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы уже получали подарок!</div>
                                <div class="textUsual" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}" style="display: none;">You already opened this gift!</div>
                        </div>`,
                                    imageAlt: 'error_icon',
                                    showConfirmButton: true,
                                    confirmButtonColor: 'rgb(163, 57, 26)',
                                    confirmButtonText: confirmButtonText,
                                    backdrop: 'rgba(10, 17, 19, 0.8)'
            });
            sisi.remove()
        } else if (data.status == 3) {
            let currentLang = document.documentElement.lang;
                    if (currentLang === 'ru') {
                        confirmButtonText = 'Забрать';
                    } else if (currentLang === 'en') {
                        confirmButtonText = 'Pick up';
                    }
            Swal.fire({
                        customClass: {
                            confirmButton: 'custom-ok-button',
                        },
                        background: '#19292E',
                        html:
                            `<div class="containerPopUp">
                            <img class="big_icon img_icon" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/REF2.svg">
                            <div class="titleSemiBold titleMain white" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы получили <br> ${data.reward} TWR</div>
                            <div class="titleSemiBold titleMain white" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You have received <br> ${data.reward} TWR</div>
                            <img class="rays3" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/rays1.svg">
                </div>`,
                        imageAlt: 'succes_icon',
                        confirmButtonText: confirmButtonText,
                        confirmButtonColor: 'rgb(80, 200, 120)',
                        showConfirmButton: true,
                        backdrop: 'rgba(10, 17, 19, 0.8)'
                    });
            sisi.remove()
        } else if (data.status == 2) {
            let currentLang = document.documentElement.lang;
                    if (currentLang === 'ru') {
                        confirmButtonText = 'Забрать';
                    } else if (currentLang === 'en') {
                        confirmButtonText = 'Pick up';
                    }
            Swal.fire({
                        customClass: {
                            confirmButton: 'custom-ok-button',
                        },
                        background: '#19292E',
                        html:
                            `<div class="containerPopUp">
                            <img class="big_icon img_icon" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/bfcc31b7e3c9e9084ed7ee38d5ad963d.svg">
                            <div class="titleSemiBold titleMain white" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы получили <br> ${data.reward} REF</div>
                            <div class="titleSemiBold titleMain white" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You have received <br> ${data.reward} REF</div>
                            <img class="rays3" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/rays1.svg">
                </div>`,
                        imageAlt: 'succes_icon',
                        confirmButtonText: confirmButtonText,
                        confirmButtonColor: 'rgb(80, 200, 120)',
                        showConfirmButton: true,
                        backdrop: 'rgba(10, 17, 19, 0.8)'
            });
            sisi.remove()
        } else if (data.status == 1) {
                    let currentLang = document.documentElement.lang;
                    if (currentLang === 'ru') {
                        confirmButtonText = 'Забрать';
                    } else if (currentLang === 'en') {
                        confirmButtonText = 'Pick up';
                    }
                    Swal.fire({
                        customClass: {
                            confirmButton: 'custom-ok-button',
                        },
                        background: '#19292E',
                        html:
                            `<div class="containerPopUp">
                            <img class="key6 img_icon" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/key6.svg">
                            <div class="titleSemiBold titleMain white" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы получили <br> ${data.reward} ключей</div>
                            <div class="titleSemiBold titleMain white" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You have received <br> ${data.reward} keys</div>
                            <img class="rays2" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/rays1.svg">
                </div>`,
                        imageAlt: 'succes_icon',
                        confirmButtonText: confirmButtonText,
                        confirmButtonColor: 'rgb(80, 200, 120)',
                        showConfirmButton: true,
                        backdrop: 'rgba(10, 17, 19, 0.8)'
                    });
            sisi.remove()
        }

    });

    document.getElementById('store').addEventListener('click', async (event) => {
        if (train <= 2) {
            const response = await fetch('/boosttrain', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ user_id: userId})
            });
            const data = await response.json();
            setTimeout(async () => {
                window.location.href = `/store?user_id=${userId.slice(6, -5)}`;
            }, 200);
        } else {
            window.location.href = `/store?user_id=${userId.slice(6, -5)}`;
        }
    });
    document.getElementById('loto').addEventListener('click', async (event) => {
       window.location.href = `/loto?user_id=${userId.slice(6, -5)}`;
    });
    document.querySelector('.flex_row4').addEventListener('click', () => {
        window.location.href = `/twr?user_id=${userId.slice(6, -5)}`;
    });
    document.getElementById('tasks').addEventListener('click', async (event) => {
        if (train <= 2) {
            const response = await fetch('/boosttrain', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ user_id: userId})
            });
            const data = await response.json();
            window.location.href = `/tasks?user_id=${userId.slice(6, -5)}`;
        } else {
            window.location.href = `/tasks?user_id=${userId.slice(6, -5)}`;
        }

    });
    document.querySelector('.content_box9').addEventListener('click', () => {
        window.location.href = `/wallet?user_id=${userId.slice(6, -5)}`;
    });
    document.getElementById('burse').addEventListener('click', () => {
        window.location.href = `/burse?user_id=${userId.slice(6, -5)}`;
    });
    document.getElementById('friends').addEventListener('click', async (event) => {
        const response = await fetch('/boosttrain', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ user_id: userId})
        });
        const data = await response.json();
        window.location.href = `/friends?user_id=${userId.slice(6, -5)}`;
    });
    document.querySelector('.content_box10').addEventListener('click', () => {
        window.location.href = `/lvlup?user_id=${userId.slice(6, -5)}`;
    });
    document.querySelector('.laby').addEventListener('click', () => {
        window.location.href = `/lab?user_id=${userId.slice(6, -5)}`;
     });
    document.querySelector('.faq').addEventListener('click', () => {
        window.location.href = `/faq?user_id=${userId.slice(6, -5)}`;
    });
    document.querySelector('.content_box11').addEventListener('click', () => {
        window.location.href = `/rate?user_id=${userId.slice(6, -5)}`;
    });



    function createModal(coinsData, c_wallet) {
        // Создаем элементы модального окна
        var modal = document.createElement('div');
        var modalContent = document.createElement('div');
        var closeButton = document.createElement('span');
        var connectWalletButton = document.createElement('button'); // Кнопка подключения кошелька
        var walletInput = document.createElement('input');
        walletInput.setAttribute('type', 'text');
        walletInput.setAttribute('id', 'walletAddress');
        walletInput.setAttribute('placeholder', 'Wallet address');
        walletInput.style.marginTop = '20px';
        // Устанавливаем стили и атрибуты для модального окна
        modal.setAttribute('id', 'myModal');
        modal.style.display = 'block';
        modal.style.position = 'fixed';
        modal.style.zIndex = '1';
        modal.style.left = '0';
        modal.style.top = '0';
        modal.style.width = '100%';
        modal.style.height = '100%';
        modal.style.overflow = 'auto';
        modal.style.backgroundColor = 'rgba(0,0,0,0.4)';

        modalContent.style.backgroundColor = '#fefefe';
        modalContent.style.margin = '15% auto';
        modalContent.style.padding = '20px';
        modalContent.style.border = '1px solid #888';
        modalContent.style.width = '80%';
        modalContent.style.borderRadius = '10px'; // Добавляем закругленные края

        closeButton.textContent = '×';
        closeButton.style.color = '#aaa';
        closeButton.style.float = 'right';
        closeButton.style.fontSize = '28px';
        closeButton.style.fontWeight = 'bold';
        closeButton.style.cursor = 'pointer';
        if ("{{ wallet }}" !== "") {
            // Создаем элемент для отображения текущего кошелька
            var currentWalletDiv = document.createElement('div');
            currentWalletDiv.textContent = 'Current wallet: ' + "{{ wallet }}";
            currentWalletDiv.style.marginBottom = '20px';
            currentWalletDiv.style.fontFamily = 'monospace';

            modalContent.appendChild(currentWalletDiv, modalContent.firstChild);
        }
        function onMouseOver() {
            this.style.color = '#8B0000';
        }

        function onMouseOut() {
            this.style.color = '#aaa';
        }

        closeButton.addEventListener('mouseover', onMouseOver);
        closeButton.addEventListener('mouseout', onMouseOut);

        closeButton.onclick = function() {
            modal.style.display = 'none';
        };

        // Добавляем кнопку закрытия в модальное окно
        modalContent.appendChild(closeButton);
        // Добавляем информацию о монетах в модальное окно
        if (Array.isArray(coinsData)) {
            coinsData.forEach(function(coin) {
                var div = document.createElement('div');
                div.style.display = 'flex';
                div.style.alignItems = 'center';
                div.style.justifyContent = 'left';
                div.style.backgroundColor = '#f0f0f0'; // Закругленный фон для каждого значения
                div.style.borderRadius = '5px'; // Закругленные края для фона
                div.style.marginBottom = '10px'; // Отступ снизу
                div.style.padding = '5px'; // Внутренний отступ

                var img = document.createElement('img');
                img.src = 'https://storage.tower-ton.com/3e21e5c9-towerton/' + coin.key + '.webp';
                img.alt = coin.key;
                img.style.width = '30px';
                img.style.height = '30px';
                img.style.marginRight = '10px';
                let coinvalue = coin.value.toFixed(2);
                var span = document.createElement('span');
                span.textContent = ` ${coin.key}: ${coinvalue}`;

                div.appendChild(img);
                div.appendChild(span);
                modalContent.appendChild(div);
            });
        } else {
            var p = document.createElement('p');
            p.textContent = 'You don`t have coins';
            p.style.fontFamily = 'monospace';
            modalContent.appendChild(p);
        }


        // Создаем и стилизуем кнопку "Подключить кошелёк"
        connectWalletButton.textContent = 'Bind Wallet';
        connectWalletButton.style.padding = '10px 20px';
        connectWalletButton.style.marginTop = '20px';
        connectWalletButton.style.fontSize = '16px';
        connectWalletButton.style.borderRadius = '5px';
        connectWalletButton.style.cursor = 'pointer';
        connectWalletButton.style.border = 'none';
        connectWalletButton.style.backgroundColor = '#4CAF50';
        connectWalletButton.style.color = 'white';

        // Добавляем функционал для кнопки "Подключить кошелёк"
        connectWalletButton.onclick = function() {
            // Получаем адрес кошелька из поля ввода
            var walletAddress = document.getElementById('walletAddress').value;
            if (walletAddress) {
                // Отправляем данные на сервер
                var xhr = new XMLHttpRequest();
                xhr.open('GET', '/connect-wallet?user_id=' + userId + '&wallet=' + walletAddress, true);
                xhr.setRequestHeader('Content-Type', 'application/json');
                xhr.onreadystatechange = function() {
                    if (xhr.readyState === 4 && xhr.status === 200) {
                        // Обработка успешного ответа
                        main()
                        modal.style.display = 'none';
                    } else if (xhr.readyState === 4) {
                        // Обработка ошибки
                        console.error('Ошибка при подключении кошелька:', xhr.responseText);
                    }
                };
                xhr.send(JSON.stringify({ walletAddress: walletAddress }));
            } else {
                console.log('Write your wallet address');
            }
        };
        // Добавляем кнопку "Подключить кошелёк" в модальное окно
        modalContent.appendChild(walletInput, connectWalletButton);
        modalContent.appendChild(connectWalletButton);

        // Добавляем модальное окно на страницу
        modal.appendChild(modalContent);
        document.body.appendChild(modal);
    }

</script>

<script>
    var audio = document.getElementById('audio');
    soundImage.addEventListener('click', async () => {
        if (soundImage.src.includes('sound.svg')) {
            const response2 = await fetch('/change_music', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ user_id: userId })
            });

            const data2 = await response2.json();
            soundImage.src = 'https://storage.tower-ton.com/3e21e5c9-towerton/assets/sound_off.svg';
            audio.pause();
        } else {
            soundImage.src = 'https://storage.tower-ton.com/3e21e5c9-towerton/assets/sound.svg';

            const response2 = await fetch('/change_music', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ user_id: userId })
            });

            const data2 = await response2.json();

            try {
                await audio.play();
            } catch (error) {
                console.error('Playback failed:', error);
                // Здесь можно показать сообщение пользователю или предпринять другие действия
            }
        }
    });
</script>
<script>
    document.querySelector('.englishLanguageText').addEventListener('click', async function() {
        const enTexts = document.querySelectorAll('[data-lang="en"]');
        const ruTexts = document.querySelectorAll('[data-lang="ru"]');
        const currentLang = 'en';
        document.documentElement.lang = 'en'
        const response = await fetch('/swaplan', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ user_id: userId, lang: document.documentElement.lang  })
        });
        const data = await response.json();
        const elements = document.querySelectorAll('[data-lang-en]');
        elements.forEach(element => {
            element.textContent = element.getAttribute(`data-lang-${currentLang}`);
        });
        enTexts.forEach(text => {
            text.style.display = text.style.display === 'none' ? 'block' : 'none';
        });

        ruTexts.forEach(text => {
            text.style.display = text.style.display === 'none' ? 'block' : 'none';
        });
    });
    document.querySelector('.russianLanguageText').addEventListener('click', async function() {
        const enTexts = document.querySelectorAll('[data-lang="en"]');
        const ruTexts = document.querySelectorAll('[data-lang="ru"]');
        const currentLang = 'ru';
        document.documentElement.lang = 'ru'
        const response = await fetch('/swaplan', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ user_id: userId, lang: document.documentElement.lang  })
        });
        const data = await response.json();
        const elements = document.querySelectorAll('[data-lang-en]');
        elements.forEach(element => {
            element.textContent = element.getAttribute(`data-lang-${currentLang}`);
        });
        enTexts.forEach(text => {
            text.style.display = text.style.display === 'none' ? 'block' : 'none';
        });

        ruTexts.forEach(text => {
            text.style.display = text.style.display === 'none' ? 'block' : 'none';
        });
    });

</script>

<script>
    const finger = document.getElementById('finger');
    const gnom = document.getElementById('gnom');
    const coin = document.getElementById('coin'); // Элемент монеты
    const text = document.getElementById('text');
    const text1 = document.getElementById('text1');
    const store = document.getElementById('store');
    const tasks = document.getElementById('tasks');
    const friends = document.getElementById('friends'); // Добавлен элемент "friends"


    let intervalId;
    let movingForward = true; // направление движения
    let maxOffset = 10; // максимальное отклонение пальца
    let startingBottom = parseFloat(getComputedStyle(finger).bottom); // Получаем начальную позицию по вертикали

    function moveFinger() {
        // Проверка текущей позиции пальца и обновление стиля
        if (movingForward) {
            finger.style.bottom = (startingBottom + maxOffset) + 'px';
        } else {
            finger.style.bottom = startingBottom + 'px';
        }

        movingForward = !movingForward; // меняем направление
    }

    // Запускаем движение пальца при загрузке страницы
    intervalId = setInterval(moveFinger, 300); // каждую 300 миллисекунд

    gnom.addEventListener('click', async (event) => {
        const response = await fetch('/boosttrain', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ user_id: userId})
        });
        const data = await response.json();
        let train = data.train;
        setTimeout(async () => {
            clearInterval(intervalId);

            finger.style.bottom = '180.8px';
            finger.style.left = '29%';
            finger.style.transform = 'rotate(51.11deg)';

            const currentLang = text.getAttribute('data-lang');
            if (currentLang === 'ru') {
                text.innerHTML = 'Откройте <br> сундук'; // Используем innerHTML для поддержки HTML
                text.style.left = '29%';
                text.style.right = 'auto';
                text.style.bottom = '251px';
            }
            else {
                text.innerHTML = 'Open <br> the chest'; // Используем innerHTML для поддержки HTML
                text.style.left = '29%';
                text.style.right = 'auto';
                text.style.bottom = '251px';
            }
            startingBottom = parseFloat(finger.style.bottom);
            intervalId = setInterval(moveFinger, 300);
        }, 2500);
    });

    coin.addEventListener('click', async (event) => {
        const response = await fetch('/boosttrain', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ user_id: userId})
        });
        const data = await response.json();
        train = data.train;
        con1.remove()
        finger.remove()
        text.remove()
        text1.remove()
    });


</script>
<script>
    const button = document.querySelector('.spider');
    button.addEventListener('click', () => {
        let currentLang = document.documentElement.lang;
        if (currentLang === 'ru') {
            confirmButtonText = 'Проверить';
        } else if (currentLang === 'en') {
            confirmButtonText = 'Check';
        }
        Swal.fire({
            customClass: {
                confirmButton: 'custom-ok-button',
            },
            background: '#19292E',
            html:
                `<div class="containerPopUp">
                <img class="spider2 img_icon" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/spider2.svg">
                <div class="titleSemiBold titleMain white" style="margin-top: 4px; margin-bottom: 4px; ${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Введите <br> секретный код</div>
                <div class="titleSemiBold titleMain white" style="margin-top: 4px; margin-bottom: 4px; ${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Enter <br> the secret code</div>
                <div class="code_union"">
                <div class="code"><input style="text-transform: uppercase;" type="string" maxlength="1" class="input-value" placeholder=""></div>
                <div class="code"><input style="text-transform: uppercase;" type="string" maxlength="1" class="input-value" placeholder=""></div>
                <div class="code"><input style="text-transform: uppercase;" type="string" maxlength="1" class="input-value" placeholder=""></div>
                <div class="code"><input style="text-transform: uppercase;" type="string" maxlength="1" class="input-value" placeholder=""></div>
             </div>
                <img class="rays1" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/rays2.svg">
    </div>`,
            imageAlt: 'succes_icon',
            confirmButtonText: confirmButtonText,
            confirmButtonColor: 'rgb(80, 200, 120)',
            showConfirmButton: true,
            backdrop: 'rgba(10, 17, 19, 0.8)'
        }).then(async (result) => {
            if (result.isConfirmed) {
                // Получаем значения из input полей
                const codeInputs = document.querySelectorAll('.input-value');
                const code = Array.from(codeInputs).map(input => input.value).join('');
                console.log(code);
                const response = await fetch('/checkpass', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ user_id: userId, code: code})
                });
                const data = await response.json();
                console.log(data);
                if (data.status == 2) {
                    let currentLang = document.documentElement.lang;
                    if (currentLang === 'ru') {
                        confirmButtonText = 'Забрать';
                    } else if (currentLang === 'en') {
                        confirmButtonText = 'Pick up';
                    }
                    Swal.fire({
                        customClass: {
                            confirmButton: 'custom-ok-button',
                        },
                        background: '#19292E',
                        html:
                            `<div class="containerPopUp">
                            <img class="big_icon img_icon" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/bfcc31b7e3c9e9084ed7ee38d5ad963d.svg">
                            <div class="titleSemiBold titleMain white" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы получили <br> ${data.reward} REF</div>
                            <div class="titleSemiBold titleMain white" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You have received <br> ${data.reward} REF</div>
                            <img class="rays3" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/rays1.svg">
                </div>`,
                        imageAlt: 'succes_icon',
                        confirmButtonText: confirmButtonText,
                        confirmButtonColor: 'rgb(80, 200, 120)',
                        showConfirmButton: true,
                        backdrop: 'rgba(10, 17, 19, 0.8)'
                    });
                    spd.remove()
                } else if (data.status == 1) {
                    let currentLang = document.documentElement.lang;
                    if (currentLang === 'ru') {
                        confirmButtonText = 'Забрать';
                    } else if (currentLang === 'en') {
                        confirmButtonText = 'Pick up';
                    }
                    Swal.fire({
                        customClass: {
                            confirmButton: 'custom-ok-button',
                        },
                        background: '#19292E',
                        html:
                            `<div class="containerPopUp">
                            <img class="big_icon img_icon" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/REF2.svg">
                            <div class="titleSemiBold titleMain white" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы получили <br> ${data.reward} TWR</div>
                            <div class="titleSemiBold titleMain white" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You have received <br> ${data.reward} TWR</div>
                            <img class="rays3" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/rays1.svg">
                </div>`,
                        imageAlt: 'succes_icon',
                        confirmButtonText: confirmButtonText,
                        confirmButtonColor: 'rgb(80, 200, 120)',
                        showConfirmButton: true,
                        backdrop: 'rgba(10, 17, 19, 0.8)'
                    });
                    spd.remove()
                } else if (data.status == 3) {
                    let currentLang = document.documentElement.lang;
                    if (currentLang === 'ru') {
                        confirmButtonText = 'Забрать';
                    } else if (currentLang === 'en') {
                        confirmButtonText = 'Pick up';
                    }
                    Swal.fire({
                        customClass: {
                            confirmButton: 'custom-ok-button',
                        },
                        background: '#19292E',
                        html:
                            `<div class="containerPopUp">
                            <img class="key6 img_icon" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/key6.svg">
                            <div class="titleSemiBold titleMain white" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы получили <br> ${data.reward} ключей</div>
                            <div class="titleSemiBold titleMain white" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You have received <br> ${data.reward} keys</div>
                            <img class="rays2" src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/rays1.svg">
                </div>`,
                        imageAlt: 'succes_icon',
                        confirmButtonText: confirmButtonText,
                        confirmButtonColor: 'rgb(80, 200, 120)',
                        showConfirmButton: true,
                        backdrop: 'rgba(10, 17, 19, 0.8)'
                    });
                    spd.remove()
                } else if (data.status == 4) {
                    let currentLang = document.documentElement.lang;
                    if (currentLang === 'ru') {
                        confirmButtonText = 'Закрыть';
                    } else if (currentLang === 'en') {
                        confirmButtonText = 'Close';
                    }
                    Swal.fire({
                        customClass: {
                            confirmButton: 'close_btn',
                        },
                        background: '#19292E',
                        html:
                            `<div class="containerPopUp">
                            <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/error.svg" class="error-icon">
                            <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Неверный код</div>
                            <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Invalid code</div>
                            <div class="textUsual" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Пожалуйста, проверьте код и <br> попробуйте снова | Или вы уже вводили код сегодня</div>
                            <div class="textUsual" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Please check the code and <br> try again | Or you entered the pass today</div>
                </div>`,
                        imageAlt: 'error-icon',
                        showConfirmButton: true, // Показываем кнопку подтверждения
                        confirmButtonText: confirmButtonText, // Текст кнопки подтверждения
                        confirmButtonColor: 'rgba(249, 192, 80, 0)', // Устанавливаем цвет кнопки
                        backdrop: 'rgba(10, 17, 19, 0.8)',

                    });
                }

            }
        });
    });
</script>
<script>
    function copyToClipboard(text) {
           if (navigator.clipboard) {
              navigator.clipboard.writeText(text)
           } else {
               const textArea = document.createElement("textarea");
              textArea.value = text;

              textArea.style.position = "absolute";
              textArea.style.left = "-9999px";

              document.body.appendChild(textArea);
               textArea.focus();
              textArea.select();
              document.execCommand('copy');

              document.body.removeChild(textArea);
            }
        }
    const greenCity = document.getElementById('greentower');
    greenCity.onclick = function () {
        let currentLang = document.documentElement.lang;
        if (currentLang === 'ru') {
            confirmButtonText = 'Проверить';
            cancelButtonText = 'Закрыть';
        } else if (currentLang === 'en') {
            confirmButtonText = 'Check';
            cancelButtonText = 'Close';
        }
        Swal.fire({
            customClass: {
                confirmButton: 'custom-ok-button',
                cancelButton: 'close_btn'
            },
            background: '#19292E',
            html:
                `<div class="containerPopUp">
                <img src="https://storage.tower-ton.com/3e21e5c9-towerton/TWR.png" class="success-icon">
                <div class="textUsual" style="padding-top: 16px; ${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Получай каждый день бонусный ключ🔑 добавив в своё имя телеграм профиля:<br><span style="border-radius: 5px; background: gray;" class="copy-text" data-copy="Tower🏰">Tower🏰</span><br><span style="font-size: 10px;">(Для первой награды перезапустите игру)</span></div>
                <div class="textUsual" style="padding-top: 16px; ${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Get a bonus key🔑 every day by adding a telegram profile to your name:<br><span style="border-radius: 5px; background: gray;" class="copy-text" data-copy="Tower🏰">Tower🏰</span><br><span style="font-size: 10px;">(For first reward refresh miniapp)</span></div>
    </div>`,
            showCancelButton: true,
            showConfirmButton: true,
            confirmButtonText: confirmButtonText,
            cancelButtonText: cancelButtonText,
            confirmButtonColor: 'rgb(80, 200, 120)',
            cancelButtonColor: 'rgba(249, 192, 80, 0)',
            backdrop: 'rgba(10, 17, 19, 0.8)',
            didOpen: () => {
                            document.querySelectorAll('.copy-text').forEach(element => {
                                element.addEventListener('click', function() {
                                    const textToCopy = this.getAttribute('data-copy');
                                    copyToClipboard(textToCopy);
                                    this.style.textDecoration = "underline";
                                    setTimeout(() => {
                                        this.style.textDecoration = "none";
                                    }, 500)
                                });
                            });
            }
        }).then(async (result) => {
                  let currentLang = document.documentElement.lang;
                    if (currentLang === 'ru') {
                        confirmButtonText = 'Ок';
                    } else if (currentLang === 'en') {
                        confirmButtonText = 'Ok';
                    }
                  console.log(tg.initDataUnsafe)
                  const get = tg.initDataUnsafe.user.first_name
                  console.log(get)
                  if (result.isConfirmed) {
                    console.log(tg.initDataUnsafe.user.first_name);
                    const response12 = await fetch('/namee', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ user_id: userId, name: get, surname: tg.initDataUnsafe.user.last_name })
                    });
                    const data5 = await response12.json();
                    if (data5.status == "get") {
                        greenCity.remove();
                        Swal.fire({
                            customClass: {
                                confirmButton: 'custom-ok-button',
                                cancelButton: 'custom-error-button'
                            },
                            background: '#19292E',
                            html:
                                `<div class="containerPopUp">
                                <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/success.svg" class="success-icon">
                                <div class="textUsual" style="padding-top: 16px; ${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы получили 1 ключ, возвращайтесь завтра</div>
                                <div class="textUsual" style="padding-top: 16px; ${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You got 1 key, comeback tomorrow</div>
                    </div>`,
                            showConfirmButton: true,
                            confirmButtonText: confirmButtonText,
                            confirmButtonColor: 'rgb(80, 200, 120)',
                            customClass: {
                                confirmButton: 'button_speed',
                                cancelButton: 'button_second',
                            },
                            backdrop: 'rgba(10, 17, 19, 0.8)'
                        });
                    } else {
                        Swal.fire({
                            customClass: {
                                confirmButton: 'custom-ok-button',
                                cancelButton: 'custom-error-button'
                            },
                            background: '#19292E',
                            html:
                                `<div class="containerPopUp">
                                <img src="https://storage.tower-ton.com/3e21e5c9-towerton/assets/error.svg" class="success-icon">
                                <div class="textUsual" style="padding-top: 16px; ${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Вы не установил Tower🏰 в имя</div>
                                <div class="textUsual" style="padding-top: 16px; ${currentLang === 'en' ? 'display: block;' : 'display: none;'}">You didnt set Tower🏰 in you name</div>
                    </div>`,
                            showConfirmButton: true,
                            confirmButtonText: confirmButtonText,
                            confirmButtonColor: 'rgb(163, 57, 26)',
                            customClass: {
                                confirmButton: 'button_speed',
                                cancelButton: 'button_second',
                            },
                            backdrop: 'rgba(10, 17, 19, 0.8)'
                        });
                    }
                  }
                });
    }
</script>
<script>
    const Smaug = document.getElementById('smaug');
    Smaug.onclick = function () {
        let currentLang = document.documentElement.lang;
        if (currentLang === 'ru') {
            confirmButtonText = 'Ок';
            cancelButtonText = 'Закрыть';
        } else if (currentLang === 'en') {
            confirmButtonText = 'Ok';
            cancelButtonText = 'Close';
        }
        Swal.fire({
            customClass: {
                confirmButton: 'custom-ok-button',
                cancelButton: 'close_btn'
            },
            background: '#19292E',
            html:
                `<div class="containerPopUp">
                <div class="titleSemiBold titleMain" style="${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Сокровища дракона</div>
                <div class="titleSemiBold titleMain" style="${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Dragon Treasure</div>
                <div class="textUsual" style="padding-top: 16px; ${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Невероятно красива и одновременно с тем величественно страшна Башня в дебрях TON.</div>
                <div class="textUsual" style="padding-top: 16px; ${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Она манит к себе самых отважных героев не спроста. Хранит в себе Башня несметные богатства. </div>
                <div class="textUsual" style="padding-top: 16px; ${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Слабые и тщедушные бросают своё приключение на нижних этажах. А может и не зря. Ведь на последнем, тридцатом этаже Башни, дремлет коварный и хитрый Смауг. Дремлет, но не теряет бдительности. Ведь хранит он сокровища TON. </div>
                <div class="textUsual" style="padding-top: 16px; ${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">С каждым новым героем его богатства растут и множаться, а силы Смауга крепчают. </div>
                <div class="textUsual" style="padding-top: 16px; ${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Лишь самые храбрые герои смогут дойти до сокровищ Смауга. Но не факт, что в одиночку они смогут с ним совладать. </div>
                <div class="textUsual" style="padding-top: 16px; ${currentLang === 'ru' ? 'display: block;' : 'display: none;'}">Нас ждут великие бои Героев против несокрушимого Смауга - хранителя богатств Башни.</div>
                <div class="textUsual" style="padding-top: 16px; ${currentLang === 'en' ? 'display: block;' : 'display: none;'}">The Tower in the wilds of TON is incredibly beautiful and at the same time majestically scary.</div>
                <div class="textUsual" style="padding-top: 16px; ${currentLang === 'en' ? 'display: block;' : 'display: none;'}">It attracts the bravest heroes for a reason. The Tower holds untold riches.</div>
                <div class="textUsual" style="padding-top: 16px; ${currentLang === 'en' ? 'display: block;' : 'display: none;'}">The weak and puny abandon their adventure on the lower floors. Or maybe not for nothing. After all, on the last, thirtieth floor of the Tower, the treacherous and cunning Smaug sleeps. He dozes, but does not lose his vigilance. After all, he keeps the treasures of TON.</div>
                <div class="textUsual" style="padding-top: 16px; ${currentLang === 'en' ? 'display: block;' : 'display: none;'}">With each new hero, his wealth grows and multiplies, and Smaug's powers grow stronger.</div>
                <div class="textUsual" style="padding-top: 16px; ${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Only the bravest heroes will be able to reach the treasures of Smaug. But it's not a fact that they can handle it alone.</div>
                <div class="textUsual" style="padding-top: 16px; ${currentLang === 'en' ? 'display: block;' : 'display: none;'}">Great battles of Heroes are waiting for us against the indestructible Smaug, the guardian of the wealth of the Tower.</div>
    </div>`,
            showCancelButton: true,
            showConfirmButton: false,
            confirmButtonText: confirmButtonText,
            cancelButtonText: cancelButtonText,
            confirmButtonColor: 'rgb(80, 200, 120)',
            cancelButtonColor: 'rgba(249, 192, 80, 0)',
            backdrop: 'rgba(10, 17, 19, 0.8)'
        })
    }
</script>
</body>
</html>